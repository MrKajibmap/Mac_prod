<!DOCTYPE HTML><html><head><meta charset="UTF-8"></meta><style rel="stylesheet">.sasError {color: #d80000;}.sasMessage{color:ssSourceColor;}.sasWarning{color:#1b7a1b;}.sasSource{color:ssSourceColor;}.sasNote {color:#0072b2;}</style><title>Log:UNITS_ABT.sas</title></head><body class='sasLog'><pre class='sasLog' id='pre_sasLog_427' style='background-color:transparent; -webkit-user-select: text; -webkit-user-modify: read-only;-webkit-touch-callout: default;border-top-width: 0px;border-bottom-width: 0px'><div class="sasSource">524   %studio_hide_wrapper;</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  Beginning execution.</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %GLOBAL  _STUDIONOTES</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %GLOBAL  _STUDIOSOURCE</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %GLOBAL  _STUDIOSTIMER</div><div class="sasSource">SYMBOLGEN:  Macro variable _STUDIONOTES resolves to </div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %IF condition &amp;_studionotes = is TRUE</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %LET (variable name is _STUDIONOTES)</div><div class="sasSource">MPRINT(STUDIO_HIDE_WRAPPER):   options nonotes;</div><div class="sasSource">SYMBOLGEN:  Macro variable _STUDIOSOURCE resolves to </div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %IF condition &amp;_studiosource = is TRUE</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %LET (variable name is _STUDIOSOURCE)</div><div class="sasSource">MPRINT(STUDIO_HIDE_WRAPPER):   options nosource;</div><div class="sasSource">SYMBOLGEN:  Macro variable _STUDIOSTIMER resolves to </div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %IF condition &amp;_studiostimer = is TRUE</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %LET (variable name is _STUDIOSTIMER)</div><div class="sasSource">MPRINT(STUDIO_HIDE_WRAPPER):   options nostimer;</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  Ending execution.</div><div class="sasSource">SYMBOLGEN:  Macro variable TWORKLOC resolves to </div><div class="sasSource">            "/opt/sas/viya/config/var/tmp/compsrv/default/2d23d509-cfa7-4de0-8398-76dff113b5d3/SAS_work41B300006B69_rumskap101.ru-ce</div><div class="sasSource">            ntral1.internal"</div><div class="sasSource">SYMBOLGEN:  Macro variable SASWORKLOCATION resolves to </div><div class="sasSource">            "/opt/sas/viya/config/var/tmp/compsrv/default/2d23d509-cfa7-4de0-8398-76dff113b5d3/SAS_work41B300006B69_rumskap101.ru-ce</div><div class="sasSource">            ntral1.internal/"</div><div class="sasSource">SYMBOLGEN:  Macro variable _SASWSTEMP_ resolves to </div><div class="sasSource">            /opt/sas/viya/config/var/tmp/compsrv/default/2d23d509-cfa7-4de0-8398-76dff113b5d3/SAS_work41B300006B69_rumskap101.ru-cen</div><div class="sasSource">            tral1.internal</div><div class="sasSource">SYMBOLGEN:  Some characters in the above value which were subject to macro quoting have been unquoted for printing.</div><div class="sasSource">SYMBOLGEN:  Macro variable _SASWSTEMP_ resolves to </div><div class="sasSource">            /opt/sas/viya/config/var/tmp/compsrv/default/2d23d509-cfa7-4de0-8398-76dff113b5d3/SAS_work41B300006B69_rumskap101.ru-cen</div><div class="sasSource">            tral1.internal</div><div class="sasSource">SYMBOLGEN:  Some characters in the above value which were subject to macro quoting have been unquoted for printing.</div><div class="sasSource">SYMBOLGEN:  Macro variable GRAPHINIT resolves to GOPTIONS RESET=ALL GSFNAME=_GSFNAME;</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  Beginning execution.</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  %GLOBAL  _STUDIONOTES</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  %GLOBAL  _STUDIOSOURCE</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  %GLOBAL  _STUDIOSTIMER</div><div class="sasSource">SYMBOLGEN:  Macro variable _STUDIONOTES resolves to NOTES</div><div class="sasSource">MPRINT(STUDIO_RESTORE_WRAPPER):   options NOTES;</div><div class="sasSource">SYMBOLGEN:  Macro variable _STUDIOSOURCE resolves to SOURCE</div><div class="sasSource">MPRINT(STUDIO_RESTORE_WRAPPER):   options SOURCE;</div><div class="sasSource">SYMBOLGEN:  Macro variable _STUDIOSTIMER resolves to STIMER</div><div class="sasSource">MPRINT(STUDIO_RESTORE_WRAPPER):   options STIMER;</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  %LET (variable name is _STUDIONOTES)</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  %LET (variable name is _STUDIOSOURCE)</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  %LET (variable name is _STUDIOSTIMER)</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  Ending execution.</div><div class="sasSource">605   /*</div><div class="sasSource">606   Схема программы:</div><div class="sasSource">607   </div><div class="sasSource">608   0. Объявление макропеременных: первый и последний день в истории,</div><div class="sasSource">608 ! фильтрация по категориям</div><div class="sasSource">609   товаров и каналам.</div><div class="sasSource">610   1. Сбор "каркаса" из таблиц ia_pmix и ia_pmix_history с учетом фильтра.</div><div class="sasSource">611   2. Добавление цен.</div><div class="sasSource">612   3. Протягиваем временные ряды на 42 день с последнего дня в истории.</div><div class="sasSource">612 ! Целевую переменную</div><div class="sasSource">613   заполняем пропусками, цены заполняем предыдущим значением.</div><div class="sasSource">614   4. Фильтрация:</div><div class="sasSource">615   * Убираем временные закрытия ПБО.</div><div class="sasSource">616   * Убираем закрытые магазины из справочника ПБО.</div><div class="sasSource">617   * Убираем из истории пропуски в продажах (появившиеся после</div><div class="sasSource">617 ! протяжки временных рядов).</div><div class="sasSource">618   * PLM, убираем выведенные товары (пока на паузе).</div><div class="sasSource">619   * Пересекаем с ассортиментной матрицей скоринговую витрину.</div><div class="sasSource">620   5. Подсчет лагов.</div><div class="sasSource">621   6. Добавление промо:</div><div class="sasSource">622   * Бинарные флаги промо по промо механикам.</div><div class="sasSource">623   * Флаг side_promo для регулярного товара вне промо.</div><div class="sasSource">624   * Скидка?</div><div class="sasSource">625   7. Добавляем мароэкономику (проверить заполненность на будущее).</div><div class="sasSource">626   8. Добавляем погоду (проверить заполненность на будещее).</div><div class="sasSource">627   9. Добавляем trp конкурентов.</div><div class="sasSource">628   10. Добавляем медиаподдержку.</div><div class="sasSource">629   11. Добавим атрибуты товаров. Дополнительно перекодируем текстовые</div><div class="sasSource">629 ! переменные.</div><div class="sasSource">630   12. Добавляем атрибуты ПБО. Дополнительно перекодируем текстовые</div><div class="sasSource">630 ! переменные.</div><div class="sasSource">631   13. Добавляем календарные признаки.</div><div class="sasSource">632   14. Добавляем события. Можно забить на те события, которые нам</div><div class="sasSource">632 ! передают сейчас, а</div><div class="sasSource">633   просто взять и использовать, те события, которые Лиза считает</div><div class="sasSource">633 ! существенными.</div><div class="sasSource">634   *** Взять день города! ***</div><div class="sasSource">635   15. Добавим ценовые ранги.</div><div class="sasSource">636   16. Перекодируем channel_cd (текстовое поле на число). Делаем это в</div><div class="sasSource">636 ! последнюю очередб</div><div class="sasSource">637    для удобства соединения таблиц.</div><div class="sasSource">638   17. Разделяем витрину на обучение и скоринг.</div><div class="sasSource">639   Что еще хочется видеть в витрине?</div><div class="sasSource">640   * Закодировать ID ПБО и товаров через агрегаты целевой переменной</div><div class="sasSource">641   * Придумать признаков по промо.</div><div class="sasSource">642   */</div><div class="sasSource">643   </div><div class="sasSource">644   </div><div class="sasSource">645   /****** 0. Объявление макропеременных ******/</div><div class="sasSource">646   options mprint nomprintnest nomlogic nomlogicnest nosymbolgen mcompilenote=all mreplace;</div><div class="sasSource">647   /*Создать cas-сессию, если её нет*/</div><div class="sasSource">648   %macro assign;</div><div class="sasSource">649   %let casauto_ok = %sysfunc(SESSFOUND ( casauto)) ;</div><div class="sasSource">650   %if &amp;casauto_ok = 0 %then %do; /*set all stuff only if casauto is absent */</div><div class="sasSource">651    cas casauto;</div><div class="sasSource">652    caslib _all_ assign;</div><div class="sasSource">653   %end;</div><div class="sasSource">654   %mend;</div><div class="sasNote" id="sasLogNote1_1620885733386">NOTE: The macro ASSIGN completed compilation without errors.</div><div class="sasNote">      15 instructions 336 bytes.</div><div class="sasSource">655   %assign</div><div class="sasSource">MPRINT(ASSIGN):   cas casauto;</div><div class="sasNote" id="sasLogNote2_1620885733386">NOTE: The session CASAUTO connected successfully to Cloud Analytic Services rumskap102.ru-central1.internal using port 5570. The </div><div class="sasNote">      UUID is b077ec27-042e-1e40-b3a8-d124cf38af46. The user is RU-MPovod and the active caslib is CASUSERHDFS(RU-MPovod).</div><div class="sasNote" id="sasLogNote3_1620885733386">NOTE: The SAS option SESSREF was updated with the value CASAUTO.</div><div class="sasNote" id="sasLogNote4_1620885733386">NOTE: The SAS macro _SESSREF_ was updated with the value CASAUTO.</div><div class="sasNote" id="sasLogNote5_1620885733386">NOTE: The session is using 5 workers.</div><div class="sasSource">MPRINT(ASSIGN):   caslib _all_ assign;</div><div class="sasNote" id="sasLogNote6_1620885733386">NOTE: A SAS Library associated with a caslib can only reference library member names that conform to SAS Library naming conventions.</div><div class="sasNote" id="sasLogNote7_1620885733386">NOTE: CASLIB CASSHORT for session CASAUTO will be mapped to SAS Library CASSHORT.</div><div class="sasNote" id="sasLogNote8_1620885733386">NOTE: CASLIB CASUSER(RU-MPovod) for session CASAUTO will be mapped to SAS Library CASUSER.</div><div class="sasNote" id="sasLogNote9_1620885733386">NOTE: CASLIB CASUSERHDFS(RU-MPovod) for session CASAUTO will be mapped to SAS Library CASUSERH.</div><div class="sasNote" id="sasLogNote10_1620885733386">NOTE: CASLIB CPSAppData for session CASAUTO will not be mapped to SAS Library CPSAppData. The CASLIB name is not valid for use as a </div><div class="sasNote">      libref.</div><div class="sasNote" id="sasLogNote11_1620885733386">NOTE: CASLIB DM_ALERT for session CASAUTO will be mapped to SAS Library DM_ALERT.</div><div class="sasNote" id="sasLogNote12_1620885733386">NOTE: CASLIB Formats for session CASAUTO will be mapped to SAS Library FORMATS.</div><div class="sasNote" id="sasLogNote13_1620885733386">NOTE: CASLIB MAX_CASL for session CASAUTO will be mapped to SAS Library MAX_CASL.</div><div class="sasNote" id="sasLogNote14_1620885733386">NOTE: CASLIB MN_DICT for session CASAUTO will be mapped to SAS Library MN_DICT.</div><div class="sasNote" id="sasLogNote15_1620885733386">NOTE: CASLIB MN_LONG for session CASAUTO will be mapped to SAS Library MN_LONG.</div><div class="sasNote" id="sasLogNote16_1620885733386">NOTE: CASLIB MN_SHORT for session CASAUTO will be mapped to SAS Library MN_SHORT.</div><div class="sasNote" id="sasLogNote17_1620885733386">NOTE: CASLIB ModelPerformanceData for session CASAUTO will not be mapped to SAS Library ModelPerformanceData. The CASLIB name is </div><div class="sasNote">      not valid for use as a libref.</div><div class="sasNote" id="sasLogNote18_1620885733386">NOTE: CASLIB Models for session CASAUTO will be mapped to SAS Library MODELS.</div><div class="sasNote" id="sasLogNote19_1620885733386">NOTE: CASLIB Public for session CASAUTO will be mapped to SAS Library PUBLIC.</div><div class="sasNote" id="sasLogNote20_1620885733386">NOTE: CASLIB Samples for session CASAUTO will be mapped to SAS Library SAMPLES.</div><div class="sasNote" id="sasLogNote21_1620885733386">NOTE: CASLIB SystemData for session CASAUTO will not be mapped to SAS Library SystemData. The CASLIB name is not valid for use as a </div><div class="sasNote">      libref.</div><div class="sasSource">656   </div><div class="sasSource">657   options casdatalimit=600000M;</div><div class="sasSource">658   </div><div class="sasSource">659   /* Подключение библиотек */</div><div class="sasSource">660   /* libname ETL_STG "/data2/etl_stg_23_11_2020"; */</div><div class="sasSource">661   /* Объявление макропеременных */</div><div class="sasSource">662   %let inlib=IA;</div><div class="sasSource">663   /* только бургеры в канале ALL */</div><div class="sasSource">664   /* %let filter = t2.prod_lvl3_id in (900116, 2420116, 2430116) and t1.channel_cd = 'ALL';  */</div><div class="sasSource">665   %let filter = t1.channel_cd = 'ALL';</div><div class="sasSource">666   </div><div class="sasSource">667   %let hist_start_dt = date '2018-05-01';</div><div class="sasSource">668   %let hist_end_dt =  date '2021-04-30';</div><div class="sasSource">669   </div><div class="sasSource">670   %let hist_end_dt_sas = '30apr2021'd;</div><div class="sasSource">671   </div><div class="sasSource">672   </div><div class="sasSource">673   /****** 1. Сбор "каркаса" из таблиц ia_pmix и ia_pmix_history с учетом фильтра ******/</div><div class="sasSource">674   /* Сначала собираем справочник товаров для того, чтобы создать фильтр</div><div class="sasSource">674 !  */</div><div class="sasSource">675   proc casutil;</div><div class="sasNote" id="sasLogNote22_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">676     droptable casdata="product_dictionary_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote23_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015534 seconds.</div><div class="sasSource">677     load data=&amp;inlib..IA_product casout='ia_product' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote24_1620885733386">NOTE: IA.IA_PRODUCT was successfully added to the "Public" caslib as "IA_PRODUCT".</div><div class="sasSource">678     load data=&amp;inlib..IA_product_HIERARCHY casout='IA_product_HIERARCHY' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote25_1620885733386">NOTE: IA.IA_PRODUCT_HIERARCHY was successfully added to the "Public" caslib as "IA_PRODUCT_HIERARCHY".</div><div class="sasSource">679     load data=&amp;inlib..IA_product_ATTRIBUTES casout='IA_product_ATTRIBUTES' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote26_1620885733386">NOTE: IA.IA_PRODUCT_ATTRIBUTES was successfully added to the "Public" caslib as "IA_PRODUCT_ATTRIBUTES".</div><div class="sasSource">680   run;</div><div class="sasSource">681   </div><div class="sasNote" id="sasLogNote27_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.91 seconds</div><div class="sasNote">      user cpu time       0.04 seconds</div><div class="sasNote">      system cpu time     0.02 seconds</div><div class="sasNote">      memory              2866.68k</div><div class="sasNote">      OS Memory           36016.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:30 PM</div><div class="sasNote">      Step Count                        21  Switch Count  70</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     4493</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        499</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">682   proc cas;</div><div class="sasSource">683   transpose.transpose /</div><div class="sasSource">684      table={name="ia_product_attributes", caslib="public", groupby={"product_id"}}</div><div class="sasSource">685      attributes={{name="product_id"}}</div><div class="sasSource">686      transpose={"PRODUCT_ATTR_VALUE"}</div><div class="sasSource">687      prefix="A_"</div><div class="sasSource">688      id={"PRODUCT_ATTR_NM"}</div><div class="sasSource">689      casout={name="attr_transposed", caslib="public", replace=true};</div><div class="sasSource">690   quit;</div><div class="sasNote" id="sasLogNote28_1620885733386">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote29_1620885733386">NOTE: Added action set 'transpose'.</div><div class="sasNote" id="sasLogNote30_1620885733386">NOTE: There were 22837 rows read from the table IA_PRODUCT_ATTRIBUTES.</div><div class="sasNote" id="sasLogNote31_1620885733386">NOTE: The table attr_transposed has 2916 rows and 11 columns.</div><div class="sasNote" id="sasLogNote32_1620885733386">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.15 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10662.40k</div><div class="sasNote">      OS Memory           44416.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:30 PM</div><div class="sasNote">      Step Count                        22  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1163</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        21</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">691   </div><div class="sasSource">692   proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote33_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">693      create table public.product_hier_flat{options replace=true} as</div><div class="sasSource">694   select t1.product_id,</div><div class="sasSource">695      t2.product_id  as LVL4_ID,</div><div class="sasSource">696      t3.product_id  as LVL3_ID,</div><div class="sasSource">697      t3.PARENT_product_id as LVL2_ID,</div><div class="sasSource">698      1 as LVL1_ID</div><div class="sasSource">699   from</div><div class="sasSource">700   (select * from public.ia_product_hierarchy where product_lvl=5) as t1</div><div class="sasSource">701   left join</div><div class="sasSource">702   (select * from public.ia_product_hierarchy where product_lvl=4) as t2</div><div class="sasSource">703   on t1.PARENT_PRODUCT_ID=t2.PRODUCT_ID</div><div class="sasSource">704   left join</div><div class="sasSource">705   (select * from public.ia_product_hierarchy where product_lvl=3) as t3</div><div class="sasSource">706   on t2.PARENT_PRODUCT_ID=t3.PRODUCT_ID</div><div class="sasSource">707    ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote34_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_HIER_FLAT was created in caslib Public with 2916 rows returned.</div><div class="sasNote" id="sasLogNote35_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">708   quit;</div><div class="sasNote" id="sasLogNote36_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.45 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              101.56k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:30 PM</div><div class="sasNote">      Step Count                        23  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     36</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">709   </div><div class="sasSource">710   proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote37_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">711      create table public.product_dictionary_ml{options replace=true} as</div><div class="sasSource">712      select t1.product_id,</div><div class="sasSource">713      coalesce(t1.lvl4_id,-9999) as prod_lvl4_id,</div><div class="sasSource">714      coalesce(t1.lvl3_id,-999) as prod_lvl3_id,</div><div class="sasSource">715      coalesce(t1.lvl2_id,-99) as prod_lvl2_id,</div><div class="sasSource">716      coalesce(t15.product_nm,'NA') as product_nm,</div><div class="sasSource">717      coalesce(t14.product_nm,'NA') as prod_lvl4_nm,</div><div class="sasSource">718      coalesce(t13.product_nm,'NA') as prod_lvl3_nm,</div><div class="sasSource">719      coalesce(t12.product_nm,'NA') as prod_lvl2_nm,</div><div class="sasSource">720          t3.A_HERO,</div><div class="sasSource">721          t3.A_ITEM_SIZE,</div><div class="sasSource">722      t3.A_OFFER_TYPE,</div><div class="sasSource">723      t3.A_PRICE_TIER</div><div class="sasSource">724      from public.product_hier_flat t1</div><div class="sasSource">725      left join public.attr_transposed t3</div><div class="sasSource">726      on t1.product_id=t3.product_id</div><div class="sasSource">727      left join PUBLIC.IA_product t15</div><div class="sasSource">728      on t1.product_id=t15.product_id</div><div class="sasSource">729      left join PUBLIC.IA_product t14</div><div class="sasSource">730      on t1.lvl4_id=t14.product_id</div><div class="sasSource">731      left join PUBLIC.IA_product t13</div><div class="sasSource">732      on t1.lvl3_id=t13.product_id</div><div class="sasSource">733      left join PUBLIC.IA_product t12</div><div class="sasSource">734      on t1.lvl2_id=t12.product_id;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote38_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_DICTIONARY_ML was created in caslib Public with 2916 rows returned.</div><div class="sasNote" id="sasLogNote39_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">735   quit;</div><div class="sasNote" id="sasLogNote40_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.92 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              121.71k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:31 PM</div><div class="sasNote">      Step Count                        24  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        29</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">736   </div><div class="sasSource">737   /* Перекодировка текстовых переменных. */</div><div class="sasSource">738   %macro text_encoding(table, variable);</div><div class="sasSource">739   /*</div><div class="sasSource">740   Параметры:</div><div class="sasSource">741   table : таблица в которой хотим заненить текстовую переменную</div><div class="sasSource">742   variable : название текстовой переменной</div><div class="sasSource">743   Выход:</div><div class="sasSource">744   * Таблица table с дополнительным столбцом variable_id</div><div class="sasSource">745   * Таблица encoding_variable с привозкой id к старым значениям</div><div class="sasSource">746   */</div><div class="sasSource">747   proc casutil;</div><div class="sasSource">748    droptable casdata="encoding_&amp;variable." incaslib="public" quiet;</div><div class="sasSource">749    run;</div><div class="sasSource">750   </div><div class="sasSource">751   proc fedsql sessref=casauto;</div><div class="sasSource">752   create table public.unique{options replace=true} as</div><div class="sasSource">753   select distinct</div><div class="sasSource">754   &amp;variable</div><div class="sasSource">755   from</div><div class="sasSource">756   &amp;table.</div><div class="sasSource">757   ;</div><div class="sasSource">758   quit;</div><div class="sasSource">759   </div><div class="sasSource">760   data work.unique;</div><div class="sasSource">761   set public.unique;</div><div class="sasSource">762   run;</div><div class="sasSource">763   </div><div class="sasSource">764   data work.encoding_&amp;variable.;</div><div class="sasSource">765   set work.unique;</div><div class="sasSource">766   &amp;variable._id = _N_;</div><div class="sasSource">767   run;</div><div class="sasSource">768   </div><div class="sasSource">769   data public.encoding_&amp;variable.;</div><div class="sasSource">770   set work.encoding_&amp;variable.;</div><div class="sasSource">771   run;</div><div class="sasSource">772   </div><div class="sasSource">773   proc fedsql sessref = casauto;</div><div class="sasSource">774   create table public.&amp;table.{options replace=true} as</div><div class="sasSource">775   select</div><div class="sasSource">776   t1.*,</div><div class="sasSource">777   t2.&amp;variable._id</div><div class="sasSource">778   from</div><div class="sasSource">779   &amp;table. as t1</div><div class="sasSource">780   left join</div><div class="sasSource">781   public.encoding_&amp;variable. as t2</div><div class="sasSource">782   on</div><div class="sasSource">783   t1.&amp;variable = t2.&amp;variable</div><div class="sasSource">784   ;</div><div class="sasSource">785   quit;</div><div class="sasSource">786   </div><div class="sasSource">787   proc casutil;</div><div class="sasSource">788    promote casdata="encoding_&amp;variable." incaslib="public" outcaslib="public";</div><div class="sasSource">789   run;</div><div class="sasSource">790   %mend;</div><div class="sasNote" id="sasLogNote41_1620885733386">NOTE: The macro TEXT_ENCODING completed compilation without errors.</div><div class="sasNote">      16 instructions 1088 bytes.</div><div class="sasSource">791   </div><div class="sasSource">792   %text_encoding(public.product_dictionary_ml, a_hero)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote42_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_a_hero" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote43_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.021597 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote44_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              112.59k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:31 PM</div><div class="sasNote">      Step Count                        25  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote45_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct a_hero from </div><div class="sasSource">public.product_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote46_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 2 rows returned.</div><div class="sasNote" id="sasLogNote47_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote48_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.17 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.34k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:31 PM</div><div class="sasNote">      Step Count                        26  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote49_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote50_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote51_1620885733386">NOTE: There were 2 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote52_1620885733386">NOTE: The data set WORK.UNIQUE has 2 observations and 1 variables.</div><div class="sasNote" id="sasLogNote53_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote54_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              536.96k</div><div class="sasNote">      OS Memory           35092.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:32 PM</div><div class="sasNote">      Step Count                        27  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     590</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        49</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_a_hero;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   a_hero_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote55_1620885733386">NOTE: There were 2 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote56_1620885733386">NOTE: The data set WORK.ENCODING_A_HERO has 2 observations and 2 variables.</div><div class="sasNote" id="sasLogNote57_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_HERO increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote58_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              591.28k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:32 PM</div><div class="sasNote">      Step Count                        28  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     94</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_a_hero;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_a_hero;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote59_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote60_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote61_1620885733386">NOTE: There were 2 observations read from the data set WORK.ENCODING_A_HERO.</div><div class="sasNote" id="sasLogNote62_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_HERO has 2 observations and 2 variables.</div><div class="sasNote" id="sasLogNote63_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              901.93k</div><div class="sasNote">      OS Memory           35864.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:32 PM</div><div class="sasNote">      Step Count                        29  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     465</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        37</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote64_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.product_dictionary_ml{options replace=true} as select t1.*, t2.a_hero_id from </div><div class="sasSource">public.product_dictionary_ml as t1 left join public.encoding_a_hero as t2 on t1.a_hero = t2.a_hero ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote65_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_DICTIONARY_ML was created in caslib PUBLIC with 2916 rows returned.</div><div class="sasNote" id="sasLogNote66_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote67_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.20 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              83.56k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:32 PM</div><div class="sasNote">      Step Count                        30  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     12</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        23</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote68_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_a_hero" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote69_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_HERO in caslib Public to table encoding_a_hero in caslib public.</div><div class="sasNote" id="sasLogNote70_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.020034 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">793   %text_encoding(public.product_dictionary_ml, a_item_size)</div><div class="sasNote" id="sasLogNote71_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              229.50k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:32 PM</div><div class="sasNote">      Step Count                        31  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     20</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        31</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote72_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_a_item_size" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote73_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016405 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote74_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              113.90k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:32 PM</div><div class="sasNote">      Step Count                        32  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     8</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote75_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct a_item_size from </div><div class="sasSource">public.product_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote76_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 24 rows returned.</div><div class="sasNote" id="sasLogNote77_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote78_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.18 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.31k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:32 PM</div><div class="sasNote">      Step Count                        33  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        23</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote79_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote80_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote81_1620885733386">NOTE: There were 24 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote82_1620885733386">NOTE: The data set WORK.UNIQUE has 24 observations and 1 variables.</div><div class="sasNote" id="sasLogNote83_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote84_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.10 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              539.71k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:32 PM</div><div class="sasNote">      Step Count                        34  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     324</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        53</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_a_item_size;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   a_item_size_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote85_1620885733386">NOTE: There were 24 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote86_1620885733386">NOTE: The data set WORK.ENCODING_A_ITEM_SIZE has 24 observations and 2 variables.</div><div class="sasNote" id="sasLogNote87_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_ITEM_SIZE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote88_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              563.90k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:32 PM</div><div class="sasNote">      Step Count                        35  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     26</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_a_item_size;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_a_item_size;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote89_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote90_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote91_1620885733386">NOTE: There were 24 observations read from the data set WORK.ENCODING_A_ITEM_SIZE.</div><div class="sasNote" id="sasLogNote92_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_ITEM_SIZE has 24 observations and 2 variables.</div><div class="sasNote" id="sasLogNote93_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.08 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              903.21k</div><div class="sasNote">      OS Memory           35864.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:32 PM</div><div class="sasNote">      Step Count                        36  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     449</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        38</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote94_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.product_dictionary_ml{options replace=true} as select t1.*, t2.a_item_size_id </div><div class="sasSource">from public.product_dictionary_ml as t1 left join public.encoding_a_item_size as t2 on t1.a_item_size = t2.a_item_size ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote95_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_DICTIONARY_ML was created in caslib PUBLIC with 2916 rows returned.</div><div class="sasNote" id="sasLogNote96_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote97_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.21 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.06k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:32 PM</div><div class="sasNote">      Step Count                        37  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote98_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_a_item_size" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote99_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_ITEM_SIZE in caslib Public to table encoding_a_item_size in caslib public.</div><div class="sasNote" id="sasLogNote100_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.023347 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">794   %text_encoding(public.product_dictionary_ml, a_offer_type)</div><div class="sasNote" id="sasLogNote101_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              229.40k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:33 PM</div><div class="sasNote">      Step Count                        38  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     10</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        30</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote102_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_a_offer_type" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote103_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.018104 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote104_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              113.81k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:33 PM</div><div class="sasNote">      Step Count                        39  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     8</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote105_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct a_offer_type from </div><div class="sasSource">public.product_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote106_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 3 rows returned.</div><div class="sasNote" id="sasLogNote107_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote108_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.16 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.18k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:33 PM</div><div class="sasNote">      Step Count                        40  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote109_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote110_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote111_1620885733386">NOTE: There were 3 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote112_1620885733386">NOTE: The data set WORK.UNIQUE has 3 observations and 1 variables.</div><div class="sasNote" id="sasLogNote113_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote114_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.10 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              503.90k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:33 PM</div><div class="sasNote">      Step Count                        41  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     340</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        51</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_a_offer_type;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   a_offer_type_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote115_1620885733386">NOTE: There were 3 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote116_1620885733386">NOTE: The data set WORK.ENCODING_A_OFFER_TYPE has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote117_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_OFFER_TYPE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote118_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              562.59k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:33 PM</div><div class="sasNote">      Step Count                        42  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     16</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_a_offer_type;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_a_offer_type;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote119_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote120_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote121_1620885733386">NOTE: There were 3 observations read from the data set WORK.ENCODING_A_OFFER_TYPE.</div><div class="sasNote" id="sasLogNote122_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_OFFER_TYPE has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote123_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.08 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              904.96k</div><div class="sasNote">      OS Memory           35864.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:33 PM</div><div class="sasNote">      Step Count                        43  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     450</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        39</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote124_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.product_dictionary_ml{options replace=true} as select t1.*, t2.a_offer_type_id </div><div class="sasSource">from public.product_dictionary_ml as t1 left join public.encoding_a_offer_type as t2 on t1.a_offer_type = t2.a_offer_type ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote125_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_DICTIONARY_ML was created in caslib PUBLIC with 2916 rows returned.</div><div class="sasNote" id="sasLogNote126_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote127_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.28 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.81k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:33 PM</div><div class="sasNote">      Step Count                        44  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        25</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote128_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_a_offer_type" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote129_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_OFFER_TYPE in caslib Public to table encoding_a_offer_type in caslib public.</div><div class="sasNote" id="sasLogNote130_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.021186 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">795   %text_encoding(public.product_dictionary_ml, a_price_tier)</div><div class="sasNote" id="sasLogNote131_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              229.93k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:33 PM</div><div class="sasNote">      Step Count                        45  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     9</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        31</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote132_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_a_price_tier" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote133_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.019254 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote134_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.34k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:33 PM</div><div class="sasNote">      Step Count                        46  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote135_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct a_price_tier from </div><div class="sasSource">public.product_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote136_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 3 rows returned.</div><div class="sasNote" id="sasLogNote137_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote138_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.18 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              107.21k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:33 PM</div><div class="sasNote">      Step Count                        47  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote139_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote140_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote141_1620885733386">NOTE: There were 3 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote142_1620885733386">NOTE: The data set WORK.UNIQUE has 3 observations and 1 variables.</div><div class="sasNote" id="sasLogNote143_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote144_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              515.93k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:34 PM</div><div class="sasNote">      Step Count                        48  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     322</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        51</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_a_price_tier;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   a_price_tier_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote145_1620885733386">NOTE: There were 3 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote146_1620885733386">NOTE: The data set WORK.ENCODING_A_PRICE_TIER has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote147_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_PRICE_TIER increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote148_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              562.56k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:34 PM</div><div class="sasNote">      Step Count                        49  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     30</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_a_price_tier;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_a_price_tier;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote149_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote150_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote151_1620885733386">NOTE: There were 3 observations read from the data set WORK.ENCODING_A_PRICE_TIER.</div><div class="sasNote" id="sasLogNote152_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_PRICE_TIER has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote153_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              902.40k</div><div class="sasNote">      OS Memory           35864.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:34 PM</div><div class="sasNote">      Step Count                        50  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     448</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        37</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote154_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.product_dictionary_ml{options replace=true} as select t1.*, t2.a_price_tier_id </div><div class="sasSource">from public.product_dictionary_ml as t1 left join public.encoding_a_price_tier as t2 on t1.a_price_tier = t2.a_price_tier ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote155_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_DICTIONARY_ML was created in caslib PUBLIC with 2916 rows returned.</div><div class="sasNote" id="sasLogNote156_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote157_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.20 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.81k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:34 PM</div><div class="sasNote">      Step Count                        51  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote158_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_a_price_tier" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote159_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_PRICE_TIER in caslib Public to table encoding_a_price_tier in caslib public.</div><div class="sasNote" id="sasLogNote160_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.027941 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">796   </div><div class="sasNote" id="sasLogNote161_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              229.75k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:34 PM</div><div class="sasNote">      Step Count                        52  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     9</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">797   proc casutil;</div><div class="sasNote" id="sasLogNote162_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">798   /*   promote casdata="product_dictionary_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">799     droptable casdata='ia_product' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote163_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01049 seconds.</div><div class="sasSource">800     droptable casdata='IA_product_HIERARCHY' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote164_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.013059 seconds.</div><div class="sasSource">801     droptable casdata='IA_product_ATTRIBUTES' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote165_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.011286 seconds.</div><div class="sasSource">802     droptable casdata='product_hier_flat' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote166_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01057 seconds.</div><div class="sasSource">803     droptable casdata='attr_transposed' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote167_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.011907 seconds.</div><div class="sasSource">804   run;</div><div class="sasSource">805   </div><div class="sasSource">806   /* Подготовка таблицы с продажами */</div><div class="sasNote" id="sasLogNote168_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.10 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              117.25k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/12/2021 11:53:34 PM</div><div class="sasNote">      Step Count                        53  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        25</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">807   proc casutil;</div><div class="sasNote" id="sasLogNote169_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">808   </div><div class="sasSource">808 !  droptable casdata="abt1_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote170_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.018963 seconds.</div><div class="sasSource">809   </div><div class="sasSource">809 !  load data=&amp;inlib..IA_pmix_sales_HISTORY casout='IA_pmix_sales_HISTORY' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote171_1620885733386">NOTE: IA.IA_PMIX_SALES_HISTORY was successfully added to the "Public" caslib as "IA_PMIX_SALES_HISTORY".</div><div class="sasSource">810   run;</div><div class="sasSource">811   </div><div class="sasNote" id="sasLogNote172_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           1:51:10.77</div><div class="sasNote">      user cpu time       7:22.51</div><div class="sasNote">      system cpu time     2:07.88</div><div class="sasNote">      memory              2500.12k</div><div class="sasNote">      OS Memory           37700.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:44:45 AM</div><div class="sasNote">      Step Count                        54  Switch Count  343134</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     8994898</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        3719963</div><div class="sasNote">      Involuntary Context Switches      419</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           1616</div><div class="sasNote">      </div><div class="sasSource">812   proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote173_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">813   create table public.abt1_ml{options replace=true} as</div><div class="sasSource">814   select</div><div class="sasSource">815   t1.PBO_LOCATION_ID,</div><div class="sasSource">816   t1.PRODUCT_ID,</div><div class="sasSource">817   t1.CHANNEL_CD,</div><div class="sasSource">818   datepart(t1.SALES_DT) as sales_dt,</div><div class="sasSource">819   coalesce(sum(t1.SALES_QTY,t1.SALES_QTY_PROMO), 0) as sum_qty</div><div class="sasSource">820   from</div><div class="sasSource">821   public.IA_pmix_sales_HISTORY as t1</div><div class="sasSource">822   where</div><div class="sasSource">823   &amp;filter. and</div><div class="sasSource">824   datepart(t1.SALES_DT) &gt;= &amp;hist_start_dt. and</div><div class="sasSource">825   datepart(t1.SALES_DT) &lt;= &amp;hist_end_dt.</div><div class="sasSource">826   ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote174_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT1_ML was created in caslib Public with 176780916 rows returned.</div><div class="sasNote" id="sasLogNote175_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">827   quit;</div><div class="sasNote" id="sasLogNote176_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           7.43 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              99.18k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:44:52 AM</div><div class="sasNote">      Step Count                        55  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        67</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">828   </div><div class="sasSource">829   proc casutil;</div><div class="sasNote" id="sasLogNote177_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">830   </div><div class="sasSource">830 !  droptable casdata="IA_pmix_sales_HISTORY" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote178_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 3.341839 seconds.</div><div class="sasSource">831   </div><div class="sasSource">831 !  load data=&amp;inlib..ia_product_chain casout="ia_product_chain" outcaslib="Public" replace;</div><div class="sasNote" id="sasLogNote179_1620885733386">NOTE: IA.IA_PRODUCT_CHAIN was successfully added to the "Public" caslib as "IA_PRODUCT_CHAIN".</div><div class="sasSource">832   run;</div><div class="sasSource">833   </div><div class="sasSource">834   /* Добавляем к скоринговой витрине записи из product_chain с флагом N */</div><div class="sasNote" id="sasLogNote180_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           5.10 seconds</div><div class="sasNote">      user cpu time       0.07 seconds</div><div class="sasNote">      system cpu time     0.02 seconds</div><div class="sasNote">      memory              2573.37k</div><div class="sasNote">      OS Memory           37492.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:44:57 AM</div><div class="sasNote">      Step Count                        56  Switch Count  59</div><div class="sasNote">      Page Faults                       1</div><div class="sasNote">      Page Reclaims                     1973</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        427</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            6552</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">835   proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote181_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">836   create table public.future_product_chain{options replace=true} as</div><div class="sasSource">837   select</div><div class="sasSource">838   SUCCESSOR_PRODUCT_ID as product_id,</div><div class="sasSource">839   SUCCESSOR_DIM2_ID as pbo_location_id,</div><div class="sasSource">840   datepart(SUCCESSOR_START_DT) as period_start_dt</div><div class="sasSource">841   from</div><div class="sasSource">842   public.ia_product_chain as t1</div><div class="sasSource">843   where</div><div class="sasSource">844   LIFECYCLE_CD = 'N' and</div><div class="sasSource">845   datepart(SUCCESSOR_START_DT) &gt;= &amp;hist_end_dt.</div><div class="sasSource">846   ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote182_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table FUTURE_PRODUCT_CHAIN was created in caslib Public with 869 rows returned.</div><div class="sasNote" id="sasLogNote183_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">847   quit;</div><div class="sasNote" id="sasLogNote184_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.15 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.96k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:44:58 AM</div><div class="sasNote">      Step Count                        57  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        29</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">848   </div><div class="sasSource">849   /* Продляем эти интервалы */</div><div class="sasSource">850   data public.future_product_scoring;</div><div class="sasSource">851   set public.future_product_chain;</div><div class="sasSource">852   format sales_dt DATE9.;</div><div class="sasSource">853   channel_cd = 'ALL';</div><div class="sasSource">854   do sales_dt = period_start_dt to (&amp;hist_end_dt_sas. + 91);</div><div class="sasSource">855      output;</div><div class="sasSource">856   end;</div><div class="sasSource">857   run;</div><div class="sasNote" id="sasLogNote185_1620885733386">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote186_1620885733386">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote187_1620885733386">NOTE: There were 869 observations read from the table FUTURE_PRODUCT_CHAIN in caslib Public.</div><div class="sasNote" id="sasLogNote188_1620885733386">NOTE: The table future_product_scoring in caslib Public has 0 observations and 5 variables.</div><div class="sasNote" id="sasLogNote189_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.20 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              1404.09k</div><div class="sasNote">      OS Memory           36376.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:44:58 AM</div><div class="sasNote">      Step Count                        58  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     86</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        86</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">858   </div><div class="sasSource">859   /* Фильтруем временные ряды, оставляя только даты в рамках (hist_end_dt,</div><div class="sasSource">859 ! hist_end_dt+91) */</div><div class="sasSource">860   proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote190_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">861   create table public.future_product_scoring{options replace=true} as</div><div class="sasSource">862   select</div><div class="sasSource">863   channel_cd,</div><div class="sasSource">864   product_id,</div><div class="sasSource">865   pbo_location_id,</div><div class="sasSource">866   sales_dt,</div><div class="sasSource">867   . as sum_qty,</div><div class="sasSource">868   . as GROSS_PRICE_AMT</div><div class="sasSource">869   from</div><div class="sasSource">870   public.future_product_scoring</div><div class="sasSource">871   where</div><div class="sasSource">872   sales_dt &gt; &amp;hist_end_dt. and</div><div class="sasSource">873   sales_dt &lt;= &amp;hist_end_dt. + 91</div><div class="sasSource">874   ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote191_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table FUTURE_PRODUCT_SCORING was created in caslib Public with 0 rows returned.</div><div class="sasNote" id="sasLogNote192_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">875   quit;</div><div class="sasNote" id="sasLogNote193_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              86.50k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:44:58 AM</div><div class="sasNote">      Step Count                        59  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        28</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">876   </div><div class="sasSource">877   /* Добавляем к abt новые товары */</div><div class="sasSource">878   data public.abt1_ml_unioun;</div><div class="sasSource">879   set public.abt1_ml public.future_product_scoring;</div><div class="sasSource">880   run;</div><div class="sasNote" id="sasLogNote194_1620885733386">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote195_1620885733386">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote196_1620885733386">NOTE: There were 176780916 observations read from the table ABT1_ML in caslib Public.</div><div class="sasNote" id="sasLogNote197_1620885733386">NOTE: There were 0 observations read from the table FUTURE_PRODUCT_SCORING in caslib Public.</div><div class="sasNote" id="sasLogNote198_1620885733386">NOTE: The table abt1_ml_unioun in caslib Public has 176780916 observations and 6 variables.</div><div class="sasNote" id="sasLogNote199_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           7.94 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              1443.84k</div><div class="sasNote">      OS Memory           36376.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:45:06 AM</div><div class="sasNote">      Step Count                        60  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     29</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        153</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">881   </div><div class="sasSource">882   /* Избавляемся от дублей, которые могут возникнуть при объединении */</div><div class="sasSource">883   proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote200_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">884   create table public.abt1_ml{options replace=true} as</div><div class="sasSource">885   select</div><div class="sasSource">886   channel_cd,</div><div class="sasSource">887   product_id,</div><div class="sasSource">888   pbo_location_id,</div><div class="sasSource">889   sales_dt,</div><div class="sasSource">890   max(sum_qty) as sum_qty,</div><div class="sasSource">891   max(GROSS_PRICE_AMT) as GROSS_PRICE_AMT</div><div class="sasSource">892   from</div><div class="sasSource">893   public.abt1_ml_unioun</div><div class="sasSource">894   group by</div><div class="sasSource">895   channel_cd,</div><div class="sasSource">896   product_id,</div><div class="sasSource">897   pbo_location_id,</div><div class="sasSource">898   sales_dt</div><div class="sasSource">899   ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote201_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT1_ML was created in caslib Public with 176780916 rows returned.</div><div class="sasNote" id="sasLogNote202_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">900   quit;</div><div class="sasNote" id="sasLogNote203_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           52.75 seconds</div><div class="sasNote">      user cpu time       0.03 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              255.53k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:45:59 AM</div><div class="sasNote">      Step Count                        61  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     23</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        307</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           32</div><div class="sasNote">      </div><div class="sasSource">901   </div><div class="sasSource">902   proc casutil;</div><div class="sasNote" id="sasLogNote204_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">903   /*   droptable casdata="abt1_ml" incaslib="public" quiet; */</div><div class="sasSource">904   </div><div class="sasSource">904 !    droptable casdata="abt1_ml_unioun" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote205_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.993266 seconds.</div><div class="sasSource">905   run;</div><div class="sasSource">906   </div><div class="sasSource">907   /****** 3. Добавление цен ******/</div><div class="sasNote" id="sasLogNote206_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           1.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.06k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:46:00 AM</div><div class="sasNote">      Step Count                        62  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        10</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">908   proc casutil;</div><div class="sasNote" id="sasLogNote207_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">909     droptable casdata="price_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote208_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.040429 seconds.</div><div class="sasSource">910     droptable casdata="abt2_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote209_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.055063 seconds.</div><div class="sasSource">911     load data=&amp;inlib..ia_price_history casout='ia_price_history' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote210_1620885733386">NOTE: IA.IA_PRICE_HISTORY was successfully added to the "Public" caslib as "IA_PRICE_HISTORY".</div><div class="sasSource">912     load data=&amp;inlib..ia_price casout='ia_price' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote211_1620885733386">NOTE: IA.IA_PRICE was successfully added to the "Public" caslib as "IA_PRICE".</div><div class="sasSource">913   run;</div><div class="sasSource">914   </div><div class="sasNote" id="sasLogNote212_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           34.82 seconds</div><div class="sasNote">      user cpu time       2.25 seconds</div><div class="sasNote">      system cpu time     0.65 seconds</div><div class="sasNote">      memory              2586.06k</div><div class="sasNote">      OS Memory           37500.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:46:34 AM</div><div class="sasNote">      Step Count                        63  Switch Count  1423</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     39074</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        15985</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">915   proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote213_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">916   /* Объединяем историю с актуальными данными */</div><div class="sasSource">917   create table public.price_ml{options replace=true} as</div><div class="sasSource">918   select</div><div class="sasSource">919   coalesce(t1.PBO_LOCATION_ID, t2.PBO_LOCATION_ID) as PBO_LOCATION_ID,</div><div class="sasSource">920   coalesce(t1.PRODUCT_ID, t2.PRODUCT_ID) as PRODUCT_ID,</div><div class="sasSource">921   coalesce(datepart(t1.start_dt), datepart(t2.start_dt)) as start_dt,</div><div class="sasSource">922   coalesce(datepart(t1.end_dt), datepart(t2.end_dt)) as end_dt,</div><div class="sasSource">923   coalesce(t1.GROSS_PRICE_AMT, t2.GROSS_PRICE_AMT) as GROSS_PRICE_AMT,</div><div class="sasSource">924   coalesce(t1.NET_PRICE_AMT, t2.NET_PRICE_AMT) as NET_PRICE_AMT,</div><div class="sasSource">925   coalesce(t1.PRICE_TYPE, t2.PRICE_TYPE) as PRICE_TYPE</div><div class="sasSource">926   from</div><div class="sasSource">927   public.ia_price as t1</div><div class="sasSource">928   full outer join</div><div class="sasSource">929   public.ia_price_history as t2</div><div class="sasSource">930   on</div><div class="sasSource">931   t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">932   t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">933   t1.start_dt = t2.start_dt and</div><div class="sasSource">934   t1.end_dt = t2.end_dt and</div><div class="sasSource">935   t1.PRICE_TYPE = t2.PRICE_TYPE</div><div class="sasSource">936   ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote214_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table PRICE_ML was created in caslib Public with 2159654 rows returned.</div><div class="sasNote" id="sasLogNote215_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">937   quit;</div><div class="sasNote" id="sasLogNote216_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.92 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              234.96k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:46:35 AM</div><div class="sasNote">      Step Count                        64  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        35</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">938   </div><div class="sasSource">939   /* Добавляем к продажам цены */</div><div class="sasSource">940   proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote217_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">941   create table public.abt2_ml{options replace=true} as</div><div class="sasSource">942           select</div><div class="sasSource">943               t1.PBO_LOCATION_ID,</div><div class="sasSource">944               t1.PRODUCT_ID,</div><div class="sasSource">945               t1.CHANNEL_CD,</div><div class="sasSource">946               t1.SALES_DT,</div><div class="sasSource">947               t1.sum_qty,</div><div class="sasSource">948               max(t2.GROSS_PRICE_AMT) as GROSS_PRICE_AMT</div><div class="sasSource">949           from</div><div class="sasSource">950               public.abt1_ml as t1 left join</div><div class="sasSource">951               public.price_ml as t2</div><div class="sasSource">952           on</div><div class="sasSource">953               t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">954               t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">955               t1.SALES_DT &lt;= t2.end_dt and</div><div class="sasSource">956               t1.SALES_DT &gt;= t2.start_dt</div><div class="sasSource">957           group by</div><div class="sasSource">958   t1.PBO_LOCATION_ID,</div><div class="sasSource">959               t1.PRODUCT_ID,</div><div class="sasSource">960               t1.CHANNEL_CD,</div><div class="sasSource">961               t1.SALES_DT,</div><div class="sasSource">962               t1.sum_qty</div><div class="sasSource">963       ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote218_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT2_ML was created in caslib Public with 176780916 rows returned.</div><div class="sasNote" id="sasLogNote219_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">964   quit;</div><div class="sasNote" id="sasLogNote220_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           55.46 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              260.28k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:47:31 AM</div><div class="sasNote">      Step Count                        65  Switch Count  4</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     24</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        325</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           32</div><div class="sasNote">      </div><div class="sasSource">965   </div><div class="sasSource">966   /****** 2. Протяжка временных рядов ******/</div><div class="sasSource">967   proc casutil;</div><div class="sasNote" id="sasLogNote221_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">968     droptable casdata="abt3_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote222_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.017588 seconds.</div><div class="sasSource">969     droptable casdata="abt1_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote223_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.759961 seconds.</div><div class="sasSource">970   run;</div><div class="sasSource">971   </div><div class="sasSource">972   %let fc_end_sas=%sysfunc(inputn(%scan(%bquote(&amp;hist_end_dt),2,%bquote(' )),yymmdd10.));</div><div class="sasSource">973   %let fc_end= %sysfunc(intnx(day,&amp;fc_end_sas, 91),yymmddd10.);</div><div class="sasNote" id="sasLogNote224_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.79 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              256.03k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:47:32 AM</div><div class="sasNote">      Step Count                        66  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     19</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        21</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">974   proc cas;</div><div class="sasSource">975   timeData.timeSeries result =r /</div><div class="sasSource">976   series={</div><div class="sasSource">977   {name="sum_qty", setmiss="MISSING"},</div><div class="sasSource">978   {name="GROSS_PRICE_AMT", setmiss="PREV"}</div><div class="sasSource">979   }</div><div class="sasSource">980   tEnd= "&amp;fc_end"</div><div class="sasSource">981   table={</div><div class="sasSource">982   caslib="public",</div><div class="sasSource">983   name="abt2_ml",</div><div class="sasSource">984   groupby={"PBO_LOCATION_ID","PRODUCT_ID", "CHANNEL_CD"}</div><div class="sasSource">985   }</div><div class="sasSource">986   timeId="SALES_DT"</div><div class="sasSource">987   trimId="LEFT"</div><div class="sasSource">988   interval="day"</div><div class="sasSource">989   casOut={caslib="public", name="abt3_ml", replace=True}</div><div class="sasSource">990   ;</div><div class="sasSource">991   run;</div><div class="sasNote" id="sasLogNote225_1620885733386">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote226_1620885733386">NOTE: Added action set 'timeData'.</div><div class="sasSource">992   quit;</div><div class="sasNote" id="sasLogNote227_1620885733386">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           3:07.10</div><div class="sasNote">      user cpu time       0.10 seconds</div><div class="sasNote">      system cpu time     0.02 seconds</div><div class="sasNote">      memory              10164.25k</div><div class="sasNote">      OS Memory           45184.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:50:39 AM</div><div class="sasNote">      Step Count                        67  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1066</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        997</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           72</div><div class="sasNote">      </div><div class="sasSource">993   proc casutil;</div><div class="sasNote" id="sasLogNote228_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">994     droptable casdata="price_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote229_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.029275 seconds.</div><div class="sasSource">995     droptable casdata="ia_price_history" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote230_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.027347 seconds.</div><div class="sasSource">996     droptable casdata="ia_price" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote231_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.011954 seconds.</div><div class="sasSource">997     droptable casdata="abt2_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote232_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.811313 seconds.</div><div class="sasSource">998   run;</div><div class="sasSource">999   /****** 4. Фильтрация ******/</div><div class="sasSource">1000  /* Проверки. Аня писала, что могут буть дубли. Вставил дополнительную</div><div class="sasSource">1000! проверку */</div><div class="sasSource">1001  %macro check(table, name);</div><div class="sasSource">1002  proc fedsql sessref=casauto;</div><div class="sasSource">1003  select</div><div class="sasSource">1004  count(1) as &amp;name.</div><div class="sasSource">1005  from</div><div class="sasSource">1006  (</div><div class="sasSource">1007  select</div><div class="sasSource">1008  pbo_location_id,</div><div class="sasSource">1009  product_id,</div><div class="sasSource">1010  sales_dt,</div><div class="sasSource">1011  channel_cd,</div><div class="sasSource">1012  count(sales_dt) as cnt</div><div class="sasSource">1013  from</div><div class="sasSource">1014  public.&amp;table.</div><div class="sasSource">1015  group by</div><div class="sasSource">1016  pbo_location_id,</div><div class="sasSource">1017  product_id,</div><div class="sasSource">1018  sales_dt,</div><div class="sasSource">1019  channel_cd</div><div class="sasSource">1020  ) as t1</div><div class="sasSource">1021  where</div><div class="sasSource">1022  t1.cnt &gt; 1</div><div class="sasSource">1023  ;</div><div class="sasSource">1024  quit;</div><div class="sasSource">1025  %mend;</div><div class="sasNote" id="sasLogNote233_1620885733386">NOTE: The macro CHECK completed compilation without errors.</div><div class="sasNote">      11 instructions 520 bytes.</div><div class="sasSource">1026  /* 4.1 Убираем временные закрытия ПБО */</div><div class="sasNote" id="sasLogNote234_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.91 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              116.18k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:50:40 AM</div><div class="sasNote">      Step Count                        68  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1027  proc casutil;</div><div class="sasNote" id="sasLogNote235_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">1028  </div><div class="sasSource">1028!  droptable casdata="pbo_closed_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote236_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.017212 seconds.</div><div class="sasSource">1029  </div><div class="sasSource">1029!  droptable casdata="abt4_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote237_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016888 seconds.</div><div class="sasSource">1030  </div><div class="sasSource">1030!  load data=&amp;inlib..ia_pbo_close_period casout='ia_pbo_close_period' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote238_1620885733386">NOTE: IA.IA_PBO_CLOSE_PERIOD was successfully added to the "Public" caslib as "IA_PBO_CLOSE_PERIOD".</div><div class="sasSource">1031  run;</div><div class="sasSource">1032  /* заполняем пропуски в end_dt */</div><div class="sasNote" id="sasLogNote239_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           50.35 seconds</div><div class="sasNote">      user cpu time       0.15 seconds</div><div class="sasNote">      system cpu time     0.14 seconds</div><div class="sasNote">      memory              2496.53k</div><div class="sasNote">      OS Memory           37464.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:51:30 AM</div><div class="sasNote">      Step Count                        69  Switch Count  303</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     16179</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        2325</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">1033  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote240_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1034  create table public.pbo_closed_ml {options replace=true} as</div><div class="sasSource">1035  select</div><div class="sasSource">1036  CHANNEL_CD,</div><div class="sasSource">1037  PBO_LOCATION_ID,</div><div class="sasSource">1038  datepart(start_dt) as start_dt,</div><div class="sasSource">1039  coalesce(datepart(end_dt), date '2100-01-01') as end_dt,</div><div class="sasSource">1040  CLOSE_PERIOD_DESC</div><div class="sasSource">1041  from</div><div class="sasSource">1042  public.ia_pbo_close_period</div><div class="sasSource">1043  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote241_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table PBO_CLOSED_ML was created in caslib Public with 75639 rows returned.</div><div class="sasNote" id="sasLogNote242_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1044  quit;</div><div class="sasNote" id="sasLogNote243_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.19 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              90.21k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:51:30 AM</div><div class="sasNote">      Step Count                        70  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        28</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1045  /* Удалаем даты закрытия pbo из abt */</div><div class="sasSource">1046  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote244_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1047  create table public.abt4_ml{options replace=true} as</div><div class="sasSource">1048  select</div><div class="sasSource">1049  t1.PBO_LOCATION_ID,</div><div class="sasSource">1050  t1.PRODUCT_ID,</div><div class="sasSource">1051  t1.CHANNEL_CD,</div><div class="sasSource">1052  t1.SALES_DT,</div><div class="sasSource">1053  t1.sum_qty,</div><div class="sasSource">1054  t1.GROSS_PRICE_AMT</div><div class="sasSource">1055  from</div><div class="sasSource">1056  public.abt3_ml as t1</div><div class="sasSource">1057  left join</div><div class="sasSource">1058  public.pbo_closed_ml as t2</div><div class="sasSource">1059  on</div><div class="sasSource">1060  t1.sales_dt &gt;= t2.start_dt and</div><div class="sasSource">1061  t1.sales_dt &lt;= t2.end_dt and</div><div class="sasSource">1062  t1.pbo_location_id = t2.pbo_location_id and</div><div class="sasSource">1063  t1.channel_cd = t2.channel_cd</div><div class="sasSource">1064  where</div><div class="sasSource">1065  t2.pbo_location_id is missing</div><div class="sasSource">1066  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote245_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT4_ML was created in caslib Public with 494547430 rows returned.</div><div class="sasNote" id="sasLogNote246_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1067  quit;</div><div class="sasNote" id="sasLogNote247_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           25.68 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              228.25k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:51:56 AM</div><div class="sasNote">      Step Count                        71  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        158</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1068  /* 4.2 Убираем закрытые насовсем магазины */</div><div class="sasSource">1069  proc casutil;</div><div class="sasNote" id="sasLogNote248_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">1070  </div><div class="sasSource">1070!  load data=&amp;inlib..IA_PBO_LOC_ATTRIBUTES casout='IA_PBO_LOC_ATTRIBUTES' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote249_1620885733386">NOTE: IA.IA_PBO_LOC_ATTRIBUTES was successfully added to the "Public" caslib as "IA_PBO_LOC_ATTRIBUTES".</div><div class="sasSource">1071  </div><div class="sasSource">1071!  droptable casdata="closed_pbo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote250_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.013886 seconds.</div><div class="sasSource">1072  run;</div><div class="sasNote" id="sasLogNote251_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.52 seconds</div><div class="sasNote">      user cpu time       0.04 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              2091.00k</div><div class="sasNote">      OS Memory           36904.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:51:56 AM</div><div class="sasNote">      Step Count                        72  Switch Count  70</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     2575</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        451</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1073  proc cas;</div><div class="sasSource">1074  transpose.transpose /</div><div class="sasSource">1075     table={name="ia_pbo_loc_attributes", caslib="public", groupby={"pbo_location_id"}}</div><div class="sasSource">1076     attributes={{name="pbo_location_id"}}</div><div class="sasSource">1077     transpose={"PBO_LOC_ATTR_VALUE"}</div><div class="sasSource">1078     prefix="A_"</div><div class="sasSource">1079     id={"PBO_LOC_ATTR_NM"}</div><div class="sasSource">1080     casout={name="attr_transposed", caslib="public", replace=true};</div><div class="sasSource">1081  quit;</div><div class="sasNote" id="sasLogNote252_1620885733386">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote253_1620885733386">NOTE: There were 17380 rows read from the table IA_PBO_LOC_ATTRIBUTES.</div><div class="sasNote" id="sasLogNote254_1620885733386">NOTE: The table attr_transposed has 869 rows and 23 columns.</div><div class="sasNote" id="sasLogNote255_1620885733386">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.14 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              10003.59k</div><div class="sasNote">      OS Memory           45184.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:51:57 AM</div><div class="sasNote">      Step Count                        73  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     980</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        13</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1082  /* Преобразовываем даты открытия и закрытия магазинов */</div><div class="sasSource">1083  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote256_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1084  create table public.closed_pbo{options replace=true} as</div><div class="sasSource">1085  select distinct</div><div class="sasSource">1086  pbo_location_id,</div><div class="sasSource">1087      cast(inputn(A_OPEN_DATE,'ddmmyy10.') as date) as OPEN_DATE,</div><div class="sasSource">1088      coalesce(</div><div class="sasSource">1089  cast(inputn(A_CLOSE_DATE,'ddmmyy10.') as date),</div><div class="sasSource">1090  date '2100-01-01'</div><div class="sasSource">1091  ) as CLOSE_DATE</div><div class="sasSource">1092  from public.attr_transposed</div><div class="sasSource">1093  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote257_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table CLOSED_PBO was created in caslib Public with 869 rows returned.</div><div class="sasNote" id="sasLogNote258_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1094  quit;</div><div class="sasNote" id="sasLogNote259_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.24 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              92.84k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:51:57 AM</div><div class="sasNote">      Step Count                        74  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        36</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1095  /* Удаляем закрытые насовсем магазины  */</div><div class="sasSource">1096  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote260_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1097  create table public.abt4_ml{options replace = true} as</div><div class="sasSource">1098  select</div><div class="sasSource">1099  t1.PBO_LOCATION_ID,</div><div class="sasSource">1100  t1.PRODUCT_ID,</div><div class="sasSource">1101  t1.CHANNEL_CD,</div><div class="sasSource">1102  t1.SALES_DT,</div><div class="sasSource">1103  t1.sum_qty,</div><div class="sasSource">1104  t1.GROSS_PRICE_AMT</div><div class="sasSource">1105  from</div><div class="sasSource">1106  public.abt4_ml as t1</div><div class="sasSource">1107  left join</div><div class="sasSource">1108  public.closed_pbo as t2</div><div class="sasSource">1109  on</div><div class="sasSource">1110  t1.pbo_location_id = t2.pbo_location_id and</div><div class="sasSource">1111  t1.sales_dt &gt;= t2.OPEN_DATE and</div><div class="sasSource">1112  t1.sales_dt &lt;= t2.CLOSE_DATE</div><div class="sasSource">1113  where</div><div class="sasSource">1114  t2.pbo_location_id is not missing</div><div class="sasSource">1115  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote261_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">ERROR: Cloud Analytic Services failed writing to system disk space. Please contact your administrator.</div><div class="sasSource">ERROR: Cloud Analytic Services failed writing to system disk space. Please contact your administrator.</div><div class="sasSource">ERROR: FedSQL: Function tkcaslibGetTableMetadata returned 0x887fc200 at /sas/dev/mva-vb025f/tkesql/src/sqlexec.c:2636.</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError1_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote262_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">1116  quit;</div><div class="sasNote" id="sasLogNote263_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           16.48 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              226.09k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:13 AM</div><div class="sasNote">      Step Count                        75  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        127</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">1117  /* &lt;UPDATE&gt; */</div><div class="sasSource">1118  /* 4.3 Оставляем нулевые продажи в периодах ввода товаров из product chain */</div><div class="sasSource">1119  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote264_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1120  create table public.abt4_ml{options replace=true} as</div><div class="sasSource">1121  select</div><div class="sasSource">1122  t1.PBO_LOCATION_ID,</div><div class="sasSource">1123  t1.PRODUCT_ID,</div><div class="sasSource">1124  t1.CHANNEL_CD,</div><div class="sasSource">1125  t1.SALES_DT,</div><div class="sasSource">1126  t2.predecessor_product_id,</div><div class="sasSource">1127  /* coalesce(t1.sum_qty, case when t2.predecessor_product_id ^= . then 0 else . end) as sum_qty, */</div><div class="sasSource">1128  coalesce(t1.sum_qty, case when sales_dt between date '2020-11-01' and date '2021-01-31' then 0 else . end) as sum_qty,</div><div class="sasSource">1129  /* case when t2.predecessor_product_id ^= . then coalesce(t1.sum_qty, 0) else . end as sum_qty, */</div><div class="sasSource">1130  t1.GROSS_PRICE_AMT</div><div class="sasSource">1131  from</div><div class="sasSource">1132  public.abt4_ml as t1</div><div class="sasSource">1133  left join</div><div class="sasSource">1134  public.ia_product_chain t2</div><div class="sasSource">1135  on</div><div class="sasSource">1136  t2.predecessor_product_id = t1.product_id</div><div class="sasSource">1137  and t2.predecessor_dim2_id = t1.pbo_location_id</div><div class="sasSource">1138  and t1.sales_dt between datepart(t2.successor_start_dt) and datepart(t2.predecessor_end_dt)</div><div class="sasSource">1139  and t2.lifecycle_cd = 'N'</div><div class="sasSource">1140  and t1.sales_dt &lt;= &amp;hist_end_dt.</div><div class="sasSource">1141  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote265_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.ABT4_ML" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError2_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote266_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">1142  quit;</div><div class="sasNote" id="sasLogNote267_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              110.93k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:13 AM</div><div class="sasNote">      Step Count                        76  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1143  /* &lt;/UPDATE&gt; */</div><div class="sasSource">1144  /* 4.4 Убираем из истории пропуски в продажах */</div><div class="sasSource">1145  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote268_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1146  create table public.abt4_ml{options replace=true} as</div><div class="sasSource">1147  select</div><div class="sasSource">1148  t1.PBO_LOCATION_ID,</div><div class="sasSource">1149  t1.PRODUCT_ID,</div><div class="sasSource">1150  t1.CHANNEL_CD,</div><div class="sasSource">1151  t1.SALES_DT,</div><div class="sasSource">1152  t1.sum_qty,</div><div class="sasSource">1153  t1.GROSS_PRICE_AMT</div><div class="sasSource">1154  from</div><div class="sasSource">1155  public.abt4_ml as t1</div><div class="sasSource">1156  where</div><div class="sasSource">1157  (t1.sum_qty is not missing and t1.sales_dt &lt;= &amp;hist_end_dt.) or</div><div class="sasSource">1158  (t1.sales_dt &gt; &amp;hist_end_dt.)</div><div class="sasSource">1159  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote269_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.ABT4_ML" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError3_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote270_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">1160  quit;</div><div class="sasNote" id="sasLogNote271_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.93k</div><div class="sasNote">      OS Memory           35348.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:13 AM</div><div class="sasNote">      Step Count                        77  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1161  /* 4.4 Пересекаем с АМ. Оставляем ВР если он есть в АМ или product_chain с</div><div class="sasSource">1161! флагом N */</div><div class="sasSource">1162  proc casutil;</div><div class="sasNote" id="sasLogNote272_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">1163  </div><div class="sasSource">1163!  load data=&amp;inlib..ia_assort_matrix casout='ia_assort_matrix' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote273_1620885733386">NOTE: IA.IA_ASSORT_MATRIX was successfully added to the "Public" caslib as "IA_ASSORT_MATRIX".</div><div class="sasSource">1164  run;</div><div class="sasNote" id="sasLogNote274_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           3.10 seconds</div><div class="sasNote">      user cpu time       0.14 seconds</div><div class="sasNote">      system cpu time     0.05 seconds</div><div class="sasNote">      memory              2420.59k</div><div class="sasNote">      OS Memory           37444.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:16 AM</div><div class="sasNote">      Step Count                        78  Switch Count  97</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     2809</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        1099</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1165  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote275_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1166  create table public.abt4_ml {options replace = true} as</div><div class="sasSource">1167  select</div><div class="sasSource">1168  t1.PBO_LOCATION_ID,</div><div class="sasSource">1169  t1.PRODUCT_ID,</div><div class="sasSource">1170  t1.CHANNEL_CD,</div><div class="sasSource">1171  t1.SALES_DT,</div><div class="sasSource">1172  t1.sum_qty,</div><div class="sasSource">1173  t1.GROSS_PRICE_AMT</div><div class="sasSource">1174  from</div><div class="sasSource">1175  public.abt4_ml as t1</div><div class="sasSource">1176  left join</div><div class="sasSource">1177  public.ia_assort_matrix  t2</div><div class="sasSource">1178  on</div><div class="sasSource">1179  t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">1180  t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">1181  t1.SALES_DT &lt;= datepart(t2.end_dt) and</div><div class="sasSource">1182  t1.SALES_DT &gt;= datepart(t2.start_dt)</div><div class="sasSource">1183  left join</div><div class="sasSource">1184  public.future_product_scoring as t3</div><div class="sasSource">1185  on</div><div class="sasSource">1186  t1.PBO_LOCATION_ID = t3.PBO_LOCATION_ID and</div><div class="sasSource">1187  t1.PRODUCT_ID = t3.PRODUCT_ID and</div><div class="sasSource">1188  t1.sales_dt = t3.sales_dt</div><div class="sasSource">1189  where</div><div class="sasSource">1190  (t1.SALES_DT &lt;= &amp;hist_end_dt) or</div><div class="sasSource">1191  (t2.PBO_LOCATION_ID is not missing) or</div><div class="sasSource">1192  (t3.PBO_LOCATION_ID is not missing)</div><div class="sasSource">1193  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote276_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.ABT4_ML" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError4_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote277_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">1194  quit;</div><div class="sasNote" id="sasLogNote278_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              228.18k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:17 AM</div><div class="sasNote">      Step Count                        79  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1195  /* Это нужно на ретроспективе, чтобы лаги считались правильно */</div><div class="sasSource">1196  /* proc fedsql sessref=casauto; */</div><div class="sasSource">1197  /* create table public.abt4_ml {options replace = true} as */</div><div class="sasSource">1198  /* select */</div><div class="sasSource">1199  /* t1.PBO_LOCATION_ID, */</div><div class="sasSource">1200  /* t1.PRODUCT_ID, */</div><div class="sasSource">1201  /* t1.CHANNEL_CD, */</div><div class="sasSource">1202  /* t1.SALES_DT, */</div><div class="sasSource">1203  /* case when t1.sales_dt &lt;= date '2020-10-31' then t1.sum_qty else . end as sum_qty, */</div><div class="sasSource">1204  /* t1.GROSS_PRICE_AMT */</div><div class="sasSource">1205  /* from */</div><div class="sasSource">1206  /* public.abt4_ml t1 */</div><div class="sasSource">1207  /* ; */</div><div class="sasSource">1208  /* quit; */</div><div class="sasSource">1209  proc casutil;</div><div class="sasNote" id="sasLogNote279_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">1210  </div><div class="sasSource">1210!  droptable casdata="pbo_closed_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote280_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.021321 seconds.</div><div class="sasSource">1211  </div><div class="sasSource">1211!  droptable casdata="closed_pbo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote281_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.010057 seconds.</div><div class="sasSource">1212  </div><div class="sasSource">1212!  droptable casdata="ia_assort_matrix" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote282_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.010985 seconds.</div><div class="sasSource">1213  </div><div class="sasSource">1213!  droptable casdata="ia_pbo_close_period" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote283_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.021366 seconds.</div><div class="sasSource">1214  </div><div class="sasSource">1214!  droptable casdata="IA_PBO_LOC_ATTRIBUTES" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote284_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.012306 seconds.</div><div class="sasSource">1215  </div><div class="sasSource">1215!  droptable casdata="attr_transposed" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote285_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.011624 seconds.</div><div class="sasSource">1216      droptable casdata="abt3_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote286_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 1.849141 seconds.</div><div class="sasSource">1217  /* promote casdata="abt4_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">1218  run;</div><div class="sasSource">1219  /****** 5. Подсчет лагов ******/</div><div class="sasNote" id="sasLogNote287_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           2.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              117.71k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:19 AM</div><div class="sasNote">      Step Count                        80  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        44</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1220  proc casutil;</div><div class="sasNote" id="sasLogNote288_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">1221    droptable casdata='lag_abt1' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote289_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.014387 seconds.</div><div class="sasSource">1222    droptable casdata='lag_abt2' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote290_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.012358 seconds.</div><div class="sasSource">1223    droptable casdata='lag_abt3' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote291_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016489 seconds.</div><div class="sasSource">1224    droptable casdata='abt5_ml' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote292_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01554 seconds.</div><div class="sasSource">1225  run;</div><div class="sasSource">1226  /* Макрос разворачивает переменную var в список элементов массива,</div><div class="sasSource">1226! разделенных запятой */</div><div class="sasSource">1227  /* var[t-0],var[t-1],var[t-2],... */</div><div class="sasSource">1228  %macro argt(var,index,start,end);</div><div class="sasSource">1229  %do ii=&amp;start. %to &amp;end.;</div><div class="sasSource">1230   &amp;var.[&amp;index.-&amp;ii.]</div><div class="sasSource">1231   %if &amp;ii. ne &amp;end. %then %do;</div><div class="sasSource">1232    ,</div><div class="sasSource">1233   %end;</div><div class="sasSource">1234  %end;</div><div class="sasSource">1235  %mend argt;</div><div class="sasNote" id="sasLogNote293_1620885733386">NOTE: The macro ARGT completed compilation without errors.</div><div class="sasNote">      25 instructions 592 bytes.</div><div class="sasSource">1236  /* Перекодирование числа дней в название интервала*/</div><div class="sasSource">1237  %macro namet(l_int);</div><div class="sasSource">1238  %if &amp;l_int=7 %then week ;</div><div class="sasSource">1239  %if &amp;l_int=30 %then month ;</div><div class="sasSource">1240  %if &amp;l_int=90 %then qtr ;</div><div class="sasSource">1241  %if &amp;l_int=180 %then halfyear ;</div><div class="sasSource">1242  %if &amp;l_int=365 %then year ;</div><div class="sasSource">1243  %mend namet;</div><div class="sasNote" id="sasLogNote294_1620885733386">NOTE: The macro NAMET completed compilation without errors.</div><div class="sasNote">      35 instructions 752 bytes.</div><div class="sasSource">1244  /* считаем медиану и среднее арифметическое */</div><div class="sasSource">1245  %macro cmpcode;</div><div class="sasSource">1246  proc cas;</div><div class="sasSource">1247  timeData.runTimeCode result=r /</div><div class="sasSource">1248  table = {</div><div class="sasSource">1249  name ='abt4_ml',</div><div class="sasSource">1250  caslib = 'public',</div><div class="sasSource">1251          groupBy = {</div><div class="sasSource">1252  {name = 'PRODUCT_ID'},</div><div class="sasSource">1253  {name = 'PBO_LOCATION_ID'},</div><div class="sasSource">1254  {name = 'CHANNEL_CD'}</div><div class="sasSource">1255  }</div><div class="sasSource">1256  },</div><div class="sasSource">1257   series = {{name='sum_qty'}},</div><div class="sasSource">1258   interval='DAY',</div><div class="sasSource">1259  timeId = {name='SALES_DT'},</div><div class="sasSource">1260  trimId = "LEFT",</div><div class="sasSource">1261  code=</div><div class="sasSource">1262  %unquote(%str(%"))</div><div class="sasSource">1263  %let names=; /*будущий список выходных переменных для proc cas */</div><div class="sasSource">1264  %let minlag=42; /*параметр MinLag*/</div><div class="sasSource">1265  /*-=-=-=-=-= min_lag + окна -=-=-=-=-=-*/</div><div class="sasSource">1266  %let window_list = 7 30 90 180 365;</div><div class="sasSource">1267  %let lag=&amp;minlag;</div><div class="sasSource">1268  %let n_win_list=%sysfunc(countw(&amp;window_list.));</div><div class="sasSource">1269  %do ic=1 %to &amp;n_win_list.;</div><div class="sasSource">1270    %let window=%scan(&amp;window_list,&amp;ic); /*текущее окно*/</div><div class="sasSource">1271    %let intnm=%namet(&amp;window);        /*название интервала окна; 7-&gt;week итд */</div><div class="sasSource">1272    %let intnm=%sysfunc(strip(&amp;intnm.));</div><div class="sasSource">1273    do t = %eval(&amp;lag+&amp;window) to _length_; /*from=(lag)+(window)*/</div><div class="sasSource">1274      lag_&amp;intnm._avg[t]=mean(%argt(sum_qty,t,%eval(&amp;lag),%eval(&amp;lag+&amp;window-1)));</div><div class="sasSource">1275      lag_&amp;intnm._med[t]=median(%argt(sum_qty,t,%eval(&amp;lag),%eval(&amp;lag+&amp;window-1)));</div><div class="sasSource">1276    end;</div><div class="sasSource">1277   %let names={name=%tslit(lag_&amp;intnm._avg)}, &amp;names;</div><div class="sasSource">1278   %let names={name=%tslit(lag_&amp;intnm._med)}, &amp;names;</div><div class="sasSource">1279  %end; /* ic over window_list*/</div><div class="sasSource">1280  /*remove last comma from names*/</div><div class="sasSource">1281  %let len=%length(&amp;names);</div><div class="sasSource">1282  %let names=%substr(%quote(&amp;names),1,%eval(&amp;len-1));</div><div class="sasSource">1283  /*-=-=-завершающий код proc cas=-=-=*/</div><div class="sasSource">1284  %unquote(%str(%"))</div><div class="sasSource">1285  ,</div><div class="sasSource">1286  arrayOut={</div><div class="sasSource">1287  table={name='lag_abt1', replace=true, caslib='Public'},</div><div class="sasSource">1288      arrays={&amp;names}</div><div class="sasSource">1289  }</div><div class="sasSource">1290  ;</div><div class="sasSource">1291  run;</div><div class="sasSource">1292  quit;</div><div class="sasSource">1293  %mend cmpcode;</div><div class="sasNote" id="sasLogNote295_1620885733386">NOTE: The macro CMPCODE completed compilation without errors.</div><div class="sasNote">      66 instructions 2120 bytes.</div><div class="sasSource">1294  %cmpcode</div><div class="sasNote" id="sasLogNote296_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              633.31k</div><div class="sasNote">      OS Memory           36120.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:19 AM</div><div class="sasNote">      Step Count                        81  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     135</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">MPRINT(CMPCODE):   proc cas;</div><div class="sasSource">MPRINT(CMPCODE):   timeData.runTimeCode result=r / table = { name ='abt4_ml', caslib = 'public', groupBy = { {name = 'PRODUCT_ID'}, </div><div class="sasSource">{name = 'PBO_LOCATION_ID'}, {name = 'CHANNEL_CD'} } }, series = {{name='sum_qty'}}, interval='DAY', timeId = {name='SALES_DT'}, </div><div class="sasSource">trimId = "LEFT", code=</div><div class="sasNote" id="sasLogNote297_1620885733386">NOTE: The quoted string currently being processed has become more than 262 bytes long.  You might have unbalanced quotation marks.</div><div class="sasNote" id="sasLogNote298_1620885733386">NOTE: The macro TSLIT completed compilation without errors.</div><div class="sasNote">      46 instructions 992 bytes.</div><div class="sasSource">MPRINT(CMPCODE):   "     do t = 49 to _length_;        lag_week_avg[t]=mean(sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   , </div><div class="sasSource"> sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]);       lag_week_med[t]=median(sum_qty[t-42]   ,  </div><div class="sasSource">sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]);     end;     do t = </div><div class="sasSource">72 to _length_;        lag_month_avg[t]=mean(sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  </div><div class="sasSource">sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   , </div><div class="sasSource"> sum_qty[t-53]   ,  sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   </div><div class="sasSource">,  sum_qty[t-60]   ,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]  </div><div class="sasSource"> ,  sum_qty[t-67]   ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]);       </div><div class="sasSource">lag_month_med[t]=median(sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  </div><div class="sasSource">sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   , </div><div class="sasSource"> sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   </div><div class="sasSource">,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]  </div><div class="sasSource"> ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]);     end;     do t = 132 to _length_;        </div><div class="sasSource">lag_qtr_avg[t]=mean(sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   </div><div class="sasSource">,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   ,  sum_qty[t-54]  </div><div class="sasSource"> ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   ,  sum_qty[t-61] </div><div class="sasSource">  ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]   ,  </div><div class="sasSource">sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]   ,  sum_qty[t-72]   ,  sum_qty[t-73]   ,  sum_qty[t-74]   , </div><div class="sasSource"> sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  sum_qty[t-78]   ,  sum_qty[t-79]   ,  sum_qty[t-80]   ,  sum_qty[t-81]   </div><div class="sasSource">,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   ,  sum_qty[t-85]   ,  sum_qty[t-86]   ,  sum_qty[t-87]   ,  sum_qty[t-88]  </div><div class="sasSource"> ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95] </div><div class="sasSource">  ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  </div><div class="sasSource">sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  </div><div class="sasSource">sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  </div><div class="sasSource">sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  </div><div class="sasSource">sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  </div><div class="sasSource">sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]);       </div><div class="sasSource">lag_qtr_med[t]=median(sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]  </div><div class="sasSource"> ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   ,  sum_qty[t-54] </div><div class="sasSource">  ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   ,  </div><div class="sasSource">sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]   , </div><div class="sasSource"> sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]   ,  sum_qty[t-72]   ,  sum_qty[t-73]   ,  sum_qty[t-74]   </div><div class="sasSource">,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  sum_qty[t-78]   ,  sum_qty[t-79]   ,  sum_qty[t-80]   ,  sum_qty[t-81]  </div><div class="sasSource"> ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   ,  sum_qty[t-85]   ,  sum_qty[t-86]   ,  sum_qty[t-87]   ,  sum_qty[t-88] </div><div class="sasSource">  ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  </div><div class="sasSource">sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   </div><div class="sasSource">,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  </div><div class="sasSource">sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  </div><div class="sasSource">sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  </div><div class="sasSource">sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  </div><div class="sasSource">sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]);     end;     </div><div class="sasSource">do t = 222 to _length_;        lag_halfyear_avg[t]=mean(sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  </div><div class="sasSource">sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   , </div><div class="sasSource"> sum_qty[t-53]   ,  sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   </div><div class="sasSource">,  sum_qty[t-60]   ,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]  </div><div class="sasSource"> ,  sum_qty[t-67]   ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]   ,  sum_qty[t-72]   ,  sum_qty[t-73] </div><div class="sasSource">  ,  sum_qty[t-74]   ,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  sum_qty[t-78]   ,  sum_qty[t-79]   ,  </div><div class="sasSource">sum_qty[t-80]   ,  sum_qty[t-81]   ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   ,  sum_qty[t-85]   ,  sum_qty[t-86]   , </div><div class="sasSource"> sum_qty[t-87]   ,  sum_qty[t-88]   ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   </div><div class="sasSource">,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100] </div><div class="sasSource">  ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  </div><div class="sasSource">sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  </div><div class="sasSource">sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  </div><div class="sasSource">sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  </div><div class="sasSource">sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  </div><div class="sasSource">sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  </div><div class="sasSource">sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  </div><div class="sasSource">sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  </div><div class="sasSource">sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  </div><div class="sasSource">sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  </div><div class="sasSource">sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  </div><div class="sasSource">sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  </div><div class="sasSource">sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  </div><div class="sasSource">sum_qty[t-179]   ,  sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  </div><div class="sasSource">sum_qty[t-185]   ,  sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  </div><div class="sasSource">sum_qty[t-191]   ,  sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  </div><div class="sasSource">sum_qty[t-197]   ,  sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  </div><div class="sasSource">sum_qty[t-203]   ,  sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  </div><div class="sasSource">sum_qty[t-209]   ,  sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  </div><div class="sasSource">sum_qty[t-215]   ,  sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  </div><div class="sasSource">sum_qty[t-221]);       lag_halfyear_med[t]=median(sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  </div><div class="sasSource">sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   , </div><div class="sasSource"> sum_qty[t-53]   ,  sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   </div><div class="sasSource">,  sum_qty[t-60]   ,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]  </div><div class="sasSource"> ,  sum_qty[t-67]   ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]   ,  sum_qty[t-72]   ,  sum_qty[t-73] </div><div class="sasSource">  ,  sum_qty[t-74]   ,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  sum_qty[t-78]   ,  sum_qty[t-79]   ,  </div><div class="sasSource">sum_qty[t-80]   ,  sum_qty[t-81]   ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   ,  sum_qty[t-85]   ,  sum_qty[t-86]   , </div><div class="sasSource"> sum_qty[t-87]   ,  sum_qty[t-88]   ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   </div><div class="sasSource">,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100] </div><div class="sasSource">  ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  </div><div class="sasSource">sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  </div><div class="sasSource">sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  </div><div class="sasSource">sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  </div><div class="sasSource">sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  </div><div class="sasSource">sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  </div><div class="sasSource">sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  </div><div class="sasSource">sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  </div><div class="sasSource">sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  </div><div class="sasSource">sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  </div><div class="sasSource">sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  </div><div class="sasSource">sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  </div><div class="sasSource">sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  </div><div class="sasSource">sum_qty[t-179]   ,  sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  </div><div class="sasSource">sum_qty[t-185]   ,  sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  </div><div class="sasSource">sum_qty[t-191]   ,  sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  </div><div class="sasSource">sum_qty[t-197]   ,  sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  </div><div class="sasSource">sum_qty[t-203]   ,  sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  </div><div class="sasSource">sum_qty[t-209]   ,  sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  </div><div class="sasSource">sum_qty[t-215]   ,  sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  </div><div class="sasSource">sum_qty[t-221]);     end;     do t = 407 to _length_;        lag_year_avg[t]=mean(sum_qty[t-42]   ,  sum_qty[t-43]   ,  </div><div class="sasSource">sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   , </div><div class="sasSource"> sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   ,  sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   </div><div class="sasSource">,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   ,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]  </div><div class="sasSource"> ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]   ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71] </div><div class="sasSource">  ,  sum_qty[t-72]   ,  sum_qty[t-73]   ,  sum_qty[t-74]   ,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  </div><div class="sasSource">sum_qty[t-78]   ,  sum_qty[t-79]   ,  sum_qty[t-80]   ,  sum_qty[t-81]   ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   , </div><div class="sasSource"> sum_qty[t-85]   ,  sum_qty[t-86]   ,  sum_qty[t-87]   ,  sum_qty[t-88]   ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   </div><div class="sasSource">,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]  </div><div class="sasSource"> ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  </div><div class="sasSource">sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  </div><div class="sasSource">sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  </div><div class="sasSource">sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  </div><div class="sasSource">sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  </div><div class="sasSource">sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  </div><div class="sasSource">sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  </div><div class="sasSource">sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  </div><div class="sasSource">sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  </div><div class="sasSource">sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  </div><div class="sasSource">sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  </div><div class="sasSource">sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  </div><div class="sasSource">sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  </div><div class="sasSource">sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  </div><div class="sasSource">sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  </div><div class="sasSource">sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  </div><div class="sasSource">sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  </div><div class="sasSource">sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  </div><div class="sasSource">sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  </div><div class="sasSource">sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  </div><div class="sasSource">sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]   ,  sum_qty[t-222]   ,  sum_qty[t-223]   ,  sum_qty[t-224]   ,  </div><div class="sasSource">sum_qty[t-225]   ,  sum_qty[t-226]   ,  sum_qty[t-227]   ,  sum_qty[t-228]   ,  sum_qty[t-229]   ,  sum_qty[t-230]   ,  </div><div class="sasSource">sum_qty[t-231]   ,  sum_qty[t-232]   ,  sum_qty[t-233]   ,  sum_qty[t-234]   ,  sum_qty[t-235]   ,  sum_qty[t-236]   ,  </div><div class="sasSource">sum_qty[t-237]   ,  sum_qty[t-238]   ,  sum_qty[t-239]   ,  sum_qty[t-240]   ,  sum_qty[t-241]   ,  sum_qty[t-242]   ,  </div><div class="sasSource">sum_qty[t-243]   ,  sum_qty[t-244]   ,  sum_qty[t-245]   ,  sum_qty[t-246]   ,  sum_qty[t-247]   ,  sum_qty[t-248]   ,  </div><div class="sasSource">sum_qty[t-249]   ,  sum_qty[t-250]   ,  sum_qty[t-251]   ,  sum_qty[t-252]   ,  sum_qty[t-253]   ,  sum_qty[t-254]   ,  </div><div class="sasSource">sum_qty[t-255]   ,  sum_qty[t-256]   ,  sum_qty[t-257]   ,  sum_qty[t-258]   ,  sum_qty[t-259]   ,  sum_qty[t-260]   ,  </div><div class="sasSource">sum_qty[t-261]   ,  sum_qty[t-262]   ,  sum_qty[t-263]   ,  sum_qty[t-264]   ,  sum_qty[t-265]   ,  sum_qty[t-266]   ,  </div><div class="sasSource">sum_qty[t-267]   ,  sum_qty[t-268]   ,  sum_qty[t-269]   ,  sum_qty[t-270]   ,  sum_qty[t-271]   ,  sum_qty[t-272]   ,  </div><div class="sasSource">sum_qty[t-273]   ,  sum_qty[t-274]   ,  sum_qty[t-275]   ,  sum_qty[t-276]   ,  sum_qty[t-277]   ,  sum_qty[t-278]   ,  </div><div class="sasSource">sum_qty[t-279]   ,  sum_qty[t-280]   ,  sum_qty[t-281]   ,  sum_qty[t-282]   ,  sum_qty[t-283]   ,  sum_qty[t-284]   ,  </div><div class="sasSource">sum_qty[t-285]   ,  sum_qty[t-286]   ,  sum_qty[t-287]   ,  sum_qty[t-288]   ,  sum_qty[t-289]   ,  sum_qty[t-290]   ,  </div><div class="sasSource">sum_qty[t-291]   ,  sum_qty[t-292]   ,  sum_qty[t-293]   ,  sum_qty[t-294]   ,  sum_qty[t-295]   ,  sum_qty[t-296]   ,  </div><div class="sasSource">sum_qty[t-297]   ,  sum_qty[t-298]   ,  sum_qty[t-299]   ,  sum_qty[t-300]   ,  sum_qty[t-301]   ,  sum_qty[t-302]   ,  </div><div class="sasSource">sum_qty[t-303]   ,  sum_qty[t-304]   ,  sum_qty[t-305]   ,  sum_qty[t-306]   ,  sum_qty[t-307]   ,  sum_qty[t-308]   ,  </div><div class="sasSource">sum_qty[t-309]   ,  sum_qty[t-310]   ,  sum_qty[t-311]   ,  sum_qty[t-312]   ,  sum_qty[t-313]   ,  sum_qty[t-314]   ,  </div><div class="sasSource">sum_qty[t-315]   ,  sum_qty[t-316]   ,  sum_qty[t-317]   ,  sum_qty[t-318]   ,  sum_qty[t-319]   ,  sum_qty[t-320]   ,  </div><div class="sasSource">sum_qty[t-321]   ,  sum_qty[t-322]   ,  sum_qty[t-323]   ,  sum_qty[t-324]   ,  sum_qty[t-325]   ,  sum_qty[t-326]   ,  </div><div class="sasSource">sum_qty[t-327]   ,  sum_qty[t-328]   ,  sum_qty[t-329]   ,  sum_qty[t-330]   ,  sum_qty[t-331]   ,  sum_qty[t-332]   ,  </div><div class="sasSource">sum_qty[t-333]   ,  sum_qty[t-334]   ,  sum_qty[t-335]   ,  sum_qty[t-336]   ,  sum_qty[t-337]   ,  sum_qty[t-338]   ,  </div><div class="sasSource">sum_qty[t-339]   ,  sum_qty[t-340]   ,  sum_qty[t-341]   ,  sum_qty[t-342]   ,  sum_qty[t-343]   ,  sum_qty[t-344]   ,  </div><div class="sasSource">sum_qty[t-345]   ,  sum_qty[t-346]   ,  sum_qty[t-347]   ,  sum_qty[t-348]   ,  sum_qty[t-349]   ,  sum_qty[t-350]   ,  </div><div class="sasSource">sum_qty[t-351]   ,  sum_qty[t-352]   ,  sum_qty[t-353]   ,  sum_qty[t-354]   ,  sum_qty[t-355]   ,  sum_qty[t-356]   ,  </div><div class="sasSource">sum_qty[t-357]   ,  sum_qty[t-358]   ,  sum_qty[t-359]   ,  sum_qty[t-360]   ,  sum_qty[t-361]   ,  sum_qty[t-362]   ,  </div><div class="sasSource">sum_qty[t-363]   ,  sum_qty[t-364]   ,  sum_qty[t-365]   ,  sum_qty[t-366]   ,  sum_qty[t-367]   ,  sum_qty[t-368]   ,  </div><div class="sasSource">sum_qty[t-369]   ,  sum_qty[t-370]   ,  sum_qty[t-371]   ,  sum_qty[t-372]   ,  sum_qty[t-373]   ,  sum_qty[t-374]   ,  </div><div class="sasSource">sum_qty[t-375]   ,  sum_qty[t-376]   ,  sum_qty[t-377]   ,  sum_qty[t-378]   ,  sum_qty[t-379]   ,  sum_qty[t-380]   ,  </div><div class="sasSource">sum_qty[t-381]   ,  sum_qty[t-382]   ,  sum_qty[t-383]   ,  sum_qty[t-384]   ,  sum_qty[t-385]   ,  sum_qty[t-386]   ,  </div><div class="sasSource">sum_qty[t-387]   ,  sum_qty[t-388]   ,  sum_qty[t-389]   ,  sum_qty[t-390]   ,  sum_qty[t-391]   ,  sum_qty[t-392]   ,  </div><div class="sasSource">sum_qty[t-393]   ,  sum_qty[t-394]   ,  sum_qty[t-395]   ,  sum_qty[t-396]   ,  sum_qty[t-397]   ,  sum_qty[t-398]   ,  </div><div class="sasSource">sum_qty[t-399]   ,  sum_qty[t-400]   ,  sum_qty[t-401]   ,  sum_qty[t-402]   ,  sum_qty[t-403]   ,  sum_qty[t-404]   ,  </div><div class="sasSource">sum_qty[t-405]   ,  sum_qty[t-406]);       lag_year_med[t]=median(sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  </div><div class="sasSource">sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   , </div><div class="sasSource"> sum_qty[t-52]   ,  sum_qty[t-53]   ,  sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   </div><div class="sasSource">,  sum_qty[t-59]   ,  sum_qty[t-60]   ,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]  </div><div class="sasSource"> ,  sum_qty[t-66]   ,  sum_qty[t-67]   ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]   ,  sum_qty[t-72] </div><div class="sasSource">  ,  sum_qty[t-73]   ,  sum_qty[t-74]   ,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  sum_qty[t-78]   ,  </div><div class="sasSource">sum_qty[t-79]   ,  sum_qty[t-80]   ,  sum_qty[t-81]   ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   ,  sum_qty[t-85]   , </div><div class="sasSource"> sum_qty[t-86]   ,  sum_qty[t-87]   ,  sum_qty[t-88]   ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   ,  sum_qty[t-92]   </div><div class="sasSource">,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]  </div><div class="sasSource"> ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  </div><div class="sasSource">sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  </div><div class="sasSource">sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  </div><div class="sasSource">sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  </div><div class="sasSource">sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  </div><div class="sasSource">sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  </div><div class="sasSource">sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  </div><div class="sasSource">sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  </div><div class="sasSource">sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  </div><div class="sasSource">sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  </div><div class="sasSource">sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  </div><div class="sasSource">sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  </div><div class="sasSource">sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  </div><div class="sasSource">sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  </div><div class="sasSource">sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  </div><div class="sasSource">sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  </div><div class="sasSource">sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  </div><div class="sasSource">sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  </div><div class="sasSource">sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  </div><div class="sasSource">sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  </div><div class="sasSource">sum_qty[t-220]   ,  sum_qty[t-221]   ,  sum_qty[t-222]   ,  sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  </div><div class="sasSource">sum_qty[t-226]   ,  sum_qty[t-227]   ,  sum_qty[t-228]   ,  sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  </div><div class="sasSource">sum_qty[t-232]   ,  sum_qty[t-233]   ,  sum_qty[t-234]   ,  sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  </div><div class="sasSource">sum_qty[t-238]   ,  sum_qty[t-239]   ,  sum_qty[t-240]   ,  sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  </div><div class="sasSource">sum_qty[t-244]   ,  sum_qty[t-245]   ,  sum_qty[t-246]   ,  sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  </div><div class="sasSource">sum_qty[t-250]   ,  sum_qty[t-251]   ,  sum_qty[t-252]   ,  sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  </div><div class="sasSource">sum_qty[t-256]   ,  sum_qty[t-257]   ,  sum_qty[t-258]   ,  sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  </div><div class="sasSource">sum_qty[t-262]   ,  sum_qty[t-263]   ,  sum_qty[t-264]   ,  sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  </div><div class="sasSource">sum_qty[t-268]   ,  sum_qty[t-269]   ,  sum_qty[t-270]   ,  sum_qty[t-271]   ,  sum_qty[t-272]   ,  sum_qty[t-273]   ,  </div><div class="sasSource">sum_qty[t-274]   ,  sum_qty[t-275]   ,  sum_qty[t-276]   ,  sum_qty[t-277]   ,  sum_qty[t-278]   ,  sum_qty[t-279]   ,  </div><div class="sasSource">sum_qty[t-280]   ,  sum_qty[t-281]   ,  sum_qty[t-282]   ,  sum_qty[t-283]   ,  sum_qty[t-284]   ,  sum_qty[t-285]   ,  </div><div class="sasSource">sum_qty[t-286]   ,  sum_qty[t-287]   ,  sum_qty[t-288]   ,  sum_qty[t-289]   ,  sum_qty[t-290]   ,  sum_qty[t-291]   ,  </div><div class="sasSource">sum_qty[t-292]   ,  sum_qty[t-293]   ,  sum_qty[t-294]   ,  sum_qty[t-295]   ,  sum_qty[t-296]   ,  sum_qty[t-297]   ,  </div><div class="sasSource">sum_qty[t-298]   ,  sum_qty[t-299]   ,  sum_qty[t-300]   ,  sum_qty[t-301]   ,  sum_qty[t-302]   ,  sum_qty[t-303]   ,  </div><div class="sasSource">sum_qty[t-304]   ,  sum_qty[t-305]   ,  sum_qty[t-306]   ,  sum_qty[t-307]   ,  sum_qty[t-308]   ,  sum_qty[t-309]   ,  </div><div class="sasSource">sum_qty[t-310]   ,  sum_qty[t-311]   ,  sum_qty[t-312]   ,  sum_qty[t-313]   ,  sum_qty[t-314]   ,  sum_qty[t-315]   ,  </div><div class="sasSource">sum_qty[t-316]   ,  sum_qty[t-317]   ,  sum_qty[t-318]   ,  sum_qty[t-319]   ,  sum_qty[t-320]   ,  sum_qty[t-321]   ,  </div><div class="sasSource">sum_qty[t-322]   ,  sum_qty[t-323]   ,  sum_qty[t-324]   ,  sum_qty[t-325]   ,  sum_qty[t-326]   ,  sum_qty[t-327]   ,  </div><div class="sasSource">sum_qty[t-328]   ,  sum_qty[t-329]   ,  sum_qty[t-330]   ,  sum_qty[t-331]   ,  sum_qty[t-332]   ,  sum_qty[t-333]   ,  </div><div class="sasSource">sum_qty[t-334]   ,  sum_qty[t-335]   ,  sum_qty[t-336]   ,  sum_qty[t-337]   ,  sum_qty[t-338]   ,  sum_qty[t-339]   ,  </div><div class="sasSource">sum_qty[t-340]   ,  sum_qty[t-341]   ,  sum_qty[t-342]   ,  sum_qty[t-343]   ,  sum_qty[t-344]   ,  sum_qty[t-345]   ,  </div><div class="sasSource">sum_qty[t-346]   ,  sum_qty[t-347]   ,  sum_qty[t-348]   ,  sum_qty[t-349]   ,  sum_qty[t-350]   ,  sum_qty[t-351]   ,  </div><div class="sasSource">sum_qty[t-352]   ,  sum_qty[t-353]   ,  sum_qty[t-354]   ,  sum_qty[t-355]   ,  sum_qty[t-356]   ,  sum_qty[t-357]   ,  </div><div class="sasSource">sum_qty[t-358]   ,  sum_qty[t-359]   ,  sum_qty[t-360]   ,  sum_qty[t-361]   ,  sum_qty[t-362]   ,  sum_qty[t-363]   ,  </div><div class="sasSource">sum_qty[t-364]   ,  sum_qty[t-365]   ,  sum_qty[t-366]   ,  sum_qty[t-367]   ,  sum_qty[t-368]   ,  sum_qty[t-369]   ,  </div><div class="sasSource">sum_qty[t-370]   ,  sum_qty[t-371]   ,  sum_qty[t-372]   ,  sum_qty[t-373]   ,  sum_qty[t-374]   ,  sum_qty[t-375]   ,  </div><div class="sasSource">sum_qty[t-376]   ,  sum_qty[t-377]   ,  sum_qty[t-378]   ,  sum_qty[t-379]   ,  sum_qty[t-380]   ,  sum_qty[t-381]   ,  </div><div class="sasSource">sum_qty[t-382]   ,  sum_qty[t-383]   ,  sum_qty[t-384]   ,  sum_qty[t-385]   ,  sum_qty[t-386]   ,  sum_qty[t-387]   ,  </div><div class="sasSource">sum_qty[t-388]   ,  sum_qty[t-389]   ,  sum_qty[t-390]   ,  sum_qty[t-391]   ,  sum_qty[t-392]   ,  sum_qty[t-393]   ,  </div><div class="sasSource">sum_qty[t-394]   ,  sum_qty[t-395]   ,  sum_qty[t-396]   ,  sum_qty[t-397]   ,  sum_qty[t-398]   ,  sum_qty[t-399]   ,  </div><div class="sasSource">sum_qty[t-400]   ,  sum_qty[t-401]   ,  sum_qty[t-402]   ,  sum_qty[t-403]   ,  sum_qty[t-404]   ,  sum_qty[t-405]   ,  </div><div class="sasSource">sum_qty[t-406]);     end;      " , arrayOut={ table={name='lag_abt1', replace=true, caslib='Public'}, </div><div class="sasSource">arrays={{name='lag_year_med'}, {name='lag_year_avg'}, {name='lag_halfyear_med'}, {name='lag_halfyear_avg'}, {name='lag_qtr_med'}, </div><div class="sasSource">{name='lag_qtr_avg'}, {name='lag_month_med'}, {name='lag_month_avg'}, {name='lag_week_med'}, {name='lag_week_avg'}} } ;</div><div class="sasSource">MPRINT(CMPCODE):   run;</div><div class="sasNote" id="sasLogNote299_1620885733386">NOTE: Active Session now CASAUTO.</div><div class="sasError" id="sasLogError5_1620885733386">ERROR: The file or path 'abt4_ml' is not available in the file system.</div><div class="sasError" id="sasLogError6_1620885733386">ERROR: Table 'abt4_ml' could not be loaded.</div><div class="sasError" id="sasLogError7_1620885733386">ERROR: Failure opening table 'abt4_ml': A table could not be loaded.</div><div class="sasError" id="sasLogError8_1620885733386">ERROR: The action stopped due to errors.</div><div class="sasSource">MPRINT(CMPCODE):   quit;</div><div class="sasNote" id="sasLogNote300_1620885733386">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           1.49 seconds</div><div class="sasNote">      user cpu time       1.46 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10667.46k</div><div class="sasNote">      OS Memory           45956.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:20 AM</div><div class="sasNote">      Step Count                        82  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1208</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        16</div><div class="sasNote">      Involuntary Context Switches      16</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           143960</div><div class="sasNote">      </div><div class="sasSource">1295  /* Считаем стандартное отклонение */</div><div class="sasSource">1296  %macro cmpcode2;</div><div class="sasSource">1297  proc cas;</div><div class="sasSource">1298  timeData.runTimeCode result=r /</div><div class="sasSource">1299  table = {</div><div class="sasSource">1300  name ='abt4_ml',</div><div class="sasSource">1301  caslib = 'public',</div><div class="sasSource">1302          groupBy = {</div><div class="sasSource">1303  {name = 'PRODUCT_ID'},</div><div class="sasSource">1304  {name = 'PBO_LOCATION_ID'},</div><div class="sasSource">1305  {name = 'CHANNEL_CD'}</div><div class="sasSource">1306  }</div><div class="sasSource">1307  },</div><div class="sasSource">1308   series = {{name='sum_qty'}},</div><div class="sasSource">1309   interval='DAY',</div><div class="sasSource">1310  timeId = {name='SALES_DT'},</div><div class="sasSource">1311  trimId = "LEFT",</div><div class="sasSource">1312  code=</div><div class="sasSource">1313  %unquote(%str(%"))</div><div class="sasSource">1314  %let names=; /*будущий список выходных переменных для proc cas */</div><div class="sasSource">1315  %let minlag=42; /*параметр MinLag*/</div><div class="sasSource">1316  /*-=-=-=-=-= min_lag + окна -=-=-=-=-=-*/</div><div class="sasSource">1317  %let window_list = 7 30 90 180 365;</div><div class="sasSource">1318  %let lag=&amp;minlag;</div><div class="sasSource">1319  %let n_win_list=%sysfunc(countw(&amp;window_list.));</div><div class="sasSource">1320  %do ic=1 %to &amp;n_win_list.;</div><div class="sasSource">1321    %let window=%scan(&amp;window_list,&amp;ic); /*текущее окно*/</div><div class="sasSource">1322    %let intnm=%namet(&amp;window);        /*название интервала окна; 7-&gt;week итд */</div><div class="sasSource">1323    %let intnm=%sysfunc(strip(&amp;intnm.));</div><div class="sasSource">1324    do t = %eval(&amp;lag+&amp;window) to _length_; /*from=(lag)+(window)*/</div><div class="sasSource">1325      lag_&amp;intnm._std[t]=std(%argt(sum_qty,t,%eval(&amp;lag),%eval(&amp;lag+&amp;window-1)));</div><div class="sasSource">1326    end;</div><div class="sasSource">1327   %let names={name=%tslit(lag_&amp;intnm._std)}, &amp;names;</div><div class="sasSource">1328  %end; /* ic over window_list*/</div><div class="sasSource">1329  /*remove last comma from names*/</div><div class="sasSource">1330  %let len=%length(&amp;names);</div><div class="sasSource">1331  %let names=%substr(%quote(&amp;names),1,%eval(&amp;len-1));</div><div class="sasSource">1332  /*-=-=-завершающий код proc cas=-=-=*/</div><div class="sasSource">1333  %unquote(%str(%"))</div><div class="sasSource">1334  ,</div><div class="sasSource">1335  arrayOut={</div><div class="sasSource">1336  table={name='lag_abt2', replace=true, caslib='Public'},</div><div class="sasSource">1337      arrays={&amp;names}</div><div class="sasSource">1338  }</div><div class="sasSource">1339  ;</div><div class="sasSource">1340  run;</div><div class="sasSource">1341  quit;</div><div class="sasSource">1342  %mend cmpcode2;</div><div class="sasNote" id="sasLogNote301_1620885733386">NOTE: The macro CMPCODE2 completed compilation without errors.</div><div class="sasNote">      62 instructions 1920 bytes.</div><div class="sasSource">1343  %cmpcode2</div><div class="sasSource">MPRINT(CMPCODE2):   proc cas;</div><div class="sasSource">MPRINT(CMPCODE2):   timeData.runTimeCode result=r / table = { name ='abt4_ml', caslib = 'public', groupBy = { {name = </div><div class="sasSource">'PRODUCT_ID'}, {name = 'PBO_LOCATION_ID'}, {name = 'CHANNEL_CD'} } }, series = {{name='sum_qty'}}, interval='DAY', timeId = </div><div class="sasSource">{name='SALES_DT'}, trimId = "LEFT", code=</div><div class="sasNote" id="sasLogNote302_1620885733386">NOTE: The quoted string currently being processed has become more than 262 bytes long.  You might have unbalanced quotation marks.</div><div class="sasSource">MPRINT(CMPCODE2):   "     do t = 49 to _length_;        lag_week_std[t]=std(sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   , </div><div class="sasSource"> sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]);     end;     do t = 72 to _length_;        </div><div class="sasSource">lag_month_std[t]=std(sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   </div><div class="sasSource">,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   ,  sum_qty[t-54]  </div><div class="sasSource"> ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   ,  sum_qty[t-61] </div><div class="sasSource">  ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]   ,  </div><div class="sasSource">sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]);     end;     do t = 132 to _length_;        </div><div class="sasSource">lag_qtr_std[t]=std(sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   , </div><div class="sasSource"> sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   ,  sum_qty[t-54]   </div><div class="sasSource">,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   ,  sum_qty[t-61]  </div><div class="sasSource"> ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]   ,  sum_qty[t-68] </div><div class="sasSource">  ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]   ,  sum_qty[t-72]   ,  sum_qty[t-73]   ,  sum_qty[t-74]   ,  </div><div class="sasSource">sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  sum_qty[t-78]   ,  sum_qty[t-79]   ,  sum_qty[t-80]   ,  sum_qty[t-81]   , </div><div class="sasSource"> sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   ,  sum_qty[t-85]   ,  sum_qty[t-86]   ,  sum_qty[t-87]   ,  sum_qty[t-88]   </div><div class="sasSource">,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]  </div><div class="sasSource"> ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  </div><div class="sasSource">sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  </div><div class="sasSource">sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  </div><div class="sasSource">sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  </div><div class="sasSource">sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  </div><div class="sasSource">sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]);     end;     </div><div class="sasSource">do t = 222 to _length_;        lag_halfyear_std[t]=std(sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  </div><div class="sasSource">sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   , </div><div class="sasSource"> sum_qty[t-53]   ,  sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   </div><div class="sasSource">,  sum_qty[t-60]   ,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]  </div><div class="sasSource"> ,  sum_qty[t-67]   ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]   ,  sum_qty[t-72]   ,  sum_qty[t-73] </div><div class="sasSource">  ,  sum_qty[t-74]   ,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  sum_qty[t-78]   ,  sum_qty[t-79]   ,  </div><div class="sasSource">sum_qty[t-80]   ,  sum_qty[t-81]   ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   ,  sum_qty[t-85]   ,  sum_qty[t-86]   , </div><div class="sasSource"> sum_qty[t-87]   ,  sum_qty[t-88]   ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   </div><div class="sasSource">,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100] </div><div class="sasSource">  ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  </div><div class="sasSource">sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  </div><div class="sasSource">sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  </div><div class="sasSource">sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  </div><div class="sasSource">sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  </div><div class="sasSource">sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  </div><div class="sasSource">sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  </div><div class="sasSource">sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  </div><div class="sasSource">sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  </div><div class="sasSource">sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  </div><div class="sasSource">sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  </div><div class="sasSource">sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  </div><div class="sasSource">sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  </div><div class="sasSource">sum_qty[t-179]   ,  sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  </div><div class="sasSource">sum_qty[t-185]   ,  sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  </div><div class="sasSource">sum_qty[t-191]   ,  sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  </div><div class="sasSource">sum_qty[t-197]   ,  sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  </div><div class="sasSource">sum_qty[t-203]   ,  sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  </div><div class="sasSource">sum_qty[t-209]   ,  sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  </div><div class="sasSource">sum_qty[t-215]   ,  sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  </div><div class="sasSource">sum_qty[t-221]);     end;     do t = 407 to _length_;        lag_year_std[t]=std(sum_qty[t-42]   ,  sum_qty[t-43]   ,  </div><div class="sasSource">sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   , </div><div class="sasSource"> sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   ,  sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   </div><div class="sasSource">,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   ,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]  </div><div class="sasSource"> ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]   ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71] </div><div class="sasSource">  ,  sum_qty[t-72]   ,  sum_qty[t-73]   ,  sum_qty[t-74]   ,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  </div><div class="sasSource">sum_qty[t-78]   ,  sum_qty[t-79]   ,  sum_qty[t-80]   ,  sum_qty[t-81]   ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   , </div><div class="sasSource"> sum_qty[t-85]   ,  sum_qty[t-86]   ,  sum_qty[t-87]   ,  sum_qty[t-88]   ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   </div><div class="sasSource">,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]  </div><div class="sasSource"> ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  </div><div class="sasSource">sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  </div><div class="sasSource">sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  </div><div class="sasSource">sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  </div><div class="sasSource">sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  </div><div class="sasSource">sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  </div><div class="sasSource">sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  </div><div class="sasSource">sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  </div><div class="sasSource">sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  </div><div class="sasSource">sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  </div><div class="sasSource">sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  </div><div class="sasSource">sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  </div><div class="sasSource">sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  </div><div class="sasSource">sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  </div><div class="sasSource">sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  </div><div class="sasSource">sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  </div><div class="sasSource">sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  </div><div class="sasSource">sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  </div><div class="sasSource">sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  </div><div class="sasSource">sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  </div><div class="sasSource">sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]   ,  sum_qty[t-222]   ,  sum_qty[t-223]   ,  sum_qty[t-224]   ,  </div><div class="sasSource">sum_qty[t-225]   ,  sum_qty[t-226]   ,  sum_qty[t-227]   ,  sum_qty[t-228]   ,  sum_qty[t-229]   ,  sum_qty[t-230]   ,  </div><div class="sasSource">sum_qty[t-231]   ,  sum_qty[t-232]   ,  sum_qty[t-233]   ,  sum_qty[t-234]   ,  sum_qty[t-235]   ,  sum_qty[t-236]   ,  </div><div class="sasSource">sum_qty[t-237]   ,  sum_qty[t-238]   ,  sum_qty[t-239]   ,  sum_qty[t-240]   ,  sum_qty[t-241]   ,  sum_qty[t-242]   ,  </div><div class="sasSource">sum_qty[t-243]   ,  sum_qty[t-244]   ,  sum_qty[t-245]   ,  sum_qty[t-246]   ,  sum_qty[t-247]   ,  sum_qty[t-248]   ,  </div><div class="sasSource">sum_qty[t-249]   ,  sum_qty[t-250]   ,  sum_qty[t-251]   ,  sum_qty[t-252]   ,  sum_qty[t-253]   ,  sum_qty[t-254]   ,  </div><div class="sasSource">sum_qty[t-255]   ,  sum_qty[t-256]   ,  sum_qty[t-257]   ,  sum_qty[t-258]   ,  sum_qty[t-259]   ,  sum_qty[t-260]   ,  </div><div class="sasSource">sum_qty[t-261]   ,  sum_qty[t-262]   ,  sum_qty[t-263]   ,  sum_qty[t-264]   ,  sum_qty[t-265]   ,  sum_qty[t-266]   ,  </div><div class="sasSource">sum_qty[t-267]   ,  sum_qty[t-268]   ,  sum_qty[t-269]   ,  sum_qty[t-270]   ,  sum_qty[t-271]   ,  sum_qty[t-272]   ,  </div><div class="sasSource">sum_qty[t-273]   ,  sum_qty[t-274]   ,  sum_qty[t-275]   ,  sum_qty[t-276]   ,  sum_qty[t-277]   ,  sum_qty[t-278]   ,  </div><div class="sasSource">sum_qty[t-279]   ,  sum_qty[t-280]   ,  sum_qty[t-281]   ,  sum_qty[t-282]   ,  sum_qty[t-283]   ,  sum_qty[t-284]   ,  </div><div class="sasSource">sum_qty[t-285]   ,  sum_qty[t-286]   ,  sum_qty[t-287]   ,  sum_qty[t-288]   ,  sum_qty[t-289]   ,  sum_qty[t-290]   ,  </div><div class="sasSource">sum_qty[t-291]   ,  sum_qty[t-292]   ,  sum_qty[t-293]   ,  sum_qty[t-294]   ,  sum_qty[t-295]   ,  sum_qty[t-296]   ,  </div><div class="sasSource">sum_qty[t-297]   ,  sum_qty[t-298]   ,  sum_qty[t-299]   ,  sum_qty[t-300]   ,  sum_qty[t-301]   ,  sum_qty[t-302]   ,  </div><div class="sasSource">sum_qty[t-303]   ,  sum_qty[t-304]   ,  sum_qty[t-305]   ,  sum_qty[t-306]   ,  sum_qty[t-307]   ,  sum_qty[t-308]   ,  </div><div class="sasSource">sum_qty[t-309]   ,  sum_qty[t-310]   ,  sum_qty[t-311]   ,  sum_qty[t-312]   ,  sum_qty[t-313]   ,  sum_qty[t-314]   ,  </div><div class="sasSource">sum_qty[t-315]   ,  sum_qty[t-316]   ,  sum_qty[t-317]   ,  sum_qty[t-318]   ,  sum_qty[t-319]   ,  sum_qty[t-320]   ,  </div><div class="sasSource">sum_qty[t-321]   ,  sum_qty[t-322]   ,  sum_qty[t-323]   ,  sum_qty[t-324]   ,  sum_qty[t-325]   ,  sum_qty[t-326]   ,  </div><div class="sasSource">sum_qty[t-327]   ,  sum_qty[t-328]   ,  sum_qty[t-329]   ,  sum_qty[t-330]   ,  sum_qty[t-331]   ,  sum_qty[t-332]   ,  </div><div class="sasSource">sum_qty[t-333]   ,  sum_qty[t-334]   ,  sum_qty[t-335]   ,  sum_qty[t-336]   ,  sum_qty[t-337]   ,  sum_qty[t-338]   ,  </div><div class="sasSource">sum_qty[t-339]   ,  sum_qty[t-340]   ,  sum_qty[t-341]   ,  sum_qty[t-342]   ,  sum_qty[t-343]   ,  sum_qty[t-344]   ,  </div><div class="sasSource">sum_qty[t-345]   ,  sum_qty[t-346]   ,  sum_qty[t-347]   ,  sum_qty[t-348]   ,  sum_qty[t-349]   ,  sum_qty[t-350]   ,  </div><div class="sasSource">sum_qty[t-351]   ,  sum_qty[t-352]   ,  sum_qty[t-353]   ,  sum_qty[t-354]   ,  sum_qty[t-355]   ,  sum_qty[t-356]   ,  </div><div class="sasSource">sum_qty[t-357]   ,  sum_qty[t-358]   ,  sum_qty[t-359]   ,  sum_qty[t-360]   ,  sum_qty[t-361]   ,  sum_qty[t-362]   ,  </div><div class="sasSource">sum_qty[t-363]   ,  sum_qty[t-364]   ,  sum_qty[t-365]   ,  sum_qty[t-366]   ,  sum_qty[t-367]   ,  sum_qty[t-368]   ,  </div><div class="sasSource">sum_qty[t-369]   ,  sum_qty[t-370]   ,  sum_qty[t-371]   ,  sum_qty[t-372]   ,  sum_qty[t-373]   ,  sum_qty[t-374]   ,  </div><div class="sasSource">sum_qty[t-375]   ,  sum_qty[t-376]   ,  sum_qty[t-377]   ,  sum_qty[t-378]   ,  sum_qty[t-379]   ,  sum_qty[t-380]   ,  </div><div class="sasSource">sum_qty[t-381]   ,  sum_qty[t-382]   ,  sum_qty[t-383]   ,  sum_qty[t-384]   ,  sum_qty[t-385]   ,  sum_qty[t-386]   ,  </div><div class="sasSource">sum_qty[t-387]   ,  sum_qty[t-388]   ,  sum_qty[t-389]   ,  sum_qty[t-390]   ,  sum_qty[t-391]   ,  sum_qty[t-392]   ,  </div><div class="sasSource">sum_qty[t-393]   ,  sum_qty[t-394]   ,  sum_qty[t-395]   ,  sum_qty[t-396]   ,  sum_qty[t-397]   ,  sum_qty[t-398]   ,  </div><div class="sasSource">sum_qty[t-399]   ,  sum_qty[t-400]   ,  sum_qty[t-401]   ,  sum_qty[t-402]   ,  sum_qty[t-403]   ,  sum_qty[t-404]   ,  </div><div class="sasSource">sum_qty[t-405]   ,  sum_qty[t-406]);     end;      " , arrayOut={ table={name='lag_abt2', replace=true, caslib='Public'}, </div><div class="sasSource">arrays={{name='lag_year_std'}, {name='lag_halfyear_std'}, {name='lag_qtr_std'}, {name='lag_month_std'}, {name='lag_week_std'}} } ;</div><div class="sasSource">MPRINT(CMPCODE2):   run;</div><div class="sasNote" id="sasLogNote303_1620885733386">NOTE: Active Session now CASAUTO.</div><div class="sasError" id="sasLogError9_1620885733386">ERROR: The file or path 'abt4_ml' is not available in the file system.</div><div class="sasError" id="sasLogError10_1620885733386">ERROR: Table 'abt4_ml' could not be loaded.</div><div class="sasError" id="sasLogError11_1620885733386">ERROR: Failure opening table 'abt4_ml': A table could not be loaded.</div><div class="sasError" id="sasLogError12_1620885733386">ERROR: The action stopped due to errors.</div><div class="sasSource">MPRINT(CMPCODE2):   quit;</div><div class="sasNote" id="sasLogNote304_1620885733386">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.43 seconds</div><div class="sasNote">      user cpu time       0.38 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10080.40k</div><div class="sasNote">      OS Memory           45440.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:21 AM</div><div class="sasNote">      Step Count                        83  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1005</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        12</div><div class="sasNote">      Involuntary Context Switches      2</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           36656</div><div class="sasNote">      </div><div class="sasSource">1344  /* Считаем процентили */</div><div class="sasSource">1345  %macro cmpcode3;</div><div class="sasSource">1346  proc cas;</div><div class="sasSource">1347  timeData.runTimeCode result=r /</div><div class="sasSource">1348  table = {</div><div class="sasSource">1349  name ='abt4_ml',</div><div class="sasSource">1350  caslib = 'public',</div><div class="sasSource">1351          groupBy = {</div><div class="sasSource">1352  {name = 'PRODUCT_ID'},</div><div class="sasSource">1353  {name = 'PBO_LOCATION_ID'},</div><div class="sasSource">1354  {name = 'CHANNEL_CD'}</div><div class="sasSource">1355  }</div><div class="sasSource">1356  },</div><div class="sasSource">1357   series = {{name='sum_qty'}},</div><div class="sasSource">1358   interval='DAY',</div><div class="sasSource">1359  timeId = {name='SALES_DT'},</div><div class="sasSource">1360  trimId = "LEFT",</div><div class="sasSource">1361  code=</div><div class="sasSource">1362  %unquote(%str(%"))</div><div class="sasSource">1363  %let names=; /*будущий список выходных переменных для proc cas */</div><div class="sasSource">1364  %let minlag=42; /*параметр MinLag*/</div><div class="sasSource">1365  /*-=-=-=-=-= min_lag + окна -=-=-=-=-=-*/</div><div class="sasSource">1366  %let window_list = 7 30 90 180 365;</div><div class="sasSource">1367  %let lag=&amp;minlag;</div><div class="sasSource">1368  %let n_win_list=%sysfunc(countw(&amp;window_list.));</div><div class="sasSource">1369  %do ic=1 %to &amp;n_win_list.;</div><div class="sasSource">1370    %let window=%scan(&amp;window_list,&amp;ic); /*текущее окно*/</div><div class="sasSource">1371    %let intnm=%namet(&amp;window);        /*название интервала окна; 7-&gt;week итд */</div><div class="sasSource">1372    %let intnm=%sysfunc(strip(&amp;intnm.));</div><div class="sasSource">1373    do t = %eval(&amp;lag+&amp;window) to _length_; /*from=(lag)+(window)*/</div><div class="sasSource">1374  lag_&amp;intnm._pct10[t]=pctl(10,%argt(sum_qty,t,%eval(&amp;lag),%eval(&amp;lag+&amp;window-1))) ;</div><div class="sasSource">1375     lag_&amp;intnm._pct90[t]=pctl(90,%argt(sum_qty,t,%eval(&amp;lag),%eval(&amp;lag+&amp;window-1))) ;</div><div class="sasSource">1376    end;</div><div class="sasSource">1377   %let names={name=%tslit(lag_&amp;intnm._pct10)}, &amp;names;</div><div class="sasSource">1378   %let names={name=%tslit(lag_&amp;intnm._pct90)}, &amp;names;</div><div class="sasSource">1379  %end; /* ic over window_list*/</div><div class="sasSource">1380  /*remove last comma from names*/</div><div class="sasSource">1381  %let len=%length(&amp;names);</div><div class="sasSource">1382  %let names=%substr(%quote(&amp;names),1,%eval(&amp;len-1));</div><div class="sasSource">1383  /*-=-=-завершающий код proc cas=-=-=*/</div><div class="sasSource">1384  %unquote(%str(%"))</div><div class="sasSource">1385  ,</div><div class="sasSource">1386  arrayOut={</div><div class="sasSource">1387  table={name='lag_abt3', replace=true, caslib='Public'},</div><div class="sasSource">1388      arrays={&amp;names}</div><div class="sasSource">1389  }</div><div class="sasSource">1390  ;</div><div class="sasSource">1391  run;</div><div class="sasSource">1392  quit;</div><div class="sasSource">1393  %mend cmpcode3;</div><div class="sasNote" id="sasLogNote305_1620885733386">NOTE: The macro CMPCODE3 completed compilation without errors.</div><div class="sasNote">      66 instructions 2128 bytes.</div><div class="sasSource">1394  %cmpcode3</div><div class="sasSource">MPRINT(CMPCODE3):   proc cas;</div><div class="sasSource">MPRINT(CMPCODE3):   timeData.runTimeCode result=r / table = { name ='abt4_ml', caslib = 'public', groupBy = { {name = </div><div class="sasSource">'PRODUCT_ID'}, {name = 'PBO_LOCATION_ID'}, {name = 'CHANNEL_CD'} } }, series = {{name='sum_qty'}}, interval='DAY', timeId = </div><div class="sasSource">{name='SALES_DT'}, trimId = "LEFT", code=</div><div class="sasNote" id="sasLogNote306_1620885733386">NOTE: The quoted string currently being processed has become more than 262 bytes long.  You might have unbalanced quotation marks.</div><div class="sasSource">MPRINT(CMPCODE3):   "     do t = 49 to _length_;     lag_week_pct10[t]=pctl(10,sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]  </div><div class="sasSource"> ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]) ;       lag_week_pct90[t]=pctl(90,sum_qty[t-42]   ,  </div><div class="sasSource">sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]) ;     end;     do t = </div><div class="sasSource">72 to _length_;     lag_month_pct10[t]=pctl(10,sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  </div><div class="sasSource">sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   , </div><div class="sasSource"> sum_qty[t-53]   ,  sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   </div><div class="sasSource">,  sum_qty[t-60]   ,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]  </div><div class="sasSource"> ,  sum_qty[t-67]   ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]) ;       </div><div class="sasSource">lag_month_pct90[t]=pctl(90,sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  </div><div class="sasSource">sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   , </div><div class="sasSource"> sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   </div><div class="sasSource">,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]  </div><div class="sasSource"> ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]) ;     end;     do t = 132 to _length_;     </div><div class="sasSource">lag_qtr_pct10[t]=pctl(10,sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  </div><div class="sasSource">sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   , </div><div class="sasSource"> sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   </div><div class="sasSource">,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]  </div><div class="sasSource"> ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]   ,  sum_qty[t-72]   ,  sum_qty[t-73]   ,  sum_qty[t-74] </div><div class="sasSource">  ,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  sum_qty[t-78]   ,  sum_qty[t-79]   ,  sum_qty[t-80]   ,  </div><div class="sasSource">sum_qty[t-81]   ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   ,  sum_qty[t-85]   ,  sum_qty[t-86]   ,  sum_qty[t-87]   , </div><div class="sasSource"> sum_qty[t-88]   ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   </div><div class="sasSource">,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  </div><div class="sasSource">sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  </div><div class="sasSource">sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  </div><div class="sasSource">sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  </div><div class="sasSource">sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  </div><div class="sasSource">sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  </div><div class="sasSource">sum_qty[t-131]) ;       lag_qtr_pct90[t]=pctl(90,sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  </div><div class="sasSource">sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   , </div><div class="sasSource"> sum_qty[t-53]   ,  sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   </div><div class="sasSource">,  sum_qty[t-60]   ,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]  </div><div class="sasSource"> ,  sum_qty[t-67]   ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]   ,  sum_qty[t-72]   ,  sum_qty[t-73] </div><div class="sasSource">  ,  sum_qty[t-74]   ,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  sum_qty[t-78]   ,  sum_qty[t-79]   ,  </div><div class="sasSource">sum_qty[t-80]   ,  sum_qty[t-81]   ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   ,  sum_qty[t-85]   ,  sum_qty[t-86]   , </div><div class="sasSource"> sum_qty[t-87]   ,  sum_qty[t-88]   ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   </div><div class="sasSource">,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100] </div><div class="sasSource">  ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  </div><div class="sasSource">sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  </div><div class="sasSource">sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  </div><div class="sasSource">sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  </div><div class="sasSource">sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  </div><div class="sasSource">sum_qty[t-131]) ;     end;     do t = 222 to _length_;     lag_halfyear_pct10[t]=pctl(10,sum_qty[t-42]   ,  sum_qty[t-43]   ,  </div><div class="sasSource">sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   , </div><div class="sasSource"> sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   ,  sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   </div><div class="sasSource">,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   ,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]  </div><div class="sasSource"> ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]   ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71] </div><div class="sasSource">  ,  sum_qty[t-72]   ,  sum_qty[t-73]   ,  sum_qty[t-74]   ,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  </div><div class="sasSource">sum_qty[t-78]   ,  sum_qty[t-79]   ,  sum_qty[t-80]   ,  sum_qty[t-81]   ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   , </div><div class="sasSource"> sum_qty[t-85]   ,  sum_qty[t-86]   ,  sum_qty[t-87]   ,  sum_qty[t-88]   ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   </div><div class="sasSource">,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]  </div><div class="sasSource"> ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  </div><div class="sasSource">sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  </div><div class="sasSource">sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  </div><div class="sasSource">sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  </div><div class="sasSource">sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  </div><div class="sasSource">sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  </div><div class="sasSource">sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  </div><div class="sasSource">sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  </div><div class="sasSource">sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  </div><div class="sasSource">sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  </div><div class="sasSource">sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  </div><div class="sasSource">sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  </div><div class="sasSource">sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  </div><div class="sasSource">sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  </div><div class="sasSource">sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  </div><div class="sasSource">sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  </div><div class="sasSource">sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  </div><div class="sasSource">sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  </div><div class="sasSource">sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  </div><div class="sasSource">sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  </div><div class="sasSource">sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]) ;       lag_halfyear_pct90[t]=pctl(90,sum_qty[t-42]   ,  sum_qty[t-43]   ,  </div><div class="sasSource">sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   , </div><div class="sasSource"> sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   ,  sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   </div><div class="sasSource">,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   ,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]  </div><div class="sasSource"> ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]   ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71] </div><div class="sasSource">  ,  sum_qty[t-72]   ,  sum_qty[t-73]   ,  sum_qty[t-74]   ,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  </div><div class="sasSource">sum_qty[t-78]   ,  sum_qty[t-79]   ,  sum_qty[t-80]   ,  sum_qty[t-81]   ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   , </div><div class="sasSource"> sum_qty[t-85]   ,  sum_qty[t-86]   ,  sum_qty[t-87]   ,  sum_qty[t-88]   ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   </div><div class="sasSource">,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]  </div><div class="sasSource"> ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  </div><div class="sasSource">sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  </div><div class="sasSource">sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  </div><div class="sasSource">sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  </div><div class="sasSource">sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  </div><div class="sasSource">sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  </div><div class="sasSource">sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  </div><div class="sasSource">sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  </div><div class="sasSource">sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  </div><div class="sasSource">sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  </div><div class="sasSource">sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  </div><div class="sasSource">sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  </div><div class="sasSource">sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  </div><div class="sasSource">sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  </div><div class="sasSource">sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  </div><div class="sasSource">sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  </div><div class="sasSource">sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  </div><div class="sasSource">sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  </div><div class="sasSource">sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  </div><div class="sasSource">sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  </div><div class="sasSource">sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]) ;     end;     do t = 407 to _length_;     </div><div class="sasSource">lag_year_pct10[t]=pctl(10,sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  </div><div class="sasSource">sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   , </div><div class="sasSource"> sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   </div><div class="sasSource">,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]  </div><div class="sasSource"> ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]   ,  sum_qty[t-72]   ,  sum_qty[t-73]   ,  sum_qty[t-74] </div><div class="sasSource">  ,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  sum_qty[t-78]   ,  sum_qty[t-79]   ,  sum_qty[t-80]   ,  </div><div class="sasSource">sum_qty[t-81]   ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   ,  sum_qty[t-85]   ,  sum_qty[t-86]   ,  sum_qty[t-87]   , </div><div class="sasSource"> sum_qty[t-88]   ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   </div><div class="sasSource">,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  </div><div class="sasSource">sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  </div><div class="sasSource">sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  </div><div class="sasSource">sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  </div><div class="sasSource">sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  </div><div class="sasSource">sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  </div><div class="sasSource">sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  </div><div class="sasSource">sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  </div><div class="sasSource">sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  </div><div class="sasSource">sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  </div><div class="sasSource">sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  </div><div class="sasSource">sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  </div><div class="sasSource">sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  </div><div class="sasSource">sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  </div><div class="sasSource">sum_qty[t-179]   ,  sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  </div><div class="sasSource">sum_qty[t-185]   ,  sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  </div><div class="sasSource">sum_qty[t-191]   ,  sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  </div><div class="sasSource">sum_qty[t-197]   ,  sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  </div><div class="sasSource">sum_qty[t-203]   ,  sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  </div><div class="sasSource">sum_qty[t-209]   ,  sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  </div><div class="sasSource">sum_qty[t-215]   ,  sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  </div><div class="sasSource">sum_qty[t-221]   ,  sum_qty[t-222]   ,  sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  sum_qty[t-226]   ,  </div><div class="sasSource">sum_qty[t-227]   ,  sum_qty[t-228]   ,  sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  sum_qty[t-232]   ,  </div><div class="sasSource">sum_qty[t-233]   ,  sum_qty[t-234]   ,  sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  sum_qty[t-238]   ,  </div><div class="sasSource">sum_qty[t-239]   ,  sum_qty[t-240]   ,  sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  sum_qty[t-244]   ,  </div><div class="sasSource">sum_qty[t-245]   ,  sum_qty[t-246]   ,  sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  sum_qty[t-250]   ,  </div><div class="sasSource">sum_qty[t-251]   ,  sum_qty[t-252]   ,  sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  sum_qty[t-256]   ,  </div><div class="sasSource">sum_qty[t-257]   ,  sum_qty[t-258]   ,  sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  sum_qty[t-262]   ,  </div><div class="sasSource">sum_qty[t-263]   ,  sum_qty[t-264]   ,  sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  sum_qty[t-268]   ,  </div><div class="sasSource">sum_qty[t-269]   ,  sum_qty[t-270]   ,  sum_qty[t-271]   ,  sum_qty[t-272]   ,  sum_qty[t-273]   ,  sum_qty[t-274]   ,  </div><div class="sasSource">sum_qty[t-275]   ,  sum_qty[t-276]   ,  sum_qty[t-277]   ,  sum_qty[t-278]   ,  sum_qty[t-279]   ,  sum_qty[t-280]   ,  </div><div class="sasSource">sum_qty[t-281]   ,  sum_qty[t-282]   ,  sum_qty[t-283]   ,  sum_qty[t-284]   ,  sum_qty[t-285]   ,  sum_qty[t-286]   ,  </div><div class="sasSource">sum_qty[t-287]   ,  sum_qty[t-288]   ,  sum_qty[t-289]   ,  sum_qty[t-290]   ,  sum_qty[t-291]   ,  sum_qty[t-292]   ,  </div><div class="sasSource">sum_qty[t-293]   ,  sum_qty[t-294]   ,  sum_qty[t-295]   ,  sum_qty[t-296]   ,  sum_qty[t-297]   ,  sum_qty[t-298]   ,  </div><div class="sasSource">sum_qty[t-299]   ,  sum_qty[t-300]   ,  sum_qty[t-301]   ,  sum_qty[t-302]   ,  sum_qty[t-303]   ,  sum_qty[t-304]   ,  </div><div class="sasSource">sum_qty[t-305]   ,  sum_qty[t-306]   ,  sum_qty[t-307]   ,  sum_qty[t-308]   ,  sum_qty[t-309]   ,  sum_qty[t-310]   ,  </div><div class="sasSource">sum_qty[t-311]   ,  sum_qty[t-312]   ,  sum_qty[t-313]   ,  sum_qty[t-314]   ,  sum_qty[t-315]   ,  sum_qty[t-316]   ,  </div><div class="sasSource">sum_qty[t-317]   ,  sum_qty[t-318]   ,  sum_qty[t-319]   ,  sum_qty[t-320]   ,  sum_qty[t-321]   ,  sum_qty[t-322]   ,  </div><div class="sasSource">sum_qty[t-323]   ,  sum_qty[t-324]   ,  sum_qty[t-325]   ,  sum_qty[t-326]   ,  sum_qty[t-327]   ,  sum_qty[t-328]   ,  </div><div class="sasSource">sum_qty[t-329]   ,  sum_qty[t-330]   ,  sum_qty[t-331]   ,  sum_qty[t-332]   ,  sum_qty[t-333]   ,  sum_qty[t-334]   ,  </div><div class="sasSource">sum_qty[t-335]   ,  sum_qty[t-336]   ,  sum_qty[t-337]   ,  sum_qty[t-338]   ,  sum_qty[t-339]   ,  sum_qty[t-340]   ,  </div><div class="sasSource">sum_qty[t-341]   ,  sum_qty[t-342]   ,  sum_qty[t-343]   ,  sum_qty[t-344]   ,  sum_qty[t-345]   ,  sum_qty[t-346]   ,  </div><div class="sasSource">sum_qty[t-347]   ,  sum_qty[t-348]   ,  sum_qty[t-349]   ,  sum_qty[t-350]   ,  sum_qty[t-351]   ,  sum_qty[t-352]   ,  </div><div class="sasSource">sum_qty[t-353]   ,  sum_qty[t-354]   ,  sum_qty[t-355]   ,  sum_qty[t-356]   ,  sum_qty[t-357]   ,  sum_qty[t-358]   ,  </div><div class="sasSource">sum_qty[t-359]   ,  sum_qty[t-360]   ,  sum_qty[t-361]   ,  sum_qty[t-362]   ,  sum_qty[t-363]   ,  sum_qty[t-364]   ,  </div><div class="sasSource">sum_qty[t-365]   ,  sum_qty[t-366]   ,  sum_qty[t-367]   ,  sum_qty[t-368]   ,  sum_qty[t-369]   ,  sum_qty[t-370]   ,  </div><div class="sasSource">sum_qty[t-371]   ,  sum_qty[t-372]   ,  sum_qty[t-373]   ,  sum_qty[t-374]   ,  sum_qty[t-375]   ,  sum_qty[t-376]   ,  </div><div class="sasSource">sum_qty[t-377]   ,  sum_qty[t-378]   ,  sum_qty[t-379]   ,  sum_qty[t-380]   ,  sum_qty[t-381]   ,  sum_qty[t-382]   ,  </div><div class="sasSource">sum_qty[t-383]   ,  sum_qty[t-384]   ,  sum_qty[t-385]   ,  sum_qty[t-386]   ,  sum_qty[t-387]   ,  sum_qty[t-388]   ,  </div><div class="sasSource">sum_qty[t-389]   ,  sum_qty[t-390]   ,  sum_qty[t-391]   ,  sum_qty[t-392]   ,  sum_qty[t-393]   ,  sum_qty[t-394]   ,  </div><div class="sasSource">sum_qty[t-395]   ,  sum_qty[t-396]   ,  sum_qty[t-397]   ,  sum_qty[t-398]   ,  sum_qty[t-399]   ,  sum_qty[t-400]   ,  </div><div class="sasSource">sum_qty[t-401]   ,  sum_qty[t-402]   ,  sum_qty[t-403]   ,  sum_qty[t-404]   ,  sum_qty[t-405]   ,  sum_qty[t-406]) ;       </div><div class="sasSource">lag_year_pct90[t]=pctl(90,sum_qty[t-42]   ,  sum_qty[t-43]   ,  sum_qty[t-44]   ,  sum_qty[t-45]   ,  sum_qty[t-46]   ,  </div><div class="sasSource">sum_qty[t-47]   ,  sum_qty[t-48]   ,  sum_qty[t-49]   ,  sum_qty[t-50]   ,  sum_qty[t-51]   ,  sum_qty[t-52]   ,  sum_qty[t-53]   , </div><div class="sasSource"> sum_qty[t-54]   ,  sum_qty[t-55]   ,  sum_qty[t-56]   ,  sum_qty[t-57]   ,  sum_qty[t-58]   ,  sum_qty[t-59]   ,  sum_qty[t-60]   </div><div class="sasSource">,  sum_qty[t-61]   ,  sum_qty[t-62]   ,  sum_qty[t-63]   ,  sum_qty[t-64]   ,  sum_qty[t-65]   ,  sum_qty[t-66]   ,  sum_qty[t-67]  </div><div class="sasSource"> ,  sum_qty[t-68]   ,  sum_qty[t-69]   ,  sum_qty[t-70]   ,  sum_qty[t-71]   ,  sum_qty[t-72]   ,  sum_qty[t-73]   ,  sum_qty[t-74] </div><div class="sasSource">  ,  sum_qty[t-75]   ,  sum_qty[t-76]   ,  sum_qty[t-77]   ,  sum_qty[t-78]   ,  sum_qty[t-79]   ,  sum_qty[t-80]   ,  </div><div class="sasSource">sum_qty[t-81]   ,  sum_qty[t-82]   ,  sum_qty[t-83]   ,  sum_qty[t-84]   ,  sum_qty[t-85]   ,  sum_qty[t-86]   ,  sum_qty[t-87]   , </div><div class="sasSource"> sum_qty[t-88]   ,  sum_qty[t-89]   ,  sum_qty[t-90]   ,  sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   </div><div class="sasSource">,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  </div><div class="sasSource">sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  </div><div class="sasSource">sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  </div><div class="sasSource">sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  </div><div class="sasSource">sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  </div><div class="sasSource">sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  </div><div class="sasSource">sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  </div><div class="sasSource">sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  </div><div class="sasSource">sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  </div><div class="sasSource">sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  </div><div class="sasSource">sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  </div><div class="sasSource">sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  </div><div class="sasSource">sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  </div><div class="sasSource">sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  </div><div class="sasSource">sum_qty[t-179]   ,  sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  </div><div class="sasSource">sum_qty[t-185]   ,  sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  </div><div class="sasSource">sum_qty[t-191]   ,  sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  </div><div class="sasSource">sum_qty[t-197]   ,  sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  </div><div class="sasSource">sum_qty[t-203]   ,  sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  </div><div class="sasSource">sum_qty[t-209]   ,  sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  </div><div class="sasSource">sum_qty[t-215]   ,  sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  </div><div class="sasSource">sum_qty[t-221]   ,  sum_qty[t-222]   ,  sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  sum_qty[t-226]   ,  </div><div class="sasSource">sum_qty[t-227]   ,  sum_qty[t-228]   ,  sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  sum_qty[t-232]   ,  </div><div class="sasSource">sum_qty[t-233]   ,  sum_qty[t-234]   ,  sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  sum_qty[t-238]   ,  </div><div class="sasSource">sum_qty[t-239]   ,  sum_qty[t-240]   ,  sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  sum_qty[t-244]   ,  </div><div class="sasSource">sum_qty[t-245]   ,  sum_qty[t-246]   ,  sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  sum_qty[t-250]   ,  </div><div class="sasSource">sum_qty[t-251]   ,  sum_qty[t-252]   ,  sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  sum_qty[t-256]   ,  </div><div class="sasSource">sum_qty[t-257]   ,  sum_qty[t-258]   ,  sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  sum_qty[t-262]   ,  </div><div class="sasSource">sum_qty[t-263]   ,  sum_qty[t-264]   ,  sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  sum_qty[t-268]   ,  </div><div class="sasSource">sum_qty[t-269]   ,  sum_qty[t-270]   ,  sum_qty[t-271]   ,  sum_qty[t-272]   ,  sum_qty[t-273]   ,  sum_qty[t-274]   ,  </div><div class="sasSource">sum_qty[t-275]   ,  sum_qty[t-276]   ,  sum_qty[t-277]   ,  sum_qty[t-278]   ,  sum_qty[t-279]   ,  sum_qty[t-280]   ,  </div><div class="sasSource">sum_qty[t-281]   ,  sum_qty[t-282]   ,  sum_qty[t-283]   ,  sum_qty[t-284]   ,  sum_qty[t-285]   ,  sum_qty[t-286]   ,  </div><div class="sasSource">sum_qty[t-287]   ,  sum_qty[t-288]   ,  sum_qty[t-289]   ,  sum_qty[t-290]   ,  sum_qty[t-291]   ,  sum_qty[t-292]   ,  </div><div class="sasSource">sum_qty[t-293]   ,  sum_qty[t-294]   ,  sum_qty[t-295]   ,  sum_qty[t-296]   ,  sum_qty[t-297]   ,  sum_qty[t-298]   ,  </div><div class="sasSource">sum_qty[t-299]   ,  sum_qty[t-300]   ,  sum_qty[t-301]   ,  sum_qty[t-302]   ,  sum_qty[t-303]   ,  sum_qty[t-304]   ,  </div><div class="sasSource">sum_qty[t-305]   ,  sum_qty[t-306]   ,  sum_qty[t-307]   ,  sum_qty[t-308]   ,  sum_qty[t-309]   ,  sum_qty[t-310]   ,  </div><div class="sasSource">sum_qty[t-311]   ,  sum_qty[t-312]   ,  sum_qty[t-313]   ,  sum_qty[t-314]   ,  sum_qty[t-315]   ,  sum_qty[t-316]   ,  </div><div class="sasSource">sum_qty[t-317]   ,  sum_qty[t-318]   ,  sum_qty[t-319]   ,  sum_qty[t-320]   ,  sum_qty[t-321]   ,  sum_qty[t-322]   ,  </div><div class="sasSource">sum_qty[t-323]   ,  sum_qty[t-324]   ,  sum_qty[t-325]   ,  sum_qty[t-326]   ,  sum_qty[t-327]   ,  sum_qty[t-328]   ,  </div><div class="sasSource">sum_qty[t-329]   ,  sum_qty[t-330]   ,  sum_qty[t-331]   ,  sum_qty[t-332]   ,  sum_qty[t-333]   ,  sum_qty[t-334]   ,  </div><div class="sasSource">sum_qty[t-335]   ,  sum_qty[t-336]   ,  sum_qty[t-337]   ,  sum_qty[t-338]   ,  sum_qty[t-339]   ,  sum_qty[t-340]   ,  </div><div class="sasSource">sum_qty[t-341]   ,  sum_qty[t-342]   ,  sum_qty[t-343]   ,  sum_qty[t-344]   ,  sum_qty[t-345]   ,  sum_qty[t-346]   ,  </div><div class="sasSource">sum_qty[t-347]   ,  sum_qty[t-348]   ,  sum_qty[t-349]   ,  sum_qty[t-350]   ,  sum_qty[t-351]   ,  sum_qty[t-352]   ,  </div><div class="sasSource">sum_qty[t-353]   ,  sum_qty[t-354]   ,  sum_qty[t-355]   ,  sum_qty[t-356]   ,  sum_qty[t-357]   ,  sum_qty[t-358]   ,  </div><div class="sasSource">sum_qty[t-359]   ,  sum_qty[t-360]   ,  sum_qty[t-361]   ,  sum_qty[t-362]   ,  sum_qty[t-363]   ,  sum_qty[t-364]   ,  </div><div class="sasSource">sum_qty[t-365]   ,  sum_qty[t-366]   ,  sum_qty[t-367]   ,  sum_qty[t-368]   ,  sum_qty[t-369]   ,  sum_qty[t-370]   ,  </div><div class="sasSource">sum_qty[t-371]   ,  sum_qty[t-372]   ,  sum_qty[t-373]   ,  sum_qty[t-374]   ,  sum_qty[t-375]   ,  sum_qty[t-376]   ,  </div><div class="sasSource">sum_qty[t-377]   ,  sum_qty[t-378]   ,  sum_qty[t-379]   ,  sum_qty[t-380]   ,  sum_qty[t-381]   ,  sum_qty[t-382]   ,  </div><div class="sasSource">sum_qty[t-383]   ,  sum_qty[t-384]   ,  sum_qty[t-385]   ,  sum_qty[t-386]   ,  sum_qty[t-387]   ,  sum_qty[t-388]   ,  </div><div class="sasSource">sum_qty[t-389]   ,  sum_qty[t-390]   ,  sum_qty[t-391]   ,  sum_qty[t-392]   ,  sum_qty[t-393]   ,  sum_qty[t-394]   ,  </div><div class="sasSource">sum_qty[t-395]   ,  sum_qty[t-396]   ,  sum_qty[t-397]   ,  sum_qty[t-398]   ,  sum_qty[t-399]   ,  sum_qty[t-400]   ,  </div><div class="sasSource">sum_qty[t-401]   ,  sum_qty[t-402]   ,  sum_qty[t-403]   ,  sum_qty[t-404]   ,  sum_qty[t-405]   ,  sum_qty[t-406]) ;     end;      </div><div class="sasSource">" , arrayOut={ table={name='lag_abt3', replace=true, caslib='Public'}, arrays={{name='lag_year_pct90'}, {name='lag_year_pct10'}, </div><div class="sasSource">{name='lag_halfyear_pct90'}, {name='lag_halfyear_pct10'}, {name='lag_qtr_pct90'}, {name='lag_qtr_pct10'}, {name='lag_month_pct90'}, </div><div class="sasSource">{name='lag_month_pct10'}, {name='lag_week_pct90'}, {name='lag_week_pct10'}} } ;</div><div class="sasSource">MPRINT(CMPCODE3):   run;</div><div class="sasNote" id="sasLogNote307_1620885733386">NOTE: Active Session now CASAUTO.</div><div class="sasError" id="sasLogError13_1620885733386">ERROR: The file or path 'abt4_ml' is not available in the file system.</div><div class="sasError" id="sasLogError14_1620885733386">ERROR: Table 'abt4_ml' could not be loaded.</div><div class="sasError" id="sasLogError15_1620885733386">ERROR: Failure opening table 'abt4_ml': A table could not be loaded.</div><div class="sasError" id="sasLogError16_1620885733386">ERROR: The action stopped due to errors.</div><div class="sasSource">MPRINT(CMPCODE3):   quit;</div><div class="sasNote" id="sasLogNote308_1620885733386">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           1.48 seconds</div><div class="sasNote">      user cpu time       1.43 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10112.00k</div><div class="sasNote">      OS Memory           45440.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:22 AM</div><div class="sasNote">      Step Count                        84  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1028</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        15</div><div class="sasNote">      Involuntary Context Switches      13</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           144472</div><div class="sasNote">      </div><div class="sasSource">1395  /* соеденим среднее, медиану, стд, процентили вместе, убирая пропуску</div><div class="sasSource">1395! вр ВР */</div><div class="sasSource">1396  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote309_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1397  create table public.abt5_ml{options replace=true} as</div><div class="sasSource">1398  select</div><div class="sasSource">1399  t1.PBO_LOCATION_ID,</div><div class="sasSource">1400  t1.PRODUCT_ID,</div><div class="sasSource">1401  t1.CHANNEL_CD,</div><div class="sasSource">1402  t1.SALES_DT,</div><div class="sasSource">1403  t1.sum_qty,</div><div class="sasSource">1404  t1.GROSS_PRICE_AMT,</div><div class="sasSource">1405  t2.lag_halfyear_avg,</div><div class="sasSource">1406  t2.lag_halfyear_med,</div><div class="sasSource">1407  t2.lag_month_avg,</div><div class="sasSource">1408  t2.lag_month_med,</div><div class="sasSource">1409  t2.lag_qtr_avg,</div><div class="sasSource">1410  t2.lag_qtr_med,</div><div class="sasSource">1411  t2.lag_week_avg,</div><div class="sasSource">1412  t2.lag_week_med,</div><div class="sasSource">1413  t2.lag_year_avg,</div><div class="sasSource">1414  t2.lag_year_med</div><div class="sasSource">1415  from</div><div class="sasSource">1416  public.abt4_ml as t1,</div><div class="sasSource">1417  public.lag_abt1 as t2</div><div class="sasSource">1418  where</div><div class="sasSource">1419  t1.CHANNEL_CD = t2.CHANNEL_CD and</div><div class="sasSource">1420  t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">1421  t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">1422  t1.SALES_DT = t2.SALES_DT</div><div class="sasSource">1423  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote310_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.ABT4_ML" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError17_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote311_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">1424  quit;</div><div class="sasNote" id="sasLogNote312_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              80.15k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:22 AM</div><div class="sasNote">      Step Count                        85  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     12</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1425  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote313_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1426  create table public.abt5_ml{options replace=true} as</div><div class="sasSource">1427  select</div><div class="sasSource">1428  t1.PBO_LOCATION_ID,</div><div class="sasSource">1429  t1.PRODUCT_ID,</div><div class="sasSource">1430  t1.CHANNEL_CD,</div><div class="sasSource">1431  t1.SALES_DT,</div><div class="sasSource">1432  t1.sum_qty,</div><div class="sasSource">1433  t1.GROSS_PRICE_AMT,</div><div class="sasSource">1434  t1.lag_halfyear_avg,</div><div class="sasSource">1435  t1.lag_halfyear_med,</div><div class="sasSource">1436  t1.lag_month_avg,</div><div class="sasSource">1437  t1.lag_month_med,</div><div class="sasSource">1438  t1.lag_qtr_avg,</div><div class="sasSource">1439  t1.lag_qtr_med,</div><div class="sasSource">1440  t1.lag_week_avg,</div><div class="sasSource">1441  t1.lag_week_med,</div><div class="sasSource">1442  t1.lag_year_avg,</div><div class="sasSource">1443  t1.lag_year_med,</div><div class="sasSource">1444  t2.lag_halfyear_std,</div><div class="sasSource">1445  t2.lag_month_std,</div><div class="sasSource">1446  t2.lag_qtr_std,</div><div class="sasSource">1447  t2.lag_week_std,</div><div class="sasSource">1448  t2.lag_year_std</div><div class="sasSource">1449  from</div><div class="sasSource">1450  public.abt5_ml as t1,</div><div class="sasSource">1451  public.lag_abt2 as t2</div><div class="sasSource">1452  where</div><div class="sasSource">1453  t1.CHANNEL_CD = t2.CHANNEL_CD and</div><div class="sasSource">1454  t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">1455  t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">1456  t1.SALES_DT = t2.SALES_DT</div><div class="sasSource">1457  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote314_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.ABT5_ML" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError18_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote315_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">1458  quit;</div><div class="sasNote" id="sasLogNote316_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              103.21k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:22 AM</div><div class="sasNote">      Step Count                        86  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1459  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote317_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1460  create table public.abt5_ml{options replace=true} as</div><div class="sasSource">1461  select</div><div class="sasSource">1462  t1.PBO_LOCATION_ID,</div><div class="sasSource">1463  t1.PRODUCT_ID,</div><div class="sasSource">1464  t1.CHANNEL_CD,</div><div class="sasSource">1465  t1.SALES_DT,</div><div class="sasSource">1466  t1.sum_qty,</div><div class="sasSource">1467  t1.GROSS_PRICE_AMT,</div><div class="sasSource">1468  t1.lag_halfyear_avg,</div><div class="sasSource">1469  t1.lag_halfyear_med,</div><div class="sasSource">1470  t1.lag_month_avg,</div><div class="sasSource">1471  t1.lag_month_med,</div><div class="sasSource">1472  t1.lag_qtr_avg,</div><div class="sasSource">1473  t1.lag_qtr_med,</div><div class="sasSource">1474  t1.lag_week_avg,</div><div class="sasSource">1475  t1.lag_week_med,</div><div class="sasSource">1476  t1.lag_year_avg,</div><div class="sasSource">1477  t1.lag_year_med,</div><div class="sasSource">1478  t1.lag_halfyear_std,</div><div class="sasSource">1479  t1.lag_month_std,</div><div class="sasSource">1480  t1.lag_qtr_std,</div><div class="sasSource">1481  t1.lag_week_std,</div><div class="sasSource">1482  t1.lag_year_std,</div><div class="sasSource">1483  t2.lag_halfyear_pct10,</div><div class="sasSource">1484  t2.lag_halfyear_pct90,</div><div class="sasSource">1485  t2.lag_month_pct10,</div><div class="sasSource">1486  t2.lag_month_pct90,</div><div class="sasSource">1487  t2.lag_qtr_pct10,</div><div class="sasSource">1488  t2.lag_qtr_pct90,</div><div class="sasSource">1489  t2.lag_week_pct10,</div><div class="sasSource">1490  t2.lag_week_pct90,</div><div class="sasSource">1491  t2.lag_year_pct10,</div><div class="sasSource">1492  t2.lag_year_pct90</div><div class="sasSource">1493  from</div><div class="sasSource">1494  public.abt5_ml as t1,</div><div class="sasSource">1495  public.lag_abt3 as t2</div><div class="sasSource">1496  where</div><div class="sasSource">1497  t1.CHANNEL_CD = t2.CHANNEL_CD and</div><div class="sasSource">1498  t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">1499  t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">1500  t1.SALES_DT = t2.SALES_DT</div><div class="sasSource">1501  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote318_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.ABT5_ML" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError19_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote319_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">1502  quit;</div><div class="sasNote" id="sasLogNote320_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              218.34k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:22 AM</div><div class="sasNote">      Step Count                        87  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        27</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">1503  proc casutil;</div><div class="sasNote" id="sasLogNote321_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">1504  /*   promote casdata="abt5_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">1505    droptable casdata='lag_abt1' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote322_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015025 seconds.</div><div class="sasSource">1506    droptable casdata='lag_abt2' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote323_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.013111 seconds.</div><div class="sasSource">1507    droptable casdata='lag_abt3' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote324_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.013569 seconds.</div><div class="sasSource">1508    droptable casdata="abt4_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote325_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.011506 seconds.</div><div class="sasSource">1509  run;</div><div class="sasSource">1510  /****** 6. Добавление промо ******/</div><div class="sasNote" id="sasLogNote326_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.08 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              117.03k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:22 AM</div><div class="sasNote">      Step Count                        88  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1511  proc casutil;</div><div class="sasNote" id="sasLogNote327_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">1512  </div><div class="sasSource">1512!  load data=&amp;inlib..ia_pbo_loc_hierarchy casout='ia_pbo_loc_hierarchy' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote328_1620885733386">NOTE: IA.IA_PBO_LOC_HIERARCHY was successfully added to the "Public" caslib as "IA_PBO_LOC_HIERARCHY".</div><div class="sasSource">1513  </div><div class="sasSource">1513!  load data=&amp;inlib..ia_product_hierarchy casout='ia_product_hierarchy' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote329_1620885733386">NOTE: IA.IA_PRODUCT_HIERARCHY was successfully added to the "Public" caslib as "IA_PRODUCT_HIERARCHY".</div><div class="sasSource">1514  </div><div class="sasSource">1514!  load data=&amp;inlib..promo_enh casout='ia_promo' outcaslib='public' replace;</div><div class="sasError" id="sasLogError20_1620885733386">ERROR: File IA.PROMO_ENH.DATA does not exist.</div><div class="sasSource">1515  </div><div class="sasSource">1515!  load data=&amp;inlib..promo_pbo_enh casout='ia_promo_x_pbo' outcaslib='public' replace;</div><div class="sasError" id="sasLogError21_1620885733386">ERROR: File IA.PROMO_PBO_ENH.DATA does not exist.</div><div class="sasSource">1516  </div><div class="sasSource">1516!  load data=&amp;inlib..promo_product_enh casout='ia_promo_x_product' outcaslib='public' replace;</div><div class="sasError" id="sasLogError22_1620885733386">ERROR: File IA.PROMO_PRODUCT_ENH.DATA does not exist.</div><div class="sasSource">1517  </div><div class="sasSource">1517!  droptable casdata="pbo_hier_flat" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote330_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01217 seconds.</div><div class="sasSource">1518  </div><div class="sasSource">1518!  droptable casdata="product_hier_flat" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote331_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.013676 seconds.</div><div class="sasSource">1519  </div><div class="sasSource">1519!  droptable casdata="lvl5" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote332_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015884 seconds.</div><div class="sasSource">1520  </div><div class="sasSource">1520!  droptable casdata="lvl4" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote333_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.013649 seconds.</div><div class="sasSource">1521  </div><div class="sasSource">1521!  droptable casdata="lvl3" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote334_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.014796 seconds.</div><div class="sasSource">1522  </div><div class="sasSource">1522!  droptable casdata="lvl2" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote335_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015223 seconds.</div><div class="sasSource">1523  </div><div class="sasSource">1523!  droptable casdata="lvl1" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote336_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015442 seconds.</div><div class="sasSource">1524  </div><div class="sasSource">1524!  droptable casdata="pbo_lvl_all" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote337_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01512 seconds.</div><div class="sasSource">1525  </div><div class="sasSource">1525!  droptable casdata="product_lvl_all" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote338_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016499 seconds.</div><div class="sasSource">1526    </div><div class="sasSource">1526!    droptable casdata="promo_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote339_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.018161 seconds.</div><div class="sasSource">1527    </div><div class="sasSource">1527!    droptable casdata="promo_transposed" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote340_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016382 seconds.</div><div class="sasSource">1528    </div><div class="sasSource">1528!    droptable casdata="abt6_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote341_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.013121 seconds.</div><div class="sasSource">1529    </div><div class="sasSource">1529!    droptable casdata="ia_promo_x_product_leaf" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote342_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.012417 seconds.</div><div class="sasSource">1530    </div><div class="sasSource">1530!    droptable casdata="ia_promo_x_pbo_leaf" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote343_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.014592 seconds.</div><div class="sasSource">1531    </div><div class="sasSource">1531!    droptable casdata="promo_ml_main_code" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote344_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.017357 seconds.</div><div class="sasSource">1532    </div><div class="sasSource">1532!    droptable casdata="abt_promo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote345_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.014961 seconds.</div><div class="sasSource">1533  run;</div><div class="sasSource">1534  /* Создаем таблицу соответствия наименований промо-механик и</div><div class="sasSource">1534! реальных механик */</div><div class="sasSource">1535  /* data public.promo_mech_transformation; */</div><div class="sasSource">1536  /* infile datalines delimiter='|'; */</div><div class="sasSource">1537  /* length old_mechanic new_mechanic $50;  */</div><div class="sasSource">1538  /*     input old_mechanic $ new_mechanic $; */</div><div class="sasSource">1539  /*     datalines; */</div><div class="sasSource">1540  /* BOGO / 1+1|bogo */</div><div class="sasSource">1541  /* Discount|discount */</div><div class="sasSource">1542  /* EVM/Set|evm_set */</div><div class="sasSource">1543  /* Non-Product Gift|non_product_gift */</div><div class="sasSource">1544  /* Pairs|pairs */</div><div class="sasSource">1545  /* Product Gift|product_gift */</div><div class="sasSource">1546  /* Other: Discount for volume|other_discount */</div><div class="sasSource">1547  /* Other: Digital (app)|other_digital */</div><div class="sasSource">1548  /* NP Promo Support|support */</div><div class="sasSource">1549  /* ; */</div><div class="sasSource">1550  /* run; */</div><div class="sasSource">1551  %let RTP_PROMO_MECH_TRANSF_FILE = /home/rusakr/sasuser.viya/PROMO_MECH_TRANSFORMATION.csv;</div><div class="sasNote" id="sasLogNote346_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.53 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              2340.53k</div><div class="sasNote">      OS Memory           37552.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:23 AM</div><div class="sasNote">      Step Count                        89  Switch Count  3</div><div class="sasNote">      Page Faults                       1</div><div class="sasNote">      Page Reclaims                     377</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        149</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            4528</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">1552  data public.promo_mech_transformation;</div><div class="sasSource">1553  length old_mechanic new_mechanic $50;</div><div class="sasSource">1554  infile "&amp;RTP_PROMO_MECH_TRANSF_FILE." dsd firstobs=2;</div><div class="sasSource">1555  input old_mechanic $ new_mechanic $;</div><div class="sasSource">1556  run;</div><div class="sasNote" id="sasLogNote347_1620885733386">NOTE: The INFILE statement is not supported with DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote348_1620885733386">NOTE: The INPUT statement is not supported with DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote349_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasError" id="sasLogError23_1620885733386">ERROR: Physical file does not exist, /home/rusakr/sasuser.viya/PROMO_MECH_TRANSFORMATION.csv.</div><div class="sasNote" id="sasLogNote350_1620885733386">NOTE: The SAS System stopped processing this step because of errors.</div><div class="sasWarning" id="sasLogWarning1_1620885733386">WARNING: The data set PUBLIC.PROMO_MECH_TRANSFORMATION may be incomplete.  When this step was stopped there were 0 observations and </div><div class="sasWarning">         2 variables.</div><div class="sasWarning" id="sasLogWarning2_1620885733386">WARNING: Data set PUBLIC.PROMO_MECH_TRANSFORMATION was not replaced because this step was stopped.</div><div class="sasNote" id="sasLogNote351_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.01 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              328.50k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:23 AM</div><div class="sasNote">      Step Count                        90  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     34</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1557  /* Создаем таблицу связывающую PBO на листовом уровне и на любом другом</div><div class="sasSource">1557!  */</div><div class="sasSource">1558  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote352_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1559  create table public.pbo_hier_flat{options replace=true} as</div><div class="sasSource">1560  select</div><div class="sasSource">1561  t1.pbo_location_id,</div><div class="sasSource">1562  t2.PBO_LOCATION_ID as LVL3_ID,</div><div class="sasSource">1563  t2.PARENT_PBO_LOCATION_ID as LVL2_ID,</div><div class="sasSource">1564  1 as LVL1_ID</div><div class="sasSource">1565  from</div><div class="sasSource">1566  (select * from public.ia_pbo_loc_hierarchy where pbo_location_lvl=4) as t1</div><div class="sasSource">1567  left join</div><div class="sasSource">1568  (select * from public.ia_pbo_loc_hierarchy where pbo_location_lvl=3) as t2</div><div class="sasSource">1569  on t1.PARENT_PBO_LOCATION_ID=t2.PBO_LOCATION_ID</div><div class="sasSource">1570  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote353_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_HIER_FLAT was created in caslib Public with 869 rows returned.</div><div class="sasNote" id="sasLogNote354_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1571  create table public.lvl4{options replace=true} as</div><div class="sasSource">1572  select distinct</div><div class="sasSource">1573  pbo_location_id as pbo_location_id,</div><div class="sasSource">1574  pbo_location_id as pbo_leaf_id</div><div class="sasSource">1575  from</div><div class="sasSource">1576  public.pbo_hier_flat</div><div class="sasSource">1577  ;</div><div class="sasSource">NOTE: Table LVL4 was created in caslib Public with 869 rows returned.</div><div class="sasNote" id="sasLogNote355_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1578  create table public.lvl3{options replace=true} as</div><div class="sasSource">1579  select distinct</div><div class="sasSource">1580  LVL3_ID as pbo_location_id,</div><div class="sasSource">1581  pbo_location_id as pbo_leaf_id</div><div class="sasSource">1582  from</div><div class="sasSource">1583  public.pbo_hier_flat</div><div class="sasSource">1584  ;</div><div class="sasSource">NOTE: Table LVL3 was created in caslib Public with 869 rows returned.</div><div class="sasNote" id="sasLogNote356_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1585  create table public.lvl2{options replace=true} as</div><div class="sasSource">1586  select distinct</div><div class="sasSource">1587  LVL2_ID as pbo_location_id,</div><div class="sasSource">1588  pbo_location_id as pbo_leaf_id</div><div class="sasSource">1589  from</div><div class="sasSource">1590  public.pbo_hier_flat</div><div class="sasSource">1591  ;</div><div class="sasSource">NOTE: Table LVL2 was created in caslib Public with 869 rows returned.</div><div class="sasNote" id="sasLogNote357_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1592  create table public.lvl1{options replace=true} as</div><div class="sasSource">1593  select</div><div class="sasSource">1594  1 as pbo_location_id,</div><div class="sasSource">1595  pbo_location_id as pbo_leaf_id</div><div class="sasSource">1596  from</div><div class="sasSource">1597  public.pbo_hier_flat</div><div class="sasSource">1598  ;</div><div class="sasSource">NOTE: Table LVL1 was created in caslib Public with 869 rows returned.</div><div class="sasNote" id="sasLogNote358_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1599  quit;</div><div class="sasNote" id="sasLogNote359_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.80 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              86.43k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:24 AM</div><div class="sasNote">      Step Count                        91  Switch Count  5</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        78</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">1600  /* Соединяем в единый справочник ПБО */</div><div class="sasSource">1601  data public.pbo_lvl_all;</div><div class="sasSource">1602  set public.lvl4 public.lvl3 public.lvl2 public.lvl1;</div><div class="sasSource">1603  run;</div><div class="sasNote" id="sasLogNote360_1620885733386">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote361_1620885733386">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote362_1620885733386">NOTE: There were 869 observations read from the table LVL4 in caslib Public.</div><div class="sasNote" id="sasLogNote363_1620885733386">NOTE: There were 869 observations read from the table LVL3 in caslib Public.</div><div class="sasNote" id="sasLogNote364_1620885733386">NOTE: There were 869 observations read from the table LVL2 in caslib Public.</div><div class="sasNote" id="sasLogNote365_1620885733386">NOTE: There were 869 observations read from the table LVL1 in caslib Public.</div><div class="sasNote" id="sasLogNote366_1620885733386">NOTE: The table pbo_lvl_all in caslib Public has 3476 observations and 2 variables.</div><div class="sasNote" id="sasLogNote367_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.40 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1487.40k</div><div class="sasNote">      OS Memory           36632.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:24 AM</div><div class="sasNote">      Step Count                        92  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     19</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        158</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1604  /* Создаем таблицу связывающую товары на листовом уровне и на любом</div><div class="sasSource">1604! другом */</div><div class="sasSource">1605  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote368_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1606     create table public.product_hier_flat{options replace=true} as</div><div class="sasSource">1607  select t1.product_id,</div><div class="sasSource">1608     t2.product_id  as LVL4_ID,</div><div class="sasSource">1609     t3.product_id  as LVL3_ID,</div><div class="sasSource">1610     t3.PARENT_product_id as LVL2_ID,</div><div class="sasSource">1611     1 as LVL1_ID</div><div class="sasSource">1612  from</div><div class="sasSource">1613  (select * from public.ia_product_hierarchy where product_lvl=5) as t1</div><div class="sasSource">1614  left join</div><div class="sasSource">1615  (select * from public.ia_product_hierarchy where product_lvl=4) as t2</div><div class="sasSource">1616  on t1.PARENT_PRODUCT_ID=t2.PRODUCT_ID</div><div class="sasSource">1617  left join</div><div class="sasSource">1618  (select * from public.ia_product_hierarchy where product_lvl=3) as t3</div><div class="sasSource">1619  on t2.PARENT_PRODUCT_ID=t3.PRODUCT_ID</div><div class="sasSource">1620   ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote369_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_HIER_FLAT was created in caslib Public with 2916 rows returned.</div><div class="sasNote" id="sasLogNote370_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1621  create table public.lvl5{options replace=true} as</div><div class="sasSource">1622  select distinct</div><div class="sasSource">1623  product_id as product_id,</div><div class="sasSource">1624  product_id as product_leaf_id</div><div class="sasSource">1625  from</div><div class="sasSource">1626  public.product_hier_flat</div><div class="sasSource">1627  ;</div><div class="sasSource">NOTE: Table LVL5 was created in caslib Public with 2916 rows returned.</div><div class="sasNote" id="sasLogNote371_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1628  create table public.lvl4{options replace=true} as</div><div class="sasSource">1629  select distinct</div><div class="sasSource">1630  LVL4_ID as product_id,</div><div class="sasSource">1631  product_id as product_leaf_id</div><div class="sasSource">1632  from</div><div class="sasSource">1633  public.product_hier_flat</div><div class="sasSource">1634  ;</div><div class="sasSource">NOTE: Table LVL4 was created in caslib Public with 2916 rows returned.</div><div class="sasNote" id="sasLogNote372_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1635  create table public.lvl3{options replace=true} as</div><div class="sasSource">1636  select distinct</div><div class="sasSource">1637  LVL3_ID as product_id,</div><div class="sasSource">1638  product_id as product_leaf_id</div><div class="sasSource">1639  from</div><div class="sasSource">1640  public.product_hier_flat</div><div class="sasSource">1641  ;</div><div class="sasSource">NOTE: Table LVL3 was created in caslib Public with 2916 rows returned.</div><div class="sasNote" id="sasLogNote373_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1642  create table public.lvl2{options replace=true} as</div><div class="sasSource">1643  select distinct</div><div class="sasSource">1644  LVL2_ID as product_id,</div><div class="sasSource">1645  product_id as product_leaf_id</div><div class="sasSource">1646  from</div><div class="sasSource">1647  public.product_hier_flat</div><div class="sasSource">1648  ;</div><div class="sasSource">NOTE: Table LVL2 was created in caslib Public with 2916 rows returned.</div><div class="sasNote" id="sasLogNote374_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1649  create table public.lvl1{options replace=true} as</div><div class="sasSource">1650  select</div><div class="sasSource">1651  1 as product_id,</div><div class="sasSource">1652  product_id as product_leaf_id</div><div class="sasSource">1653  from</div><div class="sasSource">1654  public.product_hier_flat</div><div class="sasSource">1655  ;</div><div class="sasSource">NOTE: Table LVL1 was created in caslib Public with 2916 rows returned.</div><div class="sasNote" id="sasLogNote375_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1656  quit;</div><div class="sasNote" id="sasLogNote376_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           1.22 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              86.53k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:25 AM</div><div class="sasNote">      Step Count                        93  Switch Count  6</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        93</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">1657  /* Соединяем в единый справочник ПБО */</div><div class="sasSource">1658  data public.product_lvl_all;</div><div class="sasSource">1659  set public.lvl5 public.lvl4 public.lvl3 public.lvl2 public.lvl1;</div><div class="sasSource">1660  run;</div><div class="sasNote" id="sasLogNote377_1620885733386">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote378_1620885733386">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote379_1620885733386">NOTE: There were 2916 observations read from the table LVL5 in caslib Public.</div><div class="sasNote" id="sasLogNote380_1620885733386">NOTE: There were 2916 observations read from the table LVL4 in caslib Public.</div><div class="sasNote" id="sasLogNote381_1620885733386">NOTE: There were 2916 observations read from the table LVL3 in caslib Public.</div><div class="sasNote" id="sasLogNote382_1620885733386">NOTE: There were 2916 observations read from the table LVL2 in caslib Public.</div><div class="sasNote" id="sasLogNote383_1620885733386">NOTE: There were 2916 observations read from the table LVL1 in caslib Public.</div><div class="sasNote" id="sasLogNote384_1620885733386">NOTE: The table product_lvl_all in caslib Public has 14580 observations and 2 variables.</div><div class="sasNote" id="sasLogNote385_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.45 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1485.34k</div><div class="sasNote">      OS Memory           36632.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:26 AM</div><div class="sasNote">      Step Count                        94  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     15</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        183</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1661  /* Добавляем к таблице промо ПБО и товары */</div><div class="sasSource">1662  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote386_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1663  create table public.ia_promo_x_pbo_leaf{options replace = true} as</div><div class="sasSource">1664  select distinct</div><div class="sasSource">1665  t1.promo_id,</div><div class="sasSource">1666  t2.PBO_LEAF_ID</div><div class="sasSource">1667  from</div><div class="sasSource">1668  public.ia_promo_x_pbo as t1,</div><div class="sasSource">1669  public.pbo_lvl_all as t2</div><div class="sasSource">1670  where t1.pbo_location_id = t2.PBO_LOCATION_ID</div><div class="sasSource">1671  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote387_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.IA_PROMO_X_PBO" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError24_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote388_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">1672  create table public.ia_promo_x_product_leaf{options replace = true} as</div><div class="sasSource">1673  select distinct</div><div class="sasSource">1674  t1.promo_id,</div><div class="sasSource">1675  t2.product_LEAF_ID</div><div class="sasSource">1676  from</div><div class="sasSource">1677  public.ia_promo_x_product as t1,</div><div class="sasSource">1678  public.product_lvl_all as t2</div><div class="sasSource">1679  where t1.product_id = t2.product_id</div><div class="sasSource">1680  ;</div><div class="sasSource">ERROR: Table "PUBLIC.IA_PROMO_X_PRODUCT" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError25_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasSource">1681  create table public.promo_ml{options replace = true} as</div><div class="sasSource">1682  select</div><div class="sasSource">1683  t1.PROMO_ID,</div><div class="sasSource">1684  t3.product_LEAF_ID,</div><div class="sasSource">1685  t2.PBO_LEAF_ID,</div><div class="sasSource">1686  t1.PROMO_NM,</div><div class="sasSource">1687  t1.PROMO_PRICE_AMT,</div><div class="sasSource">1688  datepart(t1.START_DT) as start_dt,</div><div class="sasSource">1689  datepart(t1.END_DT) as end_dt,</div><div class="sasSource">1690  t1.CHANNEL_CD,</div><div class="sasSource">1691  t1.NP_GIFT_PRICE_AMT,</div><div class="sasSource">1692  t1.PROMO_MECHANICS,</div><div class="sasSource">1693  t4.new_mechanic as promo_mechanics_name,</div><div class="sasSource">1694  1 as promo_flag</div><div class="sasSource">1695  from</div><div class="sasSource">1696  public.ia_promo as t1</div><div class="sasSource">1697  left join</div><div class="sasSource">1698  public.ia_promo_x_pbo_leaf as t2</div><div class="sasSource">1699  on</div><div class="sasSource">1700  t1.PROMO_ID = t2.PROMO_ID</div><div class="sasSource">1701  left join</div><div class="sasSource">1702  public.ia_promo_x_product_leaf as t3</div><div class="sasSource">1703  on</div><div class="sasSource">1704  t1.PROMO_ID = t3.PROMO_ID</div><div class="sasSource">1705  inner join</div><div class="sasSource">1706  public.promo_mech_transformation as t4</div><div class="sasSource">1707  on t1.promo_mechanics = t4.old_mechanic</div><div class="sasSource">1708  ;</div><div class="sasSource">ERROR: Table "PUBLIC.IA_PROMO" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError26_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasSource">1709  quit;</div><div class="sasNote" id="sasLogNote389_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.16 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              97.71k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:26 AM</div><div class="sasNote">      Step Count                        95  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        60</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">1710  /* Генерим макропеременные для вставки в код */</div><div class="sasSource">1711  data _null_;</div><div class="sasSource">1712  set public.promo_ml end=end;</div><div class="sasNote" id="sasLogNote390_1620885733386">NOTE: The table PUBLIC.PROMO_ML does not exist in Cloud Analytic Services.</div><div class="sasError" id="sasLogError27_1620885733386">ERROR: File PUBLIC.PROMO_ML.DATA does not exist.</div><div class="sasSource">1713  length sql_list sql_max_list model_list $1000;</div><div class="sasSource">1714  retain sql_list model_list sql_max_list;</div><div class="sasSource">1715  by promo_mechanics_name;</div><div class="sasSource">1716  if _n_ = 1 then do;</div><div class="sasSource">1717  sql_list = cats('t1.', promo_mechanics_name);</div><div class="sasSource">1718  model_list = promo_mechanics_name;</div><div class="sasSource">1719  sql_max_list = cat('max(coalesce(t2.', strip(promo_mechanics_name), ', 0)) as ', strip(promo_mechanics_name));</div><div class="sasSource">1720  end;</div><div class="sasSource">1721  else if first.promo_mechanics_name then do;</div><div class="sasSource">1722  sql_list = cats(sql_list, ', t1.', promo_mechanics_name);</div><div class="sasSource">1723  model_list = catx('', model_list, promo_mechanics_name);</div><div class="sasSource">1724  sql_max_list = cat(strip(sql_max_list), ', max(coalesce(t2.', strip(promo_mechanics_name), ', 0)) as ',</div><div class="sasSource">1724! strip(promo_mechanics_name));</div><div class="sasSource">1725  end;</div><div class="sasSource">1726  if end then do;</div><div class="sasSource">1727  /* put model_list; */</div><div class="sasSource">1728  call symputx('promo_list_sql', sql_list, 'G');</div><div class="sasSource">1729  call symputx('promo_list_model', model_list, 'G');</div><div class="sasSource">1730  call symputx('promo_list_sql_max', sql_max_list, 'G');</div><div class="sasSource">1731  end;</div><div class="sasSource">1732  run;</div><div class="sasNote" id="sasLogNote391_1620885733386">NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).</div><div class="sasNote">      1718:16    1719:48    1719:90    1724:71    1724:113   </div><div class="sasNote" id="sasLogNote392_1620885733386">NOTE: The SAS System stopped processing this step because of errors.</div><div class="sasNote" id="sasLogNote393_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.01 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              339.25k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:26 AM</div><div class="sasNote">      Step Count                        96  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     20</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasWarning" id="sasLogWarning3_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">1733  %put &amp;promo_list_sql.;</div><div class="sasSource">&amp;promo_list_sql.</div><div class="sasSource">1734  %put &amp;promo_list_model.;</div><div class="sasWarning" id="sasLogWarning4_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_MODEL not resolved.</div><div class="sasSource">&amp;promo_list_model.</div><div class="sasSource">1735  %put &amp;promo_list_sql_max.;</div><div class="sasWarning" id="sasLogWarning5_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL_MAX not resolved.</div><div class="sasSource">&amp;promo_list_sql_max.</div><div class="sasSource">1736  </div><div class="sasSource">1737  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote394_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1738  create table public.promo_ml_main_code{options replace = true} as</div><div class="sasSource">1739  select distinct</div><div class="sasSource">1740  (MOD(t2.LVL4_ID, 10000)) AS product_MAIN_CODE,</div><div class="sasSource">1741  t1.PBO_LEAF_ID,</div><div class="sasSource">1742  datepart(t1.START_DT) as start_dt,</div><div class="sasSource">1743  datepart(t1.END_DT) as end_dt,</div><div class="sasSource">1744  t1.CHANNEL_CD,</div><div class="sasSource">1745  case</div><div class="sasSource">1746  when product_LEAF_ID = MOD(t2.LVL4_ID, 10000) then 0</div><div class="sasSource">1747  else 1</div><div class="sasSource">1748  end as side_promo_flag</div><div class="sasSource">1749  </div><div class="sasSource">1750  from</div><div class="sasSource">1751  public.promo_ml as t1</div><div class="sasSource">1752  left join</div><div class="sasSource">1753  public.product_hier_flat as t2</div><div class="sasSource">1754  on</div><div class="sasSource">1755  t1.product_LEAF_ID = t2.product_id</div><div class="sasSource">1756  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote395_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.PROMO_ML" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError28_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote396_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">1757  quit;</div><div class="sasNote" id="sasLogNote397_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.15k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:26 AM</div><div class="sasNote">      Step Count                        97  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        27</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1758  /* транспонируем таблицу с промо по типам промо механк */</div><div class="sasSource">1759  proc cas;</div><div class="sasSource">1760  transpose.transpose /</div><div class="sasSource">1761  table = {</div><div class="sasSource">1762  name="promo_ml",</div><div class="sasSource">1763  caslib="public",</div><div class="sasSource">1764  groupby={"promo_id", "product_LEAF_ID", "PBO_LEAF_ID", "CHANNEL_CD", "START_DT", "END_DT", "NP_GIFT_PRICE_AMT"}}</div><div class="sasSource">1765  transpose={"promo_flag"}</div><div class="sasSource">1766  id={"promo_mechanics_name"}</div><div class="sasSource">1767  casout={name="promo_transposed", caslib="public", replace=true};</div><div class="sasSource">1768  quit;</div><div class="sasNote" id="sasLogNote398_1620885733386">NOTE: Active Session now CASAUTO.</div><div class="sasError" id="sasLogError29_1620885733386">ERROR: The file or path 'promo_ml' is not available in the file system.</div><div class="sasError" id="sasLogError30_1620885733386">ERROR: Table 'promo_ml' could not be loaded.</div><div class="sasError" id="sasLogError31_1620885733386">ERROR: Failure opening table 'promo_ml': A table could not be loaded.</div><div class="sasError" id="sasLogError32_1620885733386">ERROR: The action stopped due to errors.</div><div class="sasNote" id="sasLogNote399_1620885733386">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10003.71k</div><div class="sasNote">      OS Memory           45440.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:26 AM</div><div class="sasNote">      Step Count                        98  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     983</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        10</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasWarning" id="sasLogWarning6_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasWarning" id="sasLogWarning7_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">1769  %let promo_list_sql_t2 = %sysfunc(tranwrd(%quote(&amp;promo_list_sql.),%str(t1),%str(t2)));</div><div class="sasSource">1770  %put &amp;promo_list_sql_t2.;</div><div class="sasWarning" id="sasLogWarning8_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">&amp;promo_list_sql.</div><div class="sasSource">1771  /* Соединяем с витриной */</div><div class="sasSource">1772  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote400_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1773  /* Подготавливаем таблицу для джойна с витриной */</div><div class="sasSource">1774  create table public.abt_promo{options replace = true} as</div><div class="sasSource">1775  select</div><div class="sasSource">1776  t1.PBO_LOCATION_ID,</div><div class="sasSource">1777  t1.PRODUCT_ID,</div><div class="sasSource">1778  t1.CHANNEL_CD,</div><div class="sasSource">1779  t1.SALES_DT,</div><div class="sasSource">1780  &amp;promo_list_sql_max.,</div><div class="sasWarning" id="sasLogWarning9_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL_MAX not resolved.</div><div class="sasSource">1781  max(coalesce(t2.NP_GIFT_PRICE_AMT, .)) as NP_GIFT_PRICE_AMT,</div><div class="sasSource">1782  max(coalesce(t3.side_promo_flag, 0)) as side_promo_flag</div><div class="sasSource">1783  from</div><div class="sasSource">1784  public.abt5_ml as t1</div><div class="sasSource">1785  left join</div><div class="sasSource">1786  public.promo_transposed as t2</div><div class="sasSource">1787  on</div><div class="sasSource">1788  t1.product_id = t2.product_LEAF_ID</div><div class="sasSource">1789  and t1.pbo_location_id = t2.PBO_LEAF_ID</div><div class="sasSource">1790  and t1.SALES_DT &lt;= t2.END_DT</div><div class="sasSource">1791  and t1.SALES_DT &gt;= t2.START_DT</div><div class="sasSource">1792  /* and t1.CHANNEL_CD = t2.CHANNEL_CD */</div><div class="sasSource">1793  left join</div><div class="sasSource">1794  public.promo_ml_main_code as t3</div><div class="sasSource">1795  on</div><div class="sasSource">1796  t1.product_id = t3.product_MAIN_CODE and</div><div class="sasSource">1797  t1.pbo_location_id = t3.PBO_LEAF_ID and</div><div class="sasSource">1798  t1.SALES_DT &lt;= t3.END_DT and</div><div class="sasSource">1799  t1.SALES_DT &gt;= t3.START_DT</div><div class="sasSource">1800  group by</div><div class="sasSource">1801  t1.PBO_LOCATION_ID,</div><div class="sasSource">1802  t1.PRODUCT_ID,</div><div class="sasSource">1803  t1.CHANNEL_CD,</div><div class="sasSource">1804  t1.SALES_DT</div><div class="sasSource">1805  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote401_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Syntax error at or near "PROMO_LIST_SQL_MAX."</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError33_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote402_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">1806  /* Добавляем промо к витрине */</div><div class="sasSource">1807  create table public.abt6_ml{options replace = true} as</div><div class="sasSource">1808  select</div><div class="sasSource">1809  t1.PBO_LOCATION_ID,</div><div class="sasSource">1810  t1.PRODUCT_ID,</div><div class="sasSource">1811  t1.CHANNEL_CD,</div><div class="sasSource">1812  t1.SALES_DT,</div><div class="sasSource">1813  t1.sum_qty,</div><div class="sasSource">1814  t1.GROSS_PRICE_AMT,</div><div class="sasSource">1815  t1.lag_halfyear_avg,</div><div class="sasSource">1816  t1.lag_halfyear_med,</div><div class="sasSource">1817  t1.lag_month_avg,</div><div class="sasSource">1818  t1.lag_month_med,</div><div class="sasSource">1819  t1.lag_qtr_avg,</div><div class="sasSource">1820  t1.lag_qtr_med,</div><div class="sasSource">1821  t1.lag_week_avg,</div><div class="sasSource">1822  t1.lag_week_med,</div><div class="sasSource">1823  t1.lag_year_avg,</div><div class="sasSource">1824  t1.lag_year_med,</div><div class="sasSource">1825  t1.lag_halfyear_std,</div><div class="sasSource">1826  t1.lag_month_std,</div><div class="sasSource">1827  t1.lag_qtr_std,</div><div class="sasSource">1828  t1.lag_week_std,</div><div class="sasSource">1829  t1.lag_year_std,</div><div class="sasSource">1830  t1.lag_halfyear_pct10,</div><div class="sasSource">1831  t1.lag_halfyear_pct90,</div><div class="sasSource">1832  t1.lag_month_pct10,</div><div class="sasSource">1833  t1.lag_month_pct90,</div><div class="sasSource">1834  t1.lag_qtr_pct10,</div><div class="sasSource">1835  t1.lag_qtr_pct90,</div><div class="sasSource">1836  t1.lag_week_pct10,</div><div class="sasSource">1837  t1.lag_week_pct90,</div><div class="sasSource">1838  t1.lag_year_pct10,</div><div class="sasSource">1839  t1.lag_year_pct90,</div><div class="sasSource">1840  &amp;promo_list_sql_t2.,</div><div class="sasWarning" id="sasLogWarning10_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">1841  t2.NP_GIFT_PRICE_AMT,</div><div class="sasSource">1842   t2.side_promo_flag</div><div class="sasSource">1843  from</div><div class="sasSource">1844  public.abt5_ml as t1</div><div class="sasSource">1845  left join</div><div class="sasSource">1846  public.abt_promo as t2</div><div class="sasSource">1847  on</div><div class="sasSource">1848  t1.product_id = t2.product_id and</div><div class="sasSource">1849  t1.pbo_location_id = t2.pbo_location_id and</div><div class="sasSource">1850  t1.SALES_DT = t2.SALES_DT and</div><div class="sasSource">1851  t1.CHANNEL_CD = t2.CHANNEL_CD</div><div class="sasSource">1852  ;</div><div class="sasSource">ERROR: Syntax error at or near "PROMO_LIST_SQL."</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError34_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasSource">1853  quit;</div><div class="sasNote" id="sasLogNote403_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              214.56k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:26 AM</div><div class="sasNote">      Step Count                        99  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        42</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">1854  proc casutil;</div><div class="sasNote" id="sasLogNote404_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">1855  /* promote casdata="abt6_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">1856  /* promote casdata="pbo_lvl_all" incaslib="public" outcaslib="public"; */</div><div class="sasSource">1857  /* promote casdata="product_lvl_all" incaslib="public" outcaslib="public"; */</div><div class="sasSource">1858    </div><div class="sasSource">1858!    promote casdata="promo_ml" incaslib="public" outcaslib="public";</div><div class="sasError" id="sasLogError35_1620885733386">ERROR: There is no session-scope table promo_ml in caslib Public of Cloud Analytic Services.</div><div class="sasError" id="sasLogError36_1620885733386">ERROR: The action stopped due to errors.</div><div class="sasNote" id="sasLogNote405_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.010175 seconds.</div><div class="sasSource">1859  </div><div class="sasSource">1859!  droptable casdata="pbo_hier_flat" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote406_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.009476 seconds.</div><div class="sasSource">1860  </div><div class="sasSource">1860!  droptable casdata="product_hier_flat" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote407_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01032 seconds.</div><div class="sasSource">1861  </div><div class="sasSource">1861!  droptable casdata="lvl5" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote408_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.009188 seconds.</div><div class="sasSource">1862  </div><div class="sasSource">1862!  droptable casdata="lvl4" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote409_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.009372 seconds.</div><div class="sasSource">1863  </div><div class="sasSource">1863!  droptable casdata="lvl3" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote410_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.009542 seconds.</div><div class="sasSource">1864  </div><div class="sasSource">1864!  droptable casdata="lvl2" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote411_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.009734 seconds.</div><div class="sasSource">1865  </div><div class="sasSource">1865!  droptable casdata="lvl1" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote412_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.009733 seconds.</div><div class="sasSource">1866    </div><div class="sasSource">1866!    droptable casdata="ia_pbo_loc_hierarchy" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote413_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01114 seconds.</div><div class="sasSource">1867    </div><div class="sasSource">1867!    droptable casdata="ia_product_hierarchy" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote414_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.011839 seconds.</div><div class="sasSource">1868    </div><div class="sasSource">1868!    droptable casdata="ia_promo_x_pbo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote415_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.018555 seconds.</div><div class="sasSource">1869    </div><div class="sasSource">1869!    droptable casdata="ia_promo_x_product" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote416_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016626 seconds.</div><div class="sasSource">1870    </div><div class="sasSource">1870!    droptable casdata="promo_transposed" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote417_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015564 seconds.</div><div class="sasSource">1871    </div><div class="sasSource">1871!    droptable casdata="ia_promo_x_product_leaf" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote418_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016652 seconds.</div><div class="sasSource">1872    </div><div class="sasSource">1872!    droptable casdata="ia_promo_x_pbo_leaf" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote419_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015495 seconds.</div><div class="sasSource">1873    </div><div class="sasSource">1873!    droptable casdata="promo_ml_main_code" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote420_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01829 seconds.</div><div class="sasSource">1874    </div><div class="sasSource">1874!    droptable casdata="abt_promo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote421_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01836 seconds.</div><div class="sasSource">1875      droptable casdata="abt5_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote422_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.020757 seconds.</div><div class="sasSource">1876  run;</div><div class="sasSource">1877  /****** 7. Добавляем макроэкономику ******/</div><div class="sasNote" id="sasLogNote423_1620885733386">NOTE: The SAS System stopped processing this step because of errors.</div><div class="sasNote" id="sasLogNote424_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.42 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              241.50k</div><div class="sasNote">      OS Memory           35604.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:27 AM</div><div class="sasNote">      Step Count                        100  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     8</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        127</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">1878  proc casutil;</div><div class="sasNote" id="sasLogNote425_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">1879    droptable casdata="macro_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote426_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.018537 seconds.</div><div class="sasSource">1880    droptable casdata="macro2_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote427_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016068 seconds.</div><div class="sasSource">1881    droptable casdata="macro_transposed_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote428_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016866 seconds.</div><div class="sasSource">1882    droptable casdata="abt7_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote429_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.019365 seconds.</div><div class="sasSource">1883    load data=&amp;inlib..IA_macro_factor casout='ia_macro' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote430_1620885733386">NOTE: IA.IA_MACRO_FACTOR was successfully added to the "Public" caslib as "IA_MACRO".</div><div class="sasSource">1884  run;</div><div class="sasNote" id="sasLogNote431_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.19 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              2108.96k</div><div class="sasNote">      OS Memory           37180.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:27 AM</div><div class="sasNote">      Step Count                        101  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     105</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        51</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1885  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote432_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1886  create table public.macro_ml{options replace=true} as</div><div class="sasSource">1887  select</div><div class="sasSource">1888  factor_cd,</div><div class="sasSource">1889  datepart(cast(REPORT_DT as timestamp)) as period_dt,</div><div class="sasSource">1890  FACTOR_CHNG_PCT</div><div class="sasSource">1891  from public.ia_macro;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote433_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table MACRO_ML was created in caslib Public with 48 rows returned.</div><div class="sasNote" id="sasLogNote434_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1892  quit;</div><div class="sasNote" id="sasLogNote435_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.31k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:27 AM</div><div class="sasNote">      Step Count                        102  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        28</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1893  data public.macro2_ml;</div><div class="sasSource">1894    format period_dt date9.;</div><div class="sasSource">1895    drop pdt;</div><div class="sasSource">1896    set public.macro_ml(rename=(period_dt=pdt));</div><div class="sasSource">1897    by factor_cd pdt;</div><div class="sasSource">1898    factor_cd=substr(factor_cd,1,3);</div><div class="sasSource">1899    period_dt=pdt;</div><div class="sasSource">1900    do until (period_dt&gt;=intnx('day',intnx('month',pdt,3,'b'),0,'b'));</div><div class="sasSource">1901      output;</div><div class="sasSource">1902      period_dt=intnx('day',period_dt,1,'b');</div><div class="sasSource">1903    end;</div><div class="sasSource">1904  run;</div><div class="sasNote" id="sasLogNote436_1620885733386">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote437_1620885733386">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote438_1620885733386">NOTE: There were 48 observations read from the table MACRO_ML in caslib Public.</div><div class="sasNote" id="sasLogNote439_1620885733386">NOTE: The table macro2_ml in caslib Public has 4383 observations and 3 variables.</div><div class="sasNote" id="sasLogNote440_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.20 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1393.34k</div><div class="sasNote">      OS Memory           36888.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:27 AM</div><div class="sasNote">      Step Count                        103  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     23</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        87</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1905  proc cas;</div><div class="sasSource">1906  transpose.transpose /</div><div class="sasSource">1907     table={name="macro2_ml", caslib="public", groupby={"period_dt"}}</div><div class="sasSource">1908     attributes={{name="period_dt"}}</div><div class="sasSource">1909     transpose={"FACTOR_CHNG_PCT"}</div><div class="sasSource">1910     prefix="A_"</div><div class="sasSource">1911     id={"factor_cd"}</div><div class="sasSource">1912     casout={name="macro_transposed_ml", caslib="public", replace=true};</div><div class="sasSource">1913  quit;</div><div class="sasNote" id="sasLogNote441_1620885733386">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote442_1620885733386">NOTE: There were 4383 rows read from the table MACRO2_ML.</div><div class="sasNote" id="sasLogNote443_1620885733386">NOTE: The table macro_transposed_ml has 1461 rows and 6 columns.</div><div class="sasNote" id="sasLogNote444_1620885733386">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.08 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10036.53k</div><div class="sasNote">      OS Memory           45696.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:27 AM</div><div class="sasNote">      Step Count                        104  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     981</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        15</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1914  /* Соединяем с ABT */</div><div class="sasSource">1915  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote445_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1916  create table public.abt7_ml{options replace = true} as</div><div class="sasSource">1917  select</div><div class="sasSource">1918  t1.PBO_LOCATION_ID,</div><div class="sasSource">1919  t1.PRODUCT_ID,</div><div class="sasSource">1920  t1.CHANNEL_CD,</div><div class="sasSource">1921  t1.SALES_DT,</div><div class="sasSource">1922  t1.sum_qty,</div><div class="sasSource">1923  t1.GROSS_PRICE_AMT,</div><div class="sasSource">1924  t1.lag_halfyear_avg,</div><div class="sasSource">1925  t1.lag_halfyear_med,</div><div class="sasSource">1926  t1.lag_month_avg,</div><div class="sasSource">1927  t1.lag_month_med,</div><div class="sasSource">1928  t1.lag_qtr_avg,</div><div class="sasSource">1929  t1.lag_qtr_med,</div><div class="sasSource">1930  t1.lag_week_avg,</div><div class="sasSource">1931  t1.lag_week_med,</div><div class="sasSource">1932  t1.lag_year_avg,</div><div class="sasSource">1933  t1.lag_year_med,</div><div class="sasSource">1934  t1.lag_halfyear_std,</div><div class="sasSource">1935  t1.lag_month_std,</div><div class="sasSource">1936  t1.lag_qtr_std,</div><div class="sasSource">1937  t1.lag_week_std,</div><div class="sasSource">1938  t1.lag_year_std,</div><div class="sasSource">1939  t1.lag_halfyear_pct10,</div><div class="sasSource">1940  t1.lag_halfyear_pct90,</div><div class="sasSource">1941  t1.lag_month_pct10,</div><div class="sasSource">1942  t1.lag_month_pct90,</div><div class="sasSource">1943  t1.lag_qtr_pct10,</div><div class="sasSource">1944  t1.lag_qtr_pct90,</div><div class="sasSource">1945  t1.lag_week_pct10,</div><div class="sasSource">1946  t1.lag_week_pct90,</div><div class="sasSource">1947  t1.lag_year_pct10,</div><div class="sasSource">1948  t1.lag_year_pct90,</div><div class="sasSource">1949  &amp;promo_list_sql.,</div><div class="sasWarning" id="sasLogWarning11_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">1950   t1.NP_GIFT_PRICE_AMT,</div><div class="sasSource">1951  t1.side_promo_flag,</div><div class="sasSource">1952  t2.A_CPI,</div><div class="sasSource">1953  t2.A_GPD,</div><div class="sasSource">1954  t2.A_RDI</div><div class="sasSource">1955  from</div><div class="sasSource">1956  public.abt6_ml as t1 left join</div><div class="sasSource">1957  public.macro_transposed_ml as t2</div><div class="sasSource">1958  on</div><div class="sasSource">1959  t1.sales_dt = t2.period_dt</div><div class="sasSource">1960  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote446_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Syntax error at or near "PROMO_LIST_SQL."</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError37_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote447_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">1961  quit;</div><div class="sasNote" id="sasLogNote448_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              216.06k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:27 AM</div><div class="sasNote">      Step Count                        105  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        27</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1962  proc casutil;</div><div class="sasNote" id="sasLogNote449_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">1963    droptable casdata="macro_transposed_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote450_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.010926 seconds.</div><div class="sasSource">1964    droptable casdata="macro2_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote451_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.010315 seconds.</div><div class="sasSource">1965    droptable casdata="ia_macro" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote452_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.010622 seconds.</div><div class="sasSource">1966    droptable casdata="macro_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote453_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.010585 seconds.</div><div class="sasSource">1967    droptable casdata="abt6_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote454_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.018175 seconds.</div><div class="sasSource">1968  /*   promote casdata="abt7_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">1969  run;</div><div class="sasSource">1970  /***** 8. Добавляем погоду. *****/</div><div class="sasNote" id="sasLogNote455_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.10 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              117.06k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:27 AM</div><div class="sasNote">      Step Count                        106  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1971  proc casutil;</div><div class="sasNote" id="sasLogNote456_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">1972    load data=&amp;inlib..ia_weather casout = 'ia_weather' outcaslib = 'public' replace;</div><div class="sasNote" id="sasLogNote457_1620885733386">NOTE: IA.IA_WEATHER was successfully added to the "Public" caslib as "IA_WEATHER".</div><div class="sasSource">1973    droptable casdata = "abt8_ml" incaslib = "public" quiet;</div><div class="sasNote" id="sasLogNote458_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016803 seconds.</div><div class="sasSource">1974  run;</div><div class="sasNote" id="sasLogNote459_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           29.10 seconds</div><div class="sasNote">      user cpu time       1.52 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              2420.46k</div><div class="sasNote">      OS Memory           37700.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:56 AM</div><div class="sasNote">      Step Count                        107  Switch Count  695</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     17856</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        13384</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">1975  proc fedsql sessref =casauto;</div><div class="sasNote" id="sasLogNote460_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1976  create table public.abt8_ml{options replace = true} as</div><div class="sasSource">1977  select</div><div class="sasSource">1978  t1.PBO_LOCATION_ID,</div><div class="sasSource">1979  t1.PRODUCT_ID,</div><div class="sasSource">1980  t1.CHANNEL_CD,</div><div class="sasSource">1981  t1.SALES_DT,</div><div class="sasSource">1982  t1.sum_qty,</div><div class="sasSource">1983  t1.GROSS_PRICE_AMT,</div><div class="sasSource">1984  t1.lag_halfyear_avg,</div><div class="sasSource">1985  t1.lag_halfyear_med,</div><div class="sasSource">1986  t1.lag_month_avg,</div><div class="sasSource">1987  t1.lag_month_med,</div><div class="sasSource">1988  t1.lag_qtr_avg,</div><div class="sasSource">1989  t1.lag_qtr_med,</div><div class="sasSource">1990  t1.lag_week_avg,</div><div class="sasSource">1991  t1.lag_week_med,</div><div class="sasSource">1992  t1.lag_year_avg,</div><div class="sasSource">1993  t1.lag_year_med,</div><div class="sasSource">1994  t1.lag_halfyear_std,</div><div class="sasSource">1995  t1.lag_month_std,</div><div class="sasSource">1996  t1.lag_qtr_std,</div><div class="sasSource">1997  t1.lag_week_std,</div><div class="sasSource">1998  t1.lag_year_std,</div><div class="sasSource">1999  t1.lag_halfyear_pct10,</div><div class="sasSource">2000  t1.lag_halfyear_pct90,</div><div class="sasSource">2001  t1.lag_month_pct10,</div><div class="sasSource">2002  t1.lag_month_pct90,</div><div class="sasSource">2003  t1.lag_qtr_pct10,</div><div class="sasSource">2004  t1.lag_qtr_pct90,</div><div class="sasSource">2005  t1.lag_week_pct10,</div><div class="sasSource">2006  t1.lag_week_pct90,</div><div class="sasSource">2007  t1.lag_year_pct10,</div><div class="sasSource">2008  t1.lag_year_pct90,</div><div class="sasSource">2009  &amp;promo_list_sql.,</div><div class="sasWarning" id="sasLogWarning12_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">2010   t1.NP_GIFT_PRICE_AMT,</div><div class="sasSource">2011  t1.side_promo_flag,</div><div class="sasSource">2012  t1.A_CPI,</div><div class="sasSource">2013  t1.A_GPD,</div><div class="sasSource">2014  t1.A_RDI,</div><div class="sasSource">2015  t2.TEMPERATURE,</div><div class="sasSource">2016  t2.PRECIPITATION</div><div class="sasSource">2017  from</div><div class="sasSource">2018  public.abt7_ml as t1</div><div class="sasSource">2019  left join</div><div class="sasSource">2020  public.ia_weather as t2</div><div class="sasSource">2021  on</div><div class="sasSource">2022  t1.pbo_location_id = t2.pbo_location_id and</div><div class="sasSource">2023  t1.sales_dt = datepart(t2.REPORT_DT)</div><div class="sasSource">2024  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote461_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Syntax error at or near "PROMO_LIST_SQL."</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError38_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote462_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">2025  quit;</div><div class="sasNote" id="sasLogNote463_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              217.56k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:57 AM</div><div class="sasNote">      Step Count                        108  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        27</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">2026  proc casutil;</div><div class="sasNote" id="sasLogNote464_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2027    droptable casdata="ia_weather" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote465_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.0207 seconds.</div><div class="sasSource">2028    droptable casdata="abt7_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote466_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01488 seconds.</div><div class="sasSource">2029  /*   promote casdata="abt8_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2030  run;</div><div class="sasSource">2031  /***** 9. Добавляем trp конкурентов *****/</div><div class="sasNote" id="sasLogNote467_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.65k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:57 AM</div><div class="sasNote">      Step Count                        109  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        10</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2032  proc casutil;</div><div class="sasNote" id="sasLogNote468_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2033  </div><div class="sasSource">2033!  droptable casdata="comp_media_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote469_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.013936 seconds.</div><div class="sasSource">2034  </div><div class="sasSource">2034!  droptable casdata="abt9_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote470_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015265 seconds.</div><div class="sasSource">2035  </div><div class="sasSource">2035!  load data=&amp;inlib..IA_comp_media casout='ia_comp_media' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote471_1620885733386">NOTE: IA.IA_COMP_MEDIA was successfully added to the "Public" caslib as "IA_COMP_MEDIA".</div><div class="sasSource">2036  run;</div><div class="sasNote" id="sasLogNote472_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              2106.34k</div><div class="sasNote">      OS Memory           37180.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:57 AM</div><div class="sasNote">      Step Count                        110  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     82</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        36</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2037  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote473_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2038  create table public.comp_media_ml{options replace=true} as</div><div class="sasSource">2039  select</div><div class="sasSource">2040  COMPETITOR_CD,</div><div class="sasSource">2041  TRP,</div><div class="sasSource">2042  datepart(cast(report_dt as timestamp)) as report_dt</div><div class="sasSource">2043  from</div><div class="sasSource">2044  public.IA_COMP_MEDIA</div><div class="sasSource">2045  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote474_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table COMP_MEDIA_ML was created in caslib Public with 312 rows returned.</div><div class="sasNote" id="sasLogNote475_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2046  quit;</div><div class="sasNote" id="sasLogNote476_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.31k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:57 AM</div><div class="sasNote">      Step Count                        111  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        28</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2047  /* Транспонируем таблицу */</div><div class="sasSource">2048  proc cas;</div><div class="sasSource">2049  transpose.transpose /</div><div class="sasSource">2050     table={name="comp_media_ml", caslib="public", groupby={"REPORT_DT"}}</div><div class="sasSource">2051     transpose={"TRP"}</div><div class="sasSource">2052     prefix="comp_trp_"</div><div class="sasSource">2053     id={"COMPETITOR_CD"}</div><div class="sasSource">2054     casout={name="comp_transposed_ml", caslib="public", replace=true};</div><div class="sasSource">2055  quit;</div><div class="sasNote" id="sasLogNote477_1620885733386">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote478_1620885733386">NOTE: There were 312 rows read from the table COMP_MEDIA_ML.</div><div class="sasNote" id="sasLogNote479_1620885733386">NOTE: The table comp_transposed_ml has 168 rows and 5 columns.</div><div class="sasNote" id="sasLogNote480_1620885733386">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10002.50k</div><div class="sasNote">      OS Memory           45696.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:57 AM</div><div class="sasNote">      Step Count                        112  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     981</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        15</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2056  /* Протягиваем trp на всю неделю вперед */</div><div class="sasSource">2057  data public.comp_transposed_ml_expand;</div><div class="sasSource">2058  set public.comp_transposed_ml;</div><div class="sasSource">2059  by REPORT_DT;</div><div class="sasSource">2060  do i = 1 to 7;</div><div class="sasSource">2061     output;</div><div class="sasSource">2062     REPORT_DT + 1;</div><div class="sasSource">2063  end;</div><div class="sasSource">2064  run;</div><div class="sasNote" id="sasLogNote481_1620885733386">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote482_1620885733386">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote483_1620885733386">NOTE: There were 168 observations read from the table COMP_TRANSPOSED_ML in caslib Public.</div><div class="sasNote" id="sasLogNote484_1620885733386">NOTE: The table comp_transposed_ml_expand in caslib Public has 1176 observations and 6 variables.</div><div class="sasNote" id="sasLogNote485_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.25 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1378.46k</div><div class="sasNote">      OS Memory           36888.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:57 AM</div><div class="sasNote">      Step Count                        113  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        86</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2065  /*</div><div class="sasSource">2066  Пока в данных есть ошибка, все интевалы report_dt указаны</div><div class="sasSource">2067  с интервалом в неделю, но есть одно наблюдение</div><div class="sasSource">2068  в котором этот порядок рушится 16dec2019 и 22dec2019 (6 Дней)</div><div class="sasSource">2069  Поэтому, пока в таблице есть дубль, который мы убираем путем</div><div class="sasSource">2069! усреднения</div><div class="sasSource">2070  */</div><div class="sasSource">2071  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote486_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2072  create table public.comp_transposed_ml_expand{options replace=true} as</div><div class="sasSource">2073  select</div><div class="sasSource">2074  REPORT_DT,</div><div class="sasSource">2075  mean(comp_trp_BK) as comp_trp_BK,</div><div class="sasSource">2076  mean(comp_trp_KFC) as comp_trp_KFC</div><div class="sasSource">2077  from</div><div class="sasSource">2078  public.comp_transposed_ml_expand</div><div class="sasSource">2079  group by report_dt</div><div class="sasSource">2080  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote487_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table COMP_TRANSPOSED_ML_EXPAND was created in caslib Public with 1176 rows returned.</div><div class="sasNote" id="sasLogNote488_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2081  quit;</div><div class="sasNote" id="sasLogNote489_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.18 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.75k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:57 AM</div><div class="sasNote">      Step Count                        114  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        29</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2082  /* Соединяем с ABT */</div><div class="sasSource">2083  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote490_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2084  create table public.abt9_ml{options replace=true} as</div><div class="sasSource">2085  select</div><div class="sasSource">2086  t1.PBO_LOCATION_ID,</div><div class="sasSource">2087  t1.PRODUCT_ID,</div><div class="sasSource">2088  t1.CHANNEL_CD,</div><div class="sasSource">2089  t1.SALES_DT,</div><div class="sasSource">2090  t1.sum_qty,</div><div class="sasSource">2091  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2092  t1.lag_halfyear_avg,</div><div class="sasSource">2093  t1.lag_halfyear_med,</div><div class="sasSource">2094  t1.lag_month_avg,</div><div class="sasSource">2095  t1.lag_month_med,</div><div class="sasSource">2096  t1.lag_qtr_avg,</div><div class="sasSource">2097  t1.lag_qtr_med,</div><div class="sasSource">2098  t1.lag_week_avg,</div><div class="sasSource">2099  t1.lag_week_med,</div><div class="sasSource">2100  t1.lag_year_avg,</div><div class="sasSource">2101  t1.lag_year_med,</div><div class="sasSource">2102  t1.lag_halfyear_std,</div><div class="sasSource">2103  t1.lag_month_std,</div><div class="sasSource">2104  t1.lag_qtr_std,</div><div class="sasSource">2105  t1.lag_week_std,</div><div class="sasSource">2106  t1.lag_year_std,</div><div class="sasSource">2107  t1.lag_halfyear_pct10,</div><div class="sasSource">2108  t1.lag_halfyear_pct90,</div><div class="sasSource">2109  t1.lag_month_pct10,</div><div class="sasSource">2110  t1.lag_month_pct90,</div><div class="sasSource">2111  t1.lag_qtr_pct10,</div><div class="sasSource">2112  t1.lag_qtr_pct90,</div><div class="sasSource">2113  t1.lag_week_pct10,</div><div class="sasSource">2114  t1.lag_week_pct90,</div><div class="sasSource">2115  t1.lag_year_pct10,</div><div class="sasSource">2116  t1.lag_year_pct90,</div><div class="sasSource">2117  &amp;promo_list_sql.,</div><div class="sasWarning" id="sasLogWarning13_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">2118   t1.NP_GIFT_PRICE_AMT,</div><div class="sasSource">2119  t1.side_promo_flag,</div><div class="sasSource">2120  t1.A_CPI,</div><div class="sasSource">2121  t1.A_GPD,</div><div class="sasSource">2122  t1.A_RDI,</div><div class="sasSource">2123  t1.TEMPERATURE,</div><div class="sasSource">2124  t1.PRECIPITATION,</div><div class="sasSource">2125  t2.comp_trp_BK,</div><div class="sasSource">2126  t2.comp_trp_KFC</div><div class="sasSource">2127  from</div><div class="sasSource">2128  public.abt8_ml as t1</div><div class="sasSource">2129  left join</div><div class="sasSource">2130  public.comp_transposed_ml_expand as t2</div><div class="sasSource">2131  on</div><div class="sasSource">2132  t1.sales_dt = t2.REPORT_DT</div><div class="sasSource">2133  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote491_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Syntax error at or near "PROMO_LIST_SQL."</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError39_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote492_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">2134  quit;</div><div class="sasNote" id="sasLogNote493_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              217.56k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:57 AM</div><div class="sasNote">      Step Count                        115  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2135  proc casutil;</div><div class="sasNote" id="sasLogNote494_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2136  </div><div class="sasSource">2136!  droptable casdata='ia_comp_media' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote495_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.008704 seconds.</div><div class="sasSource">2137  </div><div class="sasSource">2137!  droptable casdata='comp_media_ml' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote496_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.00929 seconds.</div><div class="sasSource">2138  </div><div class="sasSource">2138!  droptable casdata='comp_transposed_ml' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote497_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016964 seconds.</div><div class="sasSource">2139  </div><div class="sasSource">2139!  droptable casdata='comp_transposed_ml_expand' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote498_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.011105 seconds.</div><div class="sasSource">2140    droptable casdata="abt8_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote499_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.017521 seconds.</div><div class="sasSource">2141  /* promote casdata="abt9_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2142  run;</div><div class="sasSource">2143  /***** 10. Добавляем медиаподдержку *****/</div><div class="sasNote" id="sasLogNote500_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.10 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              117.06k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:58 AM</div><div class="sasNote">      Step Count                        116  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2144  proc casutil;</div><div class="sasNote" id="sasLogNote501_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2145    droptable casdata="media_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote502_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016573 seconds.</div><div class="sasSource">2146    droptable casdata="abt10_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote503_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015351 seconds.</div><div class="sasSource">2147    load data=&amp;inlib..media_enh casout='ia_media' outcaslib='public' replace;</div><div class="sasError" id="sasLogError40_1620885733386">ERROR: File IA.MEDIA_ENH.DATA does not exist.</div><div class="sasSource">2148    load data=&amp;inlib..promo_enh casout='ia_promo' outcaslib='public' replace;</div><div class="sasError" id="sasLogError41_1620885733386">ERROR: File IA.PROMO_ENH.DATA does not exist.</div><div class="sasSource">2149    load data=&amp;inlib..promo_product_enh casout='ia_promo_x_product' outcaslib='public' replace;</div><div class="sasError" id="sasLogError42_1620885733386">ERROR: File IA.PROMO_PRODUCT_ENH.DATA does not exist.</div><div class="sasSource">2150    load data=&amp;inlib..promo_pbo_enh casout='ia_promo_x_pbo' outcaslib='public' replace;</div><div class="sasError" id="sasLogError43_1620885733386">ERROR: File IA.PROMO_PBO_ENH.DATA does not exist.</div><div class="sasSource">2151  run;</div><div class="sasNote" id="sasLogNote504_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              242.31k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:58 AM</div><div class="sasNote">      Step Count                        117  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     11</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        18</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2152  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote505_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2153  create table public.ia_promo_x_pbo_leaf{options replace = true} as</div><div class="sasSource">2154  select</div><div class="sasSource">2155  t1.promo_id,</div><div class="sasSource">2156  t2.PBO_LEAF_ID</div><div class="sasSource">2157  from</div><div class="sasSource">2158  public.ia_promo_x_pbo as t1,</div><div class="sasSource">2159  public.pbo_lvl_all as t2</div><div class="sasSource">2160  where t1.pbo_location_id = t2.PBO_LOCATION_ID</div><div class="sasSource">2161  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote506_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.IA_PROMO_X_PBO" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError44_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote507_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">2162  create table public.ia_promo_x_product_leaf{options replace = true} as</div><div class="sasSource">2163  select</div><div class="sasSource">2164  t1.promo_id,</div><div class="sasSource">2165  t2.product_LEAF_ID</div><div class="sasSource">2166  from</div><div class="sasSource">2167  public.ia_promo_x_product as t1,</div><div class="sasSource">2168  public.product_lvl_all as t2</div><div class="sasSource">2169  where t1.product_id = t2.product_id</div><div class="sasSource">2170  ;</div><div class="sasSource">ERROR: Table "PUBLIC.IA_PROMO_X_PRODUCT" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError45_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasSource">2171  create table public.promo_ml_trp{options replace = true} as</div><div class="sasSource">2172  select distinct</div><div class="sasSource">2173  t3.product_LEAF_ID,</div><div class="sasSource">2174  t2.PBO_LEAF_ID,</div><div class="sasSource">2175  datepart(t1.START_DT) as start_dt,</div><div class="sasSource">2176  datepart(t1.END_DT) as end_dt,</div><div class="sasSource">2177  coalesce(t4.TRP, 0) as trp</div><div class="sasSource">2178  from</div><div class="sasSource">2179  public.ia_promo as t1</div><div class="sasSource">2180  left join</div><div class="sasSource">2181  public.ia_promo_x_pbo_leaf as t2</div><div class="sasSource">2182  on</div><div class="sasSource">2183  t1.PROMO_ID = t2.PROMO_ID</div><div class="sasSource">2184  left join</div><div class="sasSource">2185  public.ia_promo_x_product_leaf as t3</div><div class="sasSource">2186  on</div><div class="sasSource">2187  t1.PROMO_ID = t3.PROMO_ID</div><div class="sasSource">2188  left join</div><div class="sasSource">2189  public.ia_media as t4</div><div class="sasSource">2190  on</div><div class="sasSource">2191  t1.PROMO_GROUP_ID = t4.PROMO_GROUP_ID and</div><div class="sasSource">2192  datepart(t4.report_dt) &lt;= datepart(t1.end_dt) and</div><div class="sasSource">2193  datepart(t4.report_dt) &gt;= datepart(t1.start_dt)</div><div class="sasSource">2194  ;</div><div class="sasSource">ERROR: Table "PUBLIC.IA_PROMO" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError46_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasSource">2195  quit;</div><div class="sasNote" id="sasLogNote508_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.14 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              97.71k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:58 AM</div><div class="sasNote">      Step Count                        118  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        59</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2196  /* Усредняем TRP в рамках одного итервала промо */</div><div class="sasSource">2197  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote509_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2198  create table public.promo_ml_trp2{options replace=true} as</div><div class="sasSource">2199  select</div><div class="sasSource">2200  product_LEAF_ID,</div><div class="sasSource">2201  PBO_LEAF_ID,</div><div class="sasSource">2202  start_dt,</div><div class="sasSource">2203  end_dt,</div><div class="sasSource">2204  mean(TRP) as mean_trp</div><div class="sasSource">2205  from</div><div class="sasSource">2206  public.promo_ml_trp as t1</div><div class="sasSource">2207  group by</div><div class="sasSource">2208  product_LEAF_ID,</div><div class="sasSource">2209  PBO_LEAF_ID,</div><div class="sasSource">2210  start_dt,</div><div class="sasSource">2211  end_dt</div><div class="sasSource">2212  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote510_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.PROMO_ML_TRP" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError47_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote511_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">2213  quit;</div><div class="sasNote" id="sasLogNote512_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.15k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:58 AM</div><div class="sasNote">      Step Count                        119  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2214  data public.promo_ml_trp_expand;</div><div class="sasSource">2215  set public.promo_ml_trp2;</div><div class="sasNote" id="sasLogNote513_1620885733386">NOTE: The table PUBLIC.PROMO_ML_TRP2 does not exist in Cloud Analytic Services.</div><div class="sasError" id="sasLogError48_1620885733386">ERROR: File PUBLIC.PROMO_ML_TRP2.DATA does not exist.</div><div class="sasSource">2216  do sales_dt=start_dt to end_dt;</div><div class="sasSource">2217  output;</div><div class="sasSource">2218  end;</div><div class="sasSource">2219  run;</div><div class="sasNote" id="sasLogNote514_1620885733386">NOTE: The SAS System stopped processing this step because of errors.</div><div class="sasWarning" id="sasLogWarning14_1620885733386">WARNING: The data set PUBLIC.PROMO_ML_TRP_EXPAND may be incomplete.  When this step was stopped there were 0 observations and 3 </div><div class="sasWarning">         variables.</div><div class="sasWarning" id="sasLogWarning15_1620885733386">WARNING: Data set PUBLIC.PROMO_ML_TRP_EXPAND was not replaced because this step was stopped.</div><div class="sasNote" id="sasLogNote515_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              334.12k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:58 AM</div><div class="sasNote">      Step Count                        120  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     8</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        8</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2220  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote516_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2221  create table public.sum_trp{options replace=true} as</div><div class="sasSource">2222  select</div><div class="sasSource">2223  t1.PRODUCT_LEAF_ID,</div><div class="sasSource">2224  t1.PBO_LEAF_ID,</div><div class="sasSource">2225  t1.sales_dt,</div><div class="sasSource">2226  sum(t1.mean_trp) as sum_trp</div><div class="sasSource">2227  from</div><div class="sasSource">2228  public.promo_ml_trp_expand as t1</div><div class="sasSource">2229  group by</div><div class="sasSource">2230  t1.PRODUCT_LEAF_ID,</div><div class="sasSource">2231  t1.PBO_LEAF_ID,</div><div class="sasSource">2232  t1.sales_dt</div><div class="sasSource">2233  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote517_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.PROMO_ML_TRP_EXPAND" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError49_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote518_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">2234  create table public.abt10_ml{options replace=true} as</div><div class="sasSource">2235  select</div><div class="sasSource">2236  t1.PBO_LOCATION_ID,</div><div class="sasSource">2237  t1.PRODUCT_ID,</div><div class="sasSource">2238  t1.CHANNEL_CD,</div><div class="sasSource">2239  t1.SALES_DT,</div><div class="sasSource">2240  t1.sum_qty,</div><div class="sasSource">2241  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2242  t1.lag_halfyear_avg,</div><div class="sasSource">2243  t1.lag_halfyear_med,</div><div class="sasSource">2244  t1.lag_month_avg,</div><div class="sasSource">2245  t1.lag_month_med,</div><div class="sasSource">2246  t1.lag_qtr_avg,</div><div class="sasSource">2247  t1.lag_qtr_med,</div><div class="sasSource">2248  t1.lag_week_avg,</div><div class="sasSource">2249  t1.lag_week_med,</div><div class="sasSource">2250  t1.lag_year_avg,</div><div class="sasSource">2251  t1.lag_year_med,</div><div class="sasSource">2252  t1.lag_halfyear_std,</div><div class="sasSource">2253  t1.lag_month_std,</div><div class="sasSource">2254  t1.lag_qtr_std,</div><div class="sasSource">2255  t1.lag_week_std,</div><div class="sasSource">2256  t1.lag_year_std,</div><div class="sasSource">2257  t1.lag_halfyear_pct10,</div><div class="sasSource">2258  t1.lag_halfyear_pct90,</div><div class="sasSource">2259  t1.lag_month_pct10,</div><div class="sasSource">2260  t1.lag_month_pct90,</div><div class="sasSource">2261  t1.lag_qtr_pct10,</div><div class="sasSource">2262  t1.lag_qtr_pct90,</div><div class="sasSource">2263  t1.lag_week_pct10,</div><div class="sasSource">2264  t1.lag_week_pct90,</div><div class="sasSource">2265  t1.lag_year_pct10,</div><div class="sasSource">2266  t1.lag_year_pct90,</div><div class="sasSource">2267  &amp;promo_list_sql.,</div><div class="sasWarning" id="sasLogWarning16_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">2268   t1.NP_GIFT_PRICE_AMT,</div><div class="sasSource">2269  t1.side_promo_flag,</div><div class="sasSource">2270  t1.A_CPI,</div><div class="sasSource">2271  t1.A_GPD,</div><div class="sasSource">2272  t1.A_RDI,</div><div class="sasSource">2273  t1.TEMPERATURE,</div><div class="sasSource">2274  t1.PRECIPITATION,</div><div class="sasSource">2275  t1.comp_trp_BK,</div><div class="sasSource">2276  t1.comp_trp_KFC,</div><div class="sasSource">2277  coalesce(t2.sum_trp, 0) as sum_trp</div><div class="sasSource">2278  from</div><div class="sasSource">2279  public.abt9_ml as t1</div><div class="sasSource">2280  left join</div><div class="sasSource">2281  public.sum_trp as t2</div><div class="sasSource">2282  on</div><div class="sasSource">2283  t1.product_id = t2.PRODUCT_LEAF_ID and</div><div class="sasSource">2284  t1.pbo_location_id = t2.PBO_LEAF_ID and</div><div class="sasSource">2285  t1.sales_dt = t2.sales_dt</div><div class="sasSource">2286  ;</div><div class="sasSource">ERROR: Syntax error at or near "PROMO_LIST_SQL."</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError50_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasSource">2287  quit;</div><div class="sasNote" id="sasLogNote519_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.08 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              215.84k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:58 AM</div><div class="sasNote">      Step Count                        121  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        42</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">2288  proc casutil;</div><div class="sasNote" id="sasLogNote520_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2289    droptable casdata="IA_media" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote521_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016189 seconds.</div><div class="sasSource">2290    droptable casdata="IA_promo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote522_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.014845 seconds.</div><div class="sasSource">2291    droptable casdata="ia_promo_x_product" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote523_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015939 seconds.</div><div class="sasSource">2292    droptable casdata="ia_promo_x_pbo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote524_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.014343 seconds.</div><div class="sasSource">2293    droptable casdata="ia_promo_x_pbo_leaf" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote525_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016334 seconds.</div><div class="sasSource">2294    droptable casdata="ia_promo_x_product_leaf" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote526_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016894 seconds.</div><div class="sasSource">2295    droptable casdata="promo_ml_trp" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote527_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.017869 seconds.</div><div class="sasSource">2296    droptable casdata="promo_ml_trp_expand" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote528_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.017476 seconds.</div><div class="sasSource">2297    droptable casdata="sum_trp" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote529_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.019252 seconds.</div><div class="sasSource">2298    droptable casdata="abt9_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote530_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.014903 seconds.</div><div class="sasSource">2299  /*   promote casdata="abt10_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2300  run;</div><div class="sasSource">2301  /****** 11. Добавляем атрибуты товаров ******/</div><div class="sasNote" id="sasLogNote531_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.25 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              119.31k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:58 AM</div><div class="sasNote">      Step Count                        122  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        51</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2302  proc casutil;</div><div class="sasNote" id="sasLogNote532_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2303    droptable casdata="abt11_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote533_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015401 seconds.</div><div class="sasSource">2304  run;</div><div class="sasNote" id="sasLogNote534_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.65k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:58 AM</div><div class="sasNote">      Step Count                        123  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        6</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2305  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote535_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2306  create table public.abt11_ml{options replace=true} as</div><div class="sasSource">2307  select</div><div class="sasSource">2308  t1.PBO_LOCATION_ID,</div><div class="sasSource">2309  t1.PRODUCT_ID,</div><div class="sasSource">2310  t1.CHANNEL_CD,</div><div class="sasSource">2311  t1.SALES_DT,</div><div class="sasSource">2312  t1.sum_qty,</div><div class="sasSource">2313  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2314  t1.lag_halfyear_avg,</div><div class="sasSource">2315  t1.lag_halfyear_med,</div><div class="sasSource">2316  t1.lag_month_avg,</div><div class="sasSource">2317  t1.lag_month_med,</div><div class="sasSource">2318  t1.lag_qtr_avg,</div><div class="sasSource">2319  t1.lag_qtr_med,</div><div class="sasSource">2320  t1.lag_week_avg,</div><div class="sasSource">2321  t1.lag_week_med,</div><div class="sasSource">2322  t1.lag_year_avg,</div><div class="sasSource">2323  t1.lag_year_med,</div><div class="sasSource">2324  t1.lag_halfyear_std,</div><div class="sasSource">2325  t1.lag_month_std,</div><div class="sasSource">2326  t1.lag_qtr_std,</div><div class="sasSource">2327  t1.lag_week_std,</div><div class="sasSource">2328  t1.lag_year_std,</div><div class="sasSource">2329  t1.lag_halfyear_pct10,</div><div class="sasSource">2330  t1.lag_halfyear_pct90,</div><div class="sasSource">2331  t1.lag_month_pct10,</div><div class="sasSource">2332  t1.lag_month_pct90,</div><div class="sasSource">2333  t1.lag_qtr_pct10,</div><div class="sasSource">2334  t1.lag_qtr_pct90,</div><div class="sasSource">2335  t1.lag_week_pct10,</div><div class="sasSource">2336  t1.lag_week_pct90,</div><div class="sasSource">2337  t1.lag_year_pct10,</div><div class="sasSource">2338  t1.lag_year_pct90,</div><div class="sasSource">2339  &amp;promo_list_sql.,</div><div class="sasWarning" id="sasLogWarning17_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">2340   t1.NP_GIFT_PRICE_AMT,</div><div class="sasSource">2341  t1.side_promo_flag,</div><div class="sasSource">2342  t1.A_CPI,</div><div class="sasSource">2343  t1.A_GPD,</div><div class="sasSource">2344  t1.A_RDI,</div><div class="sasSource">2345  t1.TEMPERATURE,</div><div class="sasSource">2346  t1.PRECIPITATION,</div><div class="sasSource">2347  t1.comp_trp_BK,</div><div class="sasSource">2348  t1.comp_trp_KFC,</div><div class="sasSource">2349  t1.sum_trp,</div><div class="sasSource">2350  t2.prod_lvl4_id,</div><div class="sasSource">2351  t2.prod_lvl3_id,</div><div class="sasSource">2352  t2.prod_lvl2_id,</div><div class="sasSource">2353  t2.a_hero_id as hero,</div><div class="sasSource">2354  t2.a_item_size_id as item_size,</div><div class="sasSource">2355  t2.a_offer_type_id as offer_type,</div><div class="sasSource">2356  t2.a_price_tier_id as price_tier</div><div class="sasSource">2357  from</div><div class="sasSource">2358  public.abt10_ml as t1</div><div class="sasSource">2359  left join</div><div class="sasSource">2360  public.product_dictionary_ml as t2</div><div class="sasSource">2361  on</div><div class="sasSource">2362  t1.product_id = t2.product_id</div><div class="sasSource">2363  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote536_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Syntax error at or near "PROMO_LIST_SQL."</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError51_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote537_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">2364  quit;</div><div class="sasNote" id="sasLogNote538_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              219.06k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:58 AM</div><div class="sasNote">      Step Count                        124  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">2365  </div><div class="sasSource">2366  proc casutil;</div><div class="sasNote" id="sasLogNote539_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2367  /*   promote casdata="abt11_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2368    droptable casdata="abt10_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote540_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016013 seconds.</div><div class="sasSource">2369  run;</div><div class="sasSource">2370  /******12. Добавим атрибуты ПБО ******/</div><div class="sasNote" id="sasLogNote541_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.65k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:58 AM</div><div class="sasNote">      Step Count                        125  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2371  proc casutil;</div><div class="sasNote" id="sasLogNote542_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2372    droptable casdata="abt12_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote543_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016246 seconds.</div><div class="sasSource">2373    load data=&amp;inlib..IA_pbo_location casout='ia_pbo_location' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote544_1620885733386">NOTE: IA.IA_PBO_LOCATION was successfully added to the "Public" caslib as "IA_PBO_LOCATION".</div><div class="sasSource">2374    load data=&amp;inlib..IA_PBO_LOC_HIERARCHY casout='IA_PBO_LOC_HIERARCHY' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote545_1620885733386">NOTE: IA.IA_PBO_LOC_HIERARCHY was successfully added to the "Public" caslib as "IA_PBO_LOC_HIERARCHY".</div><div class="sasSource">2375    load data=&amp;inlib..IA_PBO_LOC_ATTRIBUTES casout='IA_PBO_LOC_ATTRIBUTES' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote546_1620885733386">NOTE: IA.IA_PBO_LOC_ATTRIBUTES was successfully added to the "Public" caslib as "IA_PBO_LOC_ATTRIBUTES".</div><div class="sasSource">2376  run;</div><div class="sasNote" id="sasLogNote547_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.67 seconds</div><div class="sasNote">      user cpu time       0.06 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              2289.87k</div><div class="sasNote">      OS Memory           37552.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:59 AM</div><div class="sasNote">      Step Count                        126  Switch Count  76</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     3013</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        524</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2377  proc cas;</div><div class="sasSource">2378  transpose.transpose /</div><div class="sasSource">2379     table={name="ia_pbo_loc_attributes", caslib="public", groupby={"pbo_location_id"}}</div><div class="sasSource">2380     attributes={{name="pbo_location_id"}}</div><div class="sasSource">2381     transpose={"PBO_LOC_ATTR_VALUE"}</div><div class="sasSource">2382     prefix="A_"</div><div class="sasSource">2383     id={"PBO_LOC_ATTR_NM"}</div><div class="sasSource">2384     casout={name="attr_transposed", caslib="public", replace=true};</div><div class="sasSource">2385  quit;</div><div class="sasNote" id="sasLogNote548_1620885733386">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote549_1620885733386">NOTE: There were 17380 rows read from the table IA_PBO_LOC_ATTRIBUTES.</div><div class="sasNote" id="sasLogNote550_1620885733386">NOTE: The table attr_transposed has 869 rows and 23 columns.</div><div class="sasNote" id="sasLogNote551_1620885733386">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10004.37k</div><div class="sasNote">      OS Memory           45696.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:59 AM</div><div class="sasNote">      Step Count                        127  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     983</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        15</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2386  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote552_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2387     create table public.pbo_hier_flat{options replace=true} as</div><div class="sasSource">2388  select t1.pbo_location_id,</div><div class="sasSource">2389     t2.PBO_LOCATION_ID as LVL3_ID,</div><div class="sasSource">2390     t2.PARENT_PBO_LOCATION_ID as LVL2_ID,</div><div class="sasSource">2391     1 as LVL1_ID</div><div class="sasSource">2392  from</div><div class="sasSource">2393  (select * from public.ia_pbo_loc_hierarchy where pbo_location_lvl=4) as t1</div><div class="sasSource">2394  left join</div><div class="sasSource">2395  (select * from public.ia_pbo_loc_hierarchy where pbo_location_lvl=3) as t2</div><div class="sasSource">2396  on t1.PARENT_PBO_LOCATION_ID=t2.PBO_LOCATION_ID</div><div class="sasSource">2397   ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote553_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_HIER_FLAT was created in caslib Public with 869 rows returned.</div><div class="sasNote" id="sasLogNote554_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2398  quit;</div><div class="sasNote" id="sasLogNote555_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.25 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.15k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:52:59 AM</div><div class="sasNote">      Step Count                        128  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2399  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote556_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2400  create table public.pbo_dictionary_ml{options replace=true} as</div><div class="sasSource">2401  select</div><div class="sasSource">2402  t2.pbo_location_id,</div><div class="sasSource">2403  coalesce(t2.lvl3_id,-999) as lvl3_id,</div><div class="sasSource">2404  coalesce(t2.lvl2_id,-99) as lvl2_id,</div><div class="sasSource">2405  coalesce(t14.pbo_location_nm,'NA') as pbo_location_nm,</div><div class="sasSource">2406  coalesce(t13.pbo_location_nm,'NA') as lvl3_nm,</div><div class="sasSource">2407  coalesce(t12.pbo_location_nm,'NA') as lvl2_nm,</div><div class="sasSource">2408  t3.A_AGREEMENT_TYPE,</div><div class="sasSource">2409  t3.A_BREAKFAST,</div><div class="sasSource">2410  t3.A_BUILDING_TYPE,</div><div class="sasSource">2411  t3.A_COMPANY,</div><div class="sasSource">2412  t3.A_DELIVERY,</div><div class="sasSource">2413  t3.A_DRIVE_THRU,</div><div class="sasSource">2414  t3.A_MCCAFE_TYPE,</div><div class="sasSource">2415  t3.A_PRICE_LEVEL,</div><div class="sasSource">2416  t3.A_WINDOW_TYPE</div><div class="sasSource">2417  from</div><div class="sasSource">2418  public.pbo_hier_flat t2</div><div class="sasSource">2419  left join</div><div class="sasSource">2420  public.attr_transposed t3</div><div class="sasSource">2421  on</div><div class="sasSource">2422  t2.pbo_location_id=t3.pbo_location_id</div><div class="sasSource">2423  left join</div><div class="sasSource">2424  PUBLIC.IA_PBO_LOCATION t14</div><div class="sasSource">2425  on</div><div class="sasSource">2426  t2.pbo_location_id=t14.pbo_location_id</div><div class="sasSource">2427  left join</div><div class="sasSource">2428  PUBLIC.IA_PBO_LOCATION t13</div><div class="sasSource">2429  on</div><div class="sasSource">2430  t2.lvl3_id=t13.pbo_location_id</div><div class="sasSource">2431  left join</div><div class="sasSource">2432  PUBLIC.IA_PBO_LOCATION t12</div><div class="sasSource">2433  on</div><div class="sasSource">2434  t2.lvl2_id=t12.pbo_location_id;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote557_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib Public with 869 rows returned.</div><div class="sasNote" id="sasLogNote558_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2435  quit;</div><div class="sasNote" id="sasLogNote559_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.93 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              216.06k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:00 AM</div><div class="sasNote">      Step Count                        129  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        27</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2436  %text_encoding(public.pbo_dictionary_ml, A_AGREEMENT_TYPE)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote560_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_AGREEMENT_TYPE" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote561_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015226 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote562_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.65k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:00 AM</div><div class="sasNote">      Step Count                        130  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote563_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_AGREEMENT_TYPE from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote564_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 3 rows returned.</div><div class="sasNote" id="sasLogNote565_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote566_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.17 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.15k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:01 AM</div><div class="sasNote">      Step Count                        131  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote567_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote568_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote569_1620885733386">NOTE: There were 3 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote570_1620885733386">NOTE: The data set WORK.UNIQUE has 3 observations and 1 variables.</div><div class="sasNote" id="sasLogNote571_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote572_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.03 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              532.46k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:01 AM</div><div class="sasNote">      Step Count                        132  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     324</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        50</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_AGREEMENT_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_AGREEMENT_TYPE_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote573_1620885733386">NOTE: There were 3 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote574_1620885733386">NOTE: The data set WORK.ENCODING_A_AGREEMENT_TYPE has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote575_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_AGREEMENT_TYPE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote576_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              562.40k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:01 AM</div><div class="sasNote">      Step Count                        133  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     13</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_AGREEMENT_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_AGREEMENT_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote577_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote578_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote579_1620885733386">NOTE: There were 3 observations read from the data set WORK.ENCODING_A_AGREEMENT_TYPE.</div><div class="sasNote" id="sasLogNote580_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_AGREEMENT_TYPE has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote581_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              904.37k</div><div class="sasNote">      OS Memory           36376.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:01 AM</div><div class="sasNote">      Step Count                        134  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     453</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        37</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote582_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_AGREEMENT_TYPE_id </div><div class="sasSource">from public.pbo_dictionary_ml as t1 left join public.encoding_A_AGREEMENT_TYPE as t2 on t1.A_AGREEMENT_TYPE = t2.A_AGREEMENT_TYPE ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote583_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 869 rows returned.</div><div class="sasNote" id="sasLogNote584_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote585_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.20 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.15k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:01 AM</div><div class="sasNote">      Step Count                        135  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote586_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_A_AGREEMENT_TYPE" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote587_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_AGREEMENT_TYPE in caslib Public to table encoding_A_AGREEMENT_TYPE in </div><div class="sasNote">      caslib public.</div><div class="sasNote" id="sasLogNote588_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.020016 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">2437  %text_encoding(public.pbo_dictionary_ml, A_BREAKFAST)</div><div class="sasNote" id="sasLogNote589_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              364.37k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:01 AM</div><div class="sasNote">      Step Count                        136  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     19</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        37</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote590_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_BREAKFAST" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote591_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.013638 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote592_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.65k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:01 AM</div><div class="sasNote">      Step Count                        137  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote593_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_BREAKFAST from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote594_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 2 rows returned.</div><div class="sasNote" id="sasLogNote595_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote596_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.17 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.18k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:01 AM</div><div class="sasNote">      Step Count                        138  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        23</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote597_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote598_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote599_1620885733386">NOTE: There were 2 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote600_1620885733386">NOTE: The data set WORK.UNIQUE has 2 observations and 1 variables.</div><div class="sasNote" id="sasLogNote601_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote602_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.10 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              531.71k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:01 AM</div><div class="sasNote">      Step Count                        139  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     327</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        54</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_BREAKFAST;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_BREAKFAST_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote603_1620885733386">NOTE: There were 2 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote604_1620885733386">NOTE: The data set WORK.ENCODING_A_BREAKFAST has 2 observations and 2 variables.</div><div class="sasNote" id="sasLogNote605_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_BREAKFAST increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote606_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              561.96k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:01 AM</div><div class="sasNote">      Step Count                        140  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_BREAKFAST;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_BREAKFAST;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote607_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote608_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote609_1620885733386">NOTE: There were 2 observations read from the data set WORK.ENCODING_A_BREAKFAST.</div><div class="sasNote" id="sasLogNote610_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_BREAKFAST has 2 observations and 2 variables.</div><div class="sasNote" id="sasLogNote611_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.03 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              904.87k</div><div class="sasNote">      OS Memory           36376.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:01 AM</div><div class="sasNote">      Step Count                        141  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     453</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        41</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote612_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_BREAKFAST_id from </div><div class="sasSource">public.pbo_dictionary_ml as t1 left join public.encoding_A_BREAKFAST as t2 on t1.A_BREAKFAST = t2.A_BREAKFAST ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote613_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 869 rows returned.</div><div class="sasNote" id="sasLogNote614_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote615_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.21 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              83.40k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:02 AM</div><div class="sasNote">      Step Count                        142  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        25</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote616_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_A_BREAKFAST" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote617_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_BREAKFAST in caslib Public to table encoding_A_BREAKFAST in caslib public.</div><div class="sasNote" id="sasLogNote618_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.024194 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">2438  %text_encoding(public.pbo_dictionary_ml, A_BUILDING_TYPE)</div><div class="sasNote" id="sasLogNote619_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              230.25k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:02 AM</div><div class="sasNote">      Step Count                        143  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     10</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote620_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_BUILDING_TYPE" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote621_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.019451 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote622_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.65k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:02 AM</div><div class="sasNote">      Step Count                        144  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote623_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_BUILDING_TYPE from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote624_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 4 rows returned.</div><div class="sasNote" id="sasLogNote625_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote626_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.20 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.31k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:02 AM</div><div class="sasNote">      Step Count                        145  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        25</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote627_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote628_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote629_1620885733386">NOTE: There were 4 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote630_1620885733386">NOTE: The data set WORK.UNIQUE has 4 observations and 1 variables.</div><div class="sasNote" id="sasLogNote631_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote632_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              533.84k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:02 AM</div><div class="sasNote">      Step Count                        146  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     341</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        59</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_BUILDING_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_BUILDING_TYPE_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote633_1620885733386">NOTE: There were 4 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote634_1620885733386">NOTE: The data set WORK.ENCODING_A_BUILDING_TYPE has 4 observations and 2 variables.</div><div class="sasNote" id="sasLogNote635_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_BUILDING_TYPE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote636_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              562.15k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:02 AM</div><div class="sasNote">      Step Count                        147  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     16</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_BUILDING_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_BUILDING_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote637_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote638_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote639_1620885733386">NOTE: There were 4 observations read from the data set WORK.ENCODING_A_BUILDING_TYPE.</div><div class="sasNote" id="sasLogNote640_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_BUILDING_TYPE has 4 observations and 2 variables.</div><div class="sasNote" id="sasLogNote641_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.08 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              929.21k</div><div class="sasNote">      OS Memory           36376.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:02 AM</div><div class="sasNote">      Step Count                        148  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     453</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        41</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote642_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_BUILDING_TYPE_id </div><div class="sasSource">from public.pbo_dictionary_ml as t1 left join public.encoding_A_BUILDING_TYPE as t2 on t1.A_BUILDING_TYPE = t2.A_BUILDING_TYPE ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote643_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 869 rows returned.</div><div class="sasNote" id="sasLogNote644_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote645_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.20 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.15k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:02 AM</div><div class="sasNote">      Step Count                        149  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        25</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote646_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_A_BUILDING_TYPE" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote647_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_BUILDING_TYPE in caslib Public to table encoding_A_BUILDING_TYPE in caslib </div><div class="sasNote">      public.</div><div class="sasNote" id="sasLogNote648_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.022437 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">2439  %text_encoding(public.pbo_dictionary_ml, A_COMPANY)</div><div class="sasNote" id="sasLogNote649_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              230.25k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:02 AM</div><div class="sasNote">      Step Count                        150  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     10</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        30</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote650_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_COMPANY" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote651_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.017757 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote652_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.75k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:02 AM</div><div class="sasNote">      Step Count                        151  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote653_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_COMPANY from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote654_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 8 rows returned.</div><div class="sasNote" id="sasLogNote655_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote656_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.19 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.18k</div><div class="sasNote">      OS Memory           35860.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:03 AM</div><div class="sasNote">      Step Count                        152  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote657_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote658_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote659_1620885733386">NOTE: There were 8 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote660_1620885733386">NOTE: The data set WORK.UNIQUE has 8 observations and 1 variables.</div><div class="sasNote" id="sasLogNote661_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote662_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.03 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              795.21k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:03 AM</div><div class="sasNote">      Step Count                        153  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     325</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        49</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_COMPANY;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_COMPANY_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote663_1620885733386">NOTE: There were 8 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote664_1620885733386">NOTE: The data set WORK.ENCODING_A_COMPANY has 8 observations and 2 variables.</div><div class="sasNote" id="sasLogNote665_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_COMPANY increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote666_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              562.75k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:03 AM</div><div class="sasNote">      Step Count                        154  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     20</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_COMPANY;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_COMPANY;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote667_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote668_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote669_1620885733386">NOTE: There were 8 observations read from the data set WORK.ENCODING_A_COMPANY.</div><div class="sasNote" id="sasLogNote670_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_COMPANY has 8 observations and 2 variables.</div><div class="sasNote" id="sasLogNote671_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.08 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              904.65k</div><div class="sasNote">      OS Memory           36632.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:03 AM</div><div class="sasNote">      Step Count                        155  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     453</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        38</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote672_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_COMPANY_id from </div><div class="sasSource">public.pbo_dictionary_ml as t1 left join public.encoding_A_COMPANY as t2 on t1.A_COMPANY = t2.A_COMPANY ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote673_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 869 rows returned.</div><div class="sasNote" id="sasLogNote674_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote675_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.24 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              83.40k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:03 AM</div><div class="sasNote">      Step Count                        156  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        25</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote676_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_A_COMPANY" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote677_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_COMPANY in caslib Public to table encoding_A_COMPANY in caslib public.</div><div class="sasNote" id="sasLogNote678_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.024558 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">2440  %text_encoding(public.pbo_dictionary_ml, A_DELIVERY)</div><div class="sasNote" id="sasLogNote679_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              231.25k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:03 AM</div><div class="sasNote">      Step Count                        157  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     10</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        30</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote680_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_DELIVERY" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote681_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01613 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote682_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.65k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:03 AM</div><div class="sasNote">      Step Count                        158  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote683_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_DELIVERY from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote684_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 13 rows returned.</div><div class="sasNote" id="sasLogNote685_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote686_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.19 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.18k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:03 AM</div><div class="sasNote">      Step Count                        159  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote687_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote688_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote689_1620885733386">NOTE: There were 13 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote690_1620885733386">NOTE: The data set WORK.UNIQUE has 13 observations and 1 variables.</div><div class="sasNote" id="sasLogNote691_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote692_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              576.40k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:03 AM</div><div class="sasNote">      Step Count                        160  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     328</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        51</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_DELIVERY;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_DELIVERY_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote693_1620885733386">NOTE: There were 13 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote694_1620885733386">NOTE: The data set WORK.ENCODING_A_DELIVERY has 13 observations and 2 variables.</div><div class="sasNote" id="sasLogNote695_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_DELIVERY increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote696_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              564.00k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:03 AM</div><div class="sasNote">      Step Count                        161  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     17</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_DELIVERY;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_DELIVERY;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote697_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote698_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote699_1620885733386">NOTE: There were 13 observations read from the data set WORK.ENCODING_A_DELIVERY.</div><div class="sasNote" id="sasLogNote700_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_DELIVERY has 13 observations and 2 variables.</div><div class="sasNote" id="sasLogNote701_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.08 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              905.00k</div><div class="sasNote">      OS Memory           36632.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:04 AM</div><div class="sasNote">      Step Count                        162  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     457</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        39</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote702_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_DELIVERY_id from </div><div class="sasSource">public.pbo_dictionary_ml as t1 left join public.encoding_A_DELIVERY as t2 on t1.A_DELIVERY = t2.A_DELIVERY ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote703_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 869 rows returned.</div><div class="sasNote" id="sasLogNote704_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote705_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.23 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.65k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:04 AM</div><div class="sasNote">      Step Count                        163  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote706_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_A_DELIVERY" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote707_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_DELIVERY in caslib Public to table encoding_A_DELIVERY in caslib public.</div><div class="sasNote" id="sasLogNote708_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.020724 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">2441  %text_encoding(public.pbo_dictionary_ml, A_MCCAFE_TYPE)</div><div class="sasNote" id="sasLogNote709_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              230.34k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:04 AM</div><div class="sasNote">      Step Count                        164  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     9</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote710_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_MCCAFE_TYPE" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote711_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016084 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote712_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.75k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:04 AM</div><div class="sasNote">      Step Count                        165  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        6</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote713_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_MCCAFE_TYPE from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote714_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 3 rows returned.</div><div class="sasNote" id="sasLogNote715_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote716_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.18 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              83.40k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:04 AM</div><div class="sasNote">      Step Count                        166  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote717_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote718_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote719_1620885733386">NOTE: There were 3 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote720_1620885733386">NOTE: The data set WORK.UNIQUE has 3 observations and 1 variables.</div><div class="sasNote" id="sasLogNote721_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote722_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              545.25k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:04 AM</div><div class="sasNote">      Step Count                        167  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     330</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        54</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_MCCAFE_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_MCCAFE_TYPE_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote723_1620885733386">NOTE: There were 3 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote724_1620885733386">NOTE: The data set WORK.ENCODING_A_MCCAFE_TYPE has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote725_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_MCCAFE_TYPE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote726_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              562.50k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:04 AM</div><div class="sasNote">      Step Count                        168  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     19</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_MCCAFE_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_MCCAFE_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote727_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote728_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote729_1620885733386">NOTE: There were 3 observations read from the data set WORK.ENCODING_A_MCCAFE_TYPE.</div><div class="sasNote" id="sasLogNote730_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_MCCAFE_TYPE has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote731_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              902.96k</div><div class="sasNote">      OS Memory           36632.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:04 AM</div><div class="sasNote">      Step Count                        169  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     456</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        42</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote732_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_MCCAFE_TYPE_id </div><div class="sasSource">from public.pbo_dictionary_ml as t1 left join public.encoding_A_MCCAFE_TYPE as t2 on t1.A_MCCAFE_TYPE = t2.A_MCCAFE_TYPE ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote733_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 869 rows returned.</div><div class="sasNote" id="sasLogNote734_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote735_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.25 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.40k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:04 AM</div><div class="sasNote">      Step Count                        170  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote736_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_A_MCCAFE_TYPE" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote737_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_MCCAFE_TYPE in caslib Public to table encoding_A_MCCAFE_TYPE in caslib </div><div class="sasNote">      public.</div><div class="sasNote" id="sasLogNote738_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.021851 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">2442  %text_encoding(public.pbo_dictionary_ml, A_PRICE_LEVEL)</div><div class="sasNote" id="sasLogNote739_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              231.25k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:05 AM</div><div class="sasNote">      Step Count                        171  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     10</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        35</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote740_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_PRICE_LEVEL" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote741_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015521 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote742_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.65k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:05 AM</div><div class="sasNote">      Step Count                        172  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        6</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote743_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_PRICE_LEVEL from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote744_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 811 rows returned.</div><div class="sasNote" id="sasLogNote745_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote746_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.18 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              83.40k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:05 AM</div><div class="sasNote">      Step Count                        173  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        23</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote747_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote748_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote749_1620885733386">NOTE: There were 811 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote750_1620885733386">NOTE: The data set WORK.UNIQUE has 811 observations and 1 variables.</div><div class="sasNote" id="sasLogNote751_1620885733386">NOTE: Compressing data set WORK.UNIQUE decreased size by 60.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 5 pages.</div><div class="sasNote" id="sasLogNote752_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1225.75k</div><div class="sasNote">      OS Memory           36440.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:05 AM</div><div class="sasNote">      Step Count                        174  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     551</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        51</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_PRICE_LEVEL;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_PRICE_LEVEL_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote753_1620885733386">NOTE: There were 811 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote754_1620885733386">NOTE: The data set WORK.ENCODING_A_PRICE_LEVEL has 811 observations and 2 variables.</div><div class="sasNote" id="sasLogNote755_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_PRICE_LEVEL decreased size by 66.67 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 6 pages.</div><div class="sasNote" id="sasLogNote756_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              562.12k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:05 AM</div><div class="sasNote">      Step Count                        175  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     13</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_PRICE_LEVEL;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_PRICE_LEVEL;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote757_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote758_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote759_1620885733386">NOTE: There were 811 observations read from the data set WORK.ENCODING_A_PRICE_LEVEL.</div><div class="sasNote" id="sasLogNote760_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_PRICE_LEVEL has 811 observations and 2 variables.</div><div class="sasNote" id="sasLogNote761_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1291.71k</div><div class="sasNote">      OS Memory           37284.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:05 AM</div><div class="sasNote">      Step Count                        176  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     622</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        38</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote762_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_PRICE_LEVEL_id </div><div class="sasSource">from public.pbo_dictionary_ml as t1 left join public.encoding_A_PRICE_LEVEL as t2 on t1.A_PRICE_LEVEL = t2.A_PRICE_LEVEL ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote763_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 869 rows returned.</div><div class="sasNote" id="sasLogNote764_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote765_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.23 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.40k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:05 AM</div><div class="sasNote">      Step Count                        177  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote766_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_A_PRICE_LEVEL" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote767_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_PRICE_LEVEL in caslib Public to table encoding_A_PRICE_LEVEL in caslib </div><div class="sasNote">      public.</div><div class="sasNote" id="sasLogNote768_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.022828 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">2443  %text_encoding(public.pbo_dictionary_ml, A_DRIVE_THRU)</div><div class="sasNote" id="sasLogNote769_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              230.25k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:05 AM</div><div class="sasNote">      Step Count                        178  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     11</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote770_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_DRIVE_THRU" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote771_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.019654 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote772_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.75k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:05 AM</div><div class="sasNote">      Step Count                        179  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        6</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote773_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_DRIVE_THRU from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote774_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 2 rows returned.</div><div class="sasNote" id="sasLogNote775_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote776_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.17 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              83.40k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:05 AM</div><div class="sasNote">      Step Count                        180  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        23</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote777_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote778_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote779_1620885733386">NOTE: There were 2 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote780_1620885733386">NOTE: The data set WORK.UNIQUE has 2 observations and 1 variables.</div><div class="sasNote" id="sasLogNote781_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote782_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.10 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              543.43k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:06 AM</div><div class="sasNote">      Step Count                        181  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     327</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        59</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_DRIVE_THRU;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_DRIVE_THRU_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote783_1620885733386">NOTE: There were 2 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote784_1620885733386">NOTE: The data set WORK.ENCODING_A_DRIVE_THRU has 2 observations and 2 variables.</div><div class="sasNote" id="sasLogNote785_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_DRIVE_THRU increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote786_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              562.90k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:06 AM</div><div class="sasNote">      Step Count                        182  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_DRIVE_THRU;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_DRIVE_THRU;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote787_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote788_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote789_1620885733386">NOTE: There were 2 observations read from the data set WORK.ENCODING_A_DRIVE_THRU.</div><div class="sasNote" id="sasLogNote790_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_DRIVE_THRU has 2 observations and 2 variables.</div><div class="sasNote" id="sasLogNote791_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              905.43k</div><div class="sasNote">      OS Memory           36632.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:06 AM</div><div class="sasNote">      Step Count                        183  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     453</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        39</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote792_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_DRIVE_THRU_id from </div><div class="sasSource">public.pbo_dictionary_ml as t1 left join public.encoding_A_DRIVE_THRU as t2 on t1.A_DRIVE_THRU = t2.A_DRIVE_THRU ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote793_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 869 rows returned.</div><div class="sasNote" id="sasLogNote794_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote795_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.25 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              86.06k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:06 AM</div><div class="sasNote">      Step Count                        184  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote796_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_A_DRIVE_THRU" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote797_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_DRIVE_THRU in caslib Public to table encoding_A_DRIVE_THRU in caslib public.</div><div class="sasNote" id="sasLogNote798_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.024954 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">2444  %text_encoding(public.pbo_dictionary_ml, A_WINDOW_TYPE)</div><div class="sasNote" id="sasLogNote799_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              231.28k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:06 AM</div><div class="sasNote">      Step Count                        185  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     9</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        31</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote800_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_WINDOW_TYPE" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote801_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015505 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote802_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              115.68k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:06 AM</div><div class="sasNote">      Step Count                        186  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote803_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_WINDOW_TYPE from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote804_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 7 rows returned.</div><div class="sasNote" id="sasLogNote805_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote806_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.19 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.34k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:06 AM</div><div class="sasNote">      Step Count                        187  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        21</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote807_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote808_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote809_1620885733386">NOTE: There were 7 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote810_1620885733386">NOTE: The data set WORK.UNIQUE has 7 observations and 1 variables.</div><div class="sasNote" id="sasLogNote811_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote812_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              551.56k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:06 AM</div><div class="sasNote">      Step Count                        188  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     323</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        51</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_WINDOW_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_WINDOW_TYPE_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote813_1620885733386">NOTE: There were 7 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote814_1620885733386">NOTE: The data set WORK.ENCODING_A_WINDOW_TYPE has 7 observations and 2 variables.</div><div class="sasNote" id="sasLogNote815_1620885733386">NOTE: Compressing data set WORK.ENCODING_A_WINDOW_TYPE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote816_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              561.93k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:06 AM</div><div class="sasNote">      Step Count                        189  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_WINDOW_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_WINDOW_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote817_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote818_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote819_1620885733386">NOTE: There were 7 observations read from the data set WORK.ENCODING_A_WINDOW_TYPE.</div><div class="sasNote" id="sasLogNote820_1620885733386">NOTE: The data set PUBLIC.ENCODING_A_WINDOW_TYPE has 7 observations and 2 variables.</div><div class="sasNote" id="sasLogNote821_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.08 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              904.68k</div><div class="sasNote">      OS Memory           36632.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:06 AM</div><div class="sasNote">      Step Count                        190  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     454</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        42</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote822_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_WINDOW_TYPE_id </div><div class="sasSource">from public.pbo_dictionary_ml as t1 left join public.encoding_A_WINDOW_TYPE as t2 on t1.A_WINDOW_TYPE = t2.A_WINDOW_TYPE ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote823_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 869 rows returned.</div><div class="sasNote" id="sasLogNote824_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote825_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.20 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.40k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        191  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        27</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote826_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_A_WINDOW_TYPE" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote827_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_A_WINDOW_TYPE in caslib Public to table encoding_A_WINDOW_TYPE in caslib </div><div class="sasNote">      public.</div><div class="sasNote" id="sasLogNote828_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.020386 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote829_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              230.34k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        192  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2445  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote830_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2446  create table public.abt12_ml{options replace=true} as</div><div class="sasSource">2447  select</div><div class="sasSource">2448  t1.PBO_LOCATION_ID,</div><div class="sasSource">2449  t1.PRODUCT_ID,</div><div class="sasSource">2450  t1.CHANNEL_CD,</div><div class="sasSource">2451  t1.SALES_DT,</div><div class="sasSource">2452  t1.sum_qty,</div><div class="sasSource">2453  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2454  t1.lag_halfyear_avg,</div><div class="sasSource">2455  t1.lag_halfyear_med,</div><div class="sasSource">2456  t1.lag_month_avg,</div><div class="sasSource">2457  t1.lag_month_med,</div><div class="sasSource">2458  t1.lag_qtr_avg,</div><div class="sasSource">2459  t1.lag_qtr_med,</div><div class="sasSource">2460  t1.lag_week_avg,</div><div class="sasSource">2461  t1.lag_week_med,</div><div class="sasSource">2462  t1.lag_year_avg,</div><div class="sasSource">2463  t1.lag_year_med,</div><div class="sasSource">2464  t1.lag_halfyear_std,</div><div class="sasSource">2465  t1.lag_month_std,</div><div class="sasSource">2466  t1.lag_qtr_std,</div><div class="sasSource">2467  t1.lag_week_std,</div><div class="sasSource">2468  t1.lag_year_std,</div><div class="sasSource">2469  t1.lag_halfyear_pct10,</div><div class="sasSource">2470  t1.lag_halfyear_pct90,</div><div class="sasSource">2471  t1.lag_month_pct10,</div><div class="sasSource">2472  t1.lag_month_pct90,</div><div class="sasSource">2473  t1.lag_qtr_pct10,</div><div class="sasSource">2474  t1.lag_qtr_pct90,</div><div class="sasSource">2475  t1.lag_week_pct10,</div><div class="sasSource">2476  t1.lag_week_pct90,</div><div class="sasSource">2477  t1.lag_year_pct10,</div><div class="sasSource">2478  t1.lag_year_pct90,</div><div class="sasSource">2479  &amp;promo_list_sql.,</div><div class="sasWarning" id="sasLogWarning18_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">2480   t1.NP_GIFT_PRICE_AMT,</div><div class="sasSource">2481  t1.side_promo_flag,</div><div class="sasSource">2482  t1.A_CPI,</div><div class="sasSource">2483  t1.A_GPD,</div><div class="sasSource">2484  t1.A_RDI,</div><div class="sasSource">2485  t1.TEMPERATURE,</div><div class="sasSource">2486  t1.PRECIPITATION,</div><div class="sasSource">2487  t1.comp_trp_BK,</div><div class="sasSource">2488  t1.comp_trp_KFC,</div><div class="sasSource">2489  t1.sum_trp,</div><div class="sasSource">2490  t1.prod_lvl4_id,</div><div class="sasSource">2491  t1.prod_lvl3_id,</div><div class="sasSource">2492  t1.prod_lvl2_id,</div><div class="sasSource">2493  t1.hero,</div><div class="sasSource">2494  t1.item_size,</div><div class="sasSource">2495  t1.offer_type,</div><div class="sasSource">2496  t1.price_tier,</div><div class="sasSource">2497  t2.lvl3_id,</div><div class="sasSource">2498  t2.lvl2_id,</div><div class="sasSource">2499  t2.A_AGREEMENT_TYPE_id as agreement_type,</div><div class="sasSource">2500  t2.A_BREAKFAST_id as breakfast,</div><div class="sasSource">2501  t2.A_BUILDING_TYPE_id as building_type,</div><div class="sasSource">2502  t2.A_COMPANY_id as company,</div><div class="sasSource">2503  t2.A_DELIVERY_id as delivery,</div><div class="sasSource">2504  t2.A_DRIVE_THRU_id as drive_thru,</div><div class="sasSource">2505  t2.A_MCCAFE_TYPE_id as mccafe_type,</div><div class="sasSource">2506  t2.A_PRICE_LEVEL_id as price_level,</div><div class="sasSource">2507  t2.A_WINDOW_TYPE_id as window_type</div><div class="sasSource">2508  from</div><div class="sasSource">2509  public.abt11_ml as t1</div><div class="sasSource">2510  left join</div><div class="sasSource">2511  public.pbo_dictionary_ml as t2</div><div class="sasSource">2512  on</div><div class="sasSource">2513  t1.pbo_location_id = t2.pbo_location_id</div><div class="sasSource">2514  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote831_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Syntax error at or near "PROMO_LIST_SQL."</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError52_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote832_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">2515  quit;</div><div class="sasNote" id="sasLogNote833_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              224.12k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        193  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">2516  proc casutil;</div><div class="sasNote" id="sasLogNote834_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2517    droptable casdata='ia_pbo_location' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote835_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01173 seconds.</div><div class="sasSource">2518    droptable casdata='IA_PBO_LOC_HIERARCHY' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote836_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.012852 seconds.</div><div class="sasSource">2519    droptable casdata='IA_PBO_LOC_ATTRIBUTES' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote837_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.012839 seconds.</div><div class="sasSource">2520    droptable casdata='pbo_hier_flat' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote838_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.009746 seconds.</div><div class="sasSource">2521    droptable casdata='attr_transposed' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote839_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.010683 seconds.</div><div class="sasSource">2522    droptable casdata='pbo_dictionary_ml' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote840_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.010847 seconds.</div><div class="sasSource">2523  /*   promote casdata="abt12_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2524    droptable casdata="abt11_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote841_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016418 seconds.</div><div class="sasSource">2525  run;</div><div class="sasSource">2526  /****** 13. Добавляем календарные признаки *******/</div><div class="sasNote" id="sasLogNote842_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.14 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              117.65k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        194  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        36</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2527  proc casutil;</div><div class="sasNote" id="sasLogNote843_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2528    droptable casdata="abt13_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote844_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.01578 seconds.</div><div class="sasSource">2529  run;</div><div class="sasSource">2530  %let first_date = '01jan2017'd;</div><div class="sasSource">2531  %let last_date = '31dec2021'd;</div><div class="sasNote" id="sasLogNote845_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.75k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        195  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        6</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2532  data work.cldr_prep;</div><div class="sasSource">2533  retain date &amp;first_date;</div><div class="sasSource">2534  do while(date &lt;= &amp;last_date);</div><div class="sasSource">2535  output;</div><div class="sasSource">2536  date + 1;</div><div class="sasSource">2537  end;</div><div class="sasSource">2538  format date ddmmyy10.;</div><div class="sasSource">2539  run;</div><div class="sasNote" id="sasLogNote846_1620885733386">NOTE: Compression was disabled for data set WORK.CLDR_PREP because compression overhead would increase the size of the data set.</div><div class="sasNote" id="sasLogNote847_1620885733386">NOTE: The data set WORK.CLDR_PREP has 1826 observations and 1 variables.</div><div class="sasNote" id="sasLogNote848_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              399.37k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        196  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     13</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           136</div><div class="sasNote">      </div><div class="sasSource">2540  proc sql;</div><div class="sasSource">2541  create table work.cldr_prep_features as</div><div class="sasSource">2542  select</div><div class="sasSource">2543  date,</div><div class="sasSource">2544  week(date) as week,</div><div class="sasSource">2545  weekday(date) as weekday,</div><div class="sasSource">2546  month(date) as month,</div><div class="sasSource">2547  (case</div><div class="sasSource">2548  when weekday(date) in (1, 7) then 1</div><div class="sasSource">2549  else 0</div><div class="sasSource">2550  end) as weekend_flag</div><div class="sasSource">2551  from</div><div class="sasSource">2552  work.cldr_prep</div><div class="sasSource">2553  ;</div><div class="sasNote" id="sasLogNote849_1620885733386">NOTE: Compressing data set WORK.CLDR_PREP_FEATURES increased size by 50.00 percent. </div><div class="sasNote">      Compressed is 3 pages; un-compressed would require 2 pages.</div><div class="sasNote" id="sasLogNote850_1620885733386">NOTE: Table WORK.CLDR_PREP_FEATURES created, with 1826 rows and 5 columns.</div><div class="sasSource">2554  quit;</div><div class="sasNote" id="sasLogNote851_1620885733386">NOTE: PROCEDURE SQL used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              5385.03k</div><div class="sasNote">      OS Memory           41240.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        197  Switch Count  0</div><div class="sasNote">      Page Faults                       1</div><div class="sasNote">      Page Reclaims                     155</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            160</div><div class="sasNote">      Block Output Operations           400</div><div class="sasNote">      </div><div class="sasSource">2555  /* Список выходных дней в РФ с 2017 по 2021 */</div><div class="sasSource">2556  data work.russia_weekend;</div><div class="sasSource">2557  input date :yymmdd10.;</div><div class="sasSource">2558  format date yymmddd10.;</div><div class="sasSource">2559  datalines;</div><div class="sasNote" id="sasLogNote852_1620885733386">NOTE: Compression was disabled for data set WORK.RUSSIA_WEEKEND because compression overhead would increase the size of the data </div><div class="sasNote">      set.</div><div class="sasNote" id="sasLogNote853_1620885733386">NOTE: The data set WORK.RUSSIA_WEEKEND has 72 observations and 1 variables.</div><div class="sasNote" id="sasLogNote854_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              405.40k</div><div class="sasNote">      OS Memory           36116.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        198  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     15</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           144</div><div class="sasNote">      </div><div class="sasSource">2632  ;</div><div class="sasSource">2633  run;</div><div class="sasSource">2634  /* Объединяем государственные выходные с субботой и воскресеньем */</div><div class="sasSource">2635  proc sql;</div><div class="sasSource">2636  create table work.cldr_prep_features2 as</div><div class="sasSource">2637  select</div><div class="sasSource">2638  t1.date,</div><div class="sasSource">2639  t1.week,</div><div class="sasSource">2640  t1.weekday,</div><div class="sasSource">2641  t1.month,</div><div class="sasSource">2642  case</div><div class="sasSource">2643  when t2.date is not missing then 1</div><div class="sasSource">2644  else t1.weekend_flag</div><div class="sasSource">2645  end as weekend_flag</div><div class="sasSource">2646  from</div><div class="sasSource">2647  work.cldr_prep_features as t1</div><div class="sasSource">2648  left join</div><div class="sasSource">2649  work.russia_weekend as t2</div><div class="sasSource">2650  on</div><div class="sasSource">2651  t1.date = t2.date</div><div class="sasSource">2652  ;</div><div class="sasNote" id="sasLogNote855_1620885733386">NOTE: Compressing data set WORK.CLDR_PREP_FEATURES2 increased size by 50.00 percent. </div><div class="sasNote">      Compressed is 3 pages; un-compressed would require 2 pages.</div><div class="sasNote" id="sasLogNote856_1620885733386">NOTE: Table WORK.CLDR_PREP_FEATURES2 created, with 1826 rows and 5 columns.</div><div class="sasSource">2653  quit;</div><div class="sasNote" id="sasLogNote857_1620885733386">NOTE: PROCEDURE SQL used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              5602.93k</div><div class="sasNote">      OS Memory           41240.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        199  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     275</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        3</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            32</div><div class="sasNote">      Block Output Operations           816</div><div class="sasNote">      </div><div class="sasSource">2654  proc casutil;</div><div class="sasNote" id="sasLogNote858_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2655    load data=work.cldr_prep_features2 casout='cldr_prep_features' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote859_1620885733386">NOTE: WORK.CLDR_PREP_FEATURES2 was successfully added to the "Public" caslib as "CLDR_PREP_FEATURES".</div><div class="sasSource">2656  run;</div><div class="sasSource">2657  /* Добавляем к витрине */</div><div class="sasNote" id="sasLogNote860_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1052.87k</div><div class="sasNote">      OS Memory           37144.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        200  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     46</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2658  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote861_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2659  create table public.abt13_ml{options replace = true} as</div><div class="sasSource">2660  select</div><div class="sasSource">2661  t1.PBO_LOCATION_ID,</div><div class="sasSource">2662  t1.PRODUCT_ID,</div><div class="sasSource">2663  t1.CHANNEL_CD,</div><div class="sasSource">2664  t1.SALES_DT,</div><div class="sasSource">2665  t1.sum_qty,</div><div class="sasSource">2666  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2667  t1.lag_halfyear_avg,</div><div class="sasSource">2668  t1.lag_halfyear_med,</div><div class="sasSource">2669  t1.lag_month_avg,</div><div class="sasSource">2670  t1.lag_month_med,</div><div class="sasSource">2671  t1.lag_qtr_avg,</div><div class="sasSource">2672  t1.lag_qtr_med,</div><div class="sasSource">2673  t1.lag_week_avg,</div><div class="sasSource">2674  t1.lag_week_med,</div><div class="sasSource">2675  t1.lag_year_avg,</div><div class="sasSource">2676  t1.lag_year_med,</div><div class="sasSource">2677  t1.lag_halfyear_std,</div><div class="sasSource">2678  t1.lag_month_std,</div><div class="sasSource">2679  t1.lag_qtr_std,</div><div class="sasSource">2680  t1.lag_week_std,</div><div class="sasSource">2681  t1.lag_year_std,</div><div class="sasSource">2682  t1.lag_halfyear_pct10,</div><div class="sasSource">2683  t1.lag_halfyear_pct90,</div><div class="sasSource">2684  t1.lag_month_pct10,</div><div class="sasSource">2685  t1.lag_month_pct90,</div><div class="sasSource">2686  t1.lag_qtr_pct10,</div><div class="sasSource">2687  t1.lag_qtr_pct90,</div><div class="sasSource">2688  t1.lag_week_pct10,</div><div class="sasSource">2689  t1.lag_week_pct90,</div><div class="sasSource">2690  t1.lag_year_pct10,</div><div class="sasSource">2691  t1.lag_year_pct90,</div><div class="sasSource">2692  &amp;promo_list_sql.,</div><div class="sasWarning" id="sasLogWarning19_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">2693   t1.NP_GIFT_PRICE_AMT,</div><div class="sasSource">2694  t1.side_promo_flag,</div><div class="sasSource">2695  t1.A_CPI,</div><div class="sasSource">2696  t1.A_GPD,</div><div class="sasSource">2697  t1.A_RDI,</div><div class="sasSource">2698  t1.TEMPERATURE,</div><div class="sasSource">2699  t1.PRECIPITATION,</div><div class="sasSource">2700  t1.comp_trp_BK,</div><div class="sasSource">2701  t1.comp_trp_KFC,</div><div class="sasSource">2702  t1.sum_trp,</div><div class="sasSource">2703  t1.prod_lvl4_id,</div><div class="sasSource">2704  t1.prod_lvl3_id,</div><div class="sasSource">2705  t1.prod_lvl2_id,</div><div class="sasSource">2706  t1.hero,</div><div class="sasSource">2707  t1.item_size,</div><div class="sasSource">2708  t1.offer_type,</div><div class="sasSource">2709  t1.price_tier,</div><div class="sasSource">2710  t1.lvl3_id,</div><div class="sasSource">2711  t1.lvl2_id,</div><div class="sasSource">2712  t1.agreement_type,</div><div class="sasSource">2713  t1.breakfast,</div><div class="sasSource">2714  t1.building_type,</div><div class="sasSource">2715  t1.company,</div><div class="sasSource">2716  t1.delivery,</div><div class="sasSource">2717  t1.drive_thru,</div><div class="sasSource">2718  t1.mccafe_type,</div><div class="sasSource">2719  t1.price_level,</div><div class="sasSource">2720  t1.window_type,</div><div class="sasSource">2721  t2.week,</div><div class="sasSource">2722  t2.weekday,</div><div class="sasSource">2723  t2.month,</div><div class="sasSource">2724  t2.weekend_flag</div><div class="sasSource">2725  from</div><div class="sasSource">2726  public.abt12_ml as t1</div><div class="sasSource">2727  left join</div><div class="sasSource">2728  public.cldr_prep_features as t2</div><div class="sasSource">2729  on</div><div class="sasSource">2730  t1.sales_dt = t2.date</div><div class="sasSource">2731  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote862_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Syntax error at or near "PROMO_LIST_SQL."</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError53_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote863_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">2732  quit;</div><div class="sasNote" id="sasLogNote864_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              225.31k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        201  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           40</div><div class="sasNote">      </div><div class="sasSource">2733  /******  14. Добавим события ******/</div><div class="sasSource">2734  proc casutil;</div><div class="sasNote" id="sasLogNote865_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2735  </div><div class="sasSource">2735!  droptable casdata="russia_event" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote866_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.019143 seconds.</div><div class="sasSource">2736  </div><div class="sasSource">2736!  droptable casdata="russia_event2" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote867_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.018838 seconds.</div><div class="sasSource">2737  </div><div class="sasSource">2737!  droptable casdata="russia_event_t" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote868_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.017615 seconds.</div><div class="sasSource">2738  </div><div class="sasSource">2738!  droptable casdata="abt14_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote869_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015316 seconds.</div><div class="sasSource">2739  /* promote casdata="abt13_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2740      droptable casdata="abt12_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote870_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016966 seconds.</div><div class="sasSource">2741  run;</div><div class="sasNote" id="sasLogNote871_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              117.09k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        202  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        25</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2742  data work.russia_event;</div><div class="sasSource">2743  input date :yymmdd10. event_nm $32.;</div><div class="sasSource">2744  format date yymmddd10.;</div><div class="sasSource">2745  datalines;</div><div class="sasNote" id="sasLogNote872_1620885733386">NOTE: The data set WORK.RUSSIA_EVENT has 132 observations and 2 variables.</div><div class="sasNote" id="sasLogNote873_1620885733386">NOTE: Compressing data set WORK.RUSSIA_EVENT increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote874_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              407.37k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        203  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     12</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">2878  ;</div><div class="sasSource">2879  run;</div><div class="sasSource">2880  /* загружаем таблицу в cas */</div><div class="sasSource">2881  proc casutil;</div><div class="sasNote" id="sasLogNote875_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2882    load data=work.russia_event casout='russia_event' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote876_1620885733386">NOTE: WORK.RUSSIA_EVENT was successfully added to the "Public" caslib as "RUSSIA_EVENT".</div><div class="sasSource">2883  run;</div><div class="sasSource">2884  /* добваляем константный флаг */</div><div class="sasNote" id="sasLogNote877_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              968.34k</div><div class="sasNote">      OS Memory           37144.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        204  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     15</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2885  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote878_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2886  create table public.russia_event2{options replace=true} as</div><div class="sasSource">2887  select *, 1 as event_flag from public.russia_event;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote879_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table RUSSIA_EVENT2 was created in caslib Public with 132 rows returned.</div><div class="sasNote" id="sasLogNote880_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2888  quit;</div><div class="sasNote" id="sasLogNote881_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.15 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              83.43k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        205  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        25</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2889  /* транспонируем таблицу */</div><div class="sasSource">2890  proc cas;</div><div class="sasSource">2891  transpose.transpose /</div><div class="sasSource">2892     table={name="russia_event2", caslib="public", groupby={"date"}}</div><div class="sasSource">2893     attributes={{name="date"}}</div><div class="sasSource">2894     transpose={"event_flag"}</div><div class="sasSource">2895     id={"event_nm"}</div><div class="sasSource">2896     casout={name="russia_event_t", caslib="public", replace=true};</div><div class="sasSource">2897  quit;</div><div class="sasNote" id="sasLogNote882_1620885733386">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote883_1620885733386">NOTE: There were 132 rows read from the table RUSSIA_EVENT2.</div><div class="sasNote" id="sasLogNote884_1620885733386">NOTE: The table russia_event_t has 132 rows and 11 columns.</div><div class="sasNote" id="sasLogNote885_1620885733386">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10018.50k</div><div class="sasNote">      OS Memory           46464.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        206  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     981</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        15</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2898  /* добавляем к ваитрине */</div><div class="sasSource">2899  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote886_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2900  create table public.abt14_ml{options replace=true} as</div><div class="sasSource">2901  select</div><div class="sasSource">2902  t1.PBO_LOCATION_ID,</div><div class="sasSource">2903  t1.PRODUCT_ID,</div><div class="sasSource">2904  t1.CHANNEL_CD,</div><div class="sasSource">2905  t1.SALES_DT,</div><div class="sasSource">2906  t1.sum_qty,</div><div class="sasSource">2907  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2908  t1.lag_halfyear_avg,</div><div class="sasSource">2909  t1.lag_halfyear_med,</div><div class="sasSource">2910  t1.lag_month_avg,</div><div class="sasSource">2911  t1.lag_month_med,</div><div class="sasSource">2912  t1.lag_qtr_avg,</div><div class="sasSource">2913  t1.lag_qtr_med,</div><div class="sasSource">2914  t1.lag_week_avg,</div><div class="sasSource">2915  t1.lag_week_med,</div><div class="sasSource">2916  t1.lag_year_avg,</div><div class="sasSource">2917  t1.lag_year_med,</div><div class="sasSource">2918  t1.lag_halfyear_std,</div><div class="sasSource">2919  t1.lag_month_std,</div><div class="sasSource">2920  t1.lag_qtr_std,</div><div class="sasSource">2921  t1.lag_week_std,</div><div class="sasSource">2922  t1.lag_year_std,</div><div class="sasSource">2923  t1.lag_halfyear_pct10,</div><div class="sasSource">2924  t1.lag_halfyear_pct90,</div><div class="sasSource">2925  t1.lag_month_pct10,</div><div class="sasSource">2926  t1.lag_month_pct90,</div><div class="sasSource">2927  t1.lag_qtr_pct10,</div><div class="sasSource">2928  t1.lag_qtr_pct90,</div><div class="sasSource">2929  t1.lag_week_pct10,</div><div class="sasSource">2930  t1.lag_week_pct90,</div><div class="sasSource">2931  t1.lag_year_pct10,</div><div class="sasSource">2932  t1.lag_year_pct90,</div><div class="sasSource">2933  &amp;promo_list_sql.,</div><div class="sasWarning" id="sasLogWarning20_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">2934   t1.NP_GIFT_PRICE_AMT,</div><div class="sasSource">2935  t1.side_promo_flag,</div><div class="sasSource">2936  t1.A_CPI,</div><div class="sasSource">2937  t1.A_GPD,</div><div class="sasSource">2938  t1.A_RDI,</div><div class="sasSource">2939  t1.TEMPERATURE,</div><div class="sasSource">2940  t1.PRECIPITATION,</div><div class="sasSource">2941  t1.comp_trp_BK,</div><div class="sasSource">2942  t1.comp_trp_KFC,</div><div class="sasSource">2943  t1.sum_trp,</div><div class="sasSource">2944  t1.prod_lvl4_id,</div><div class="sasSource">2945  t1.prod_lvl3_id,</div><div class="sasSource">2946  t1.prod_lvl2_id,</div><div class="sasSource">2947  t1.hero,</div><div class="sasSource">2948  t1.item_size,</div><div class="sasSource">2949  t1.offer_type,</div><div class="sasSource">2950  t1.price_tier,</div><div class="sasSource">2951  t1.lvl3_id,</div><div class="sasSource">2952  t1.lvl2_id,</div><div class="sasSource">2953  t1.agreement_type,</div><div class="sasSource">2954  t1.breakfast,</div><div class="sasSource">2955  t1.building_type,</div><div class="sasSource">2956  t1.company,</div><div class="sasSource">2957  t1.delivery,</div><div class="sasSource">2958  t1.drive_thru,</div><div class="sasSource">2959  t1.mccafe_type,</div><div class="sasSource">2960  t1.price_level,</div><div class="sasSource">2961  t1.window_type,</div><div class="sasSource">2962  t1.week,</div><div class="sasSource">2963  t1.weekday,</div><div class="sasSource">2964  t1.month,</div><div class="sasSource">2965  t1.weekend_flag,</div><div class="sasSource">2966  coalesce(t2.defender_day, 0) as defender_day,</div><div class="sasSource">2967  coalesce(t2.female_day, 0) as female_day,</div><div class="sasSource">2968  coalesce(t2.may_holiday, 0) as may_holiday,</div><div class="sasSource">2969  coalesce(t2.new_year , 0) as new_year,</div><div class="sasSource">2970  coalesce(t2.russia_day, 0) as russia_day,</div><div class="sasSource">2971  coalesce(t2.school_start, 0) as school_start,</div><div class="sasSource">2972  coalesce(t2.student_day, 0) as student_day,</div><div class="sasSource">2973  coalesce(t2.summer_start, 0) as summer_start,</div><div class="sasSource">2974  coalesce(t2.valentine_day, 0) as valentine_day</div><div class="sasSource">2975  from</div><div class="sasSource">2976  public.abt13_ml as t1</div><div class="sasSource">2977  left join</div><div class="sasSource">2978  public.russia_event_t as t2</div><div class="sasSource">2979  on</div><div class="sasSource">2980  t1.sales_dt = t2.date</div><div class="sasSource">2981  ;</div><div class="sasSource">2981!   </div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote887_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Syntax error at or near "PROMO_LIST_SQL."</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError54_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote888_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">2982  quit;</div><div class="sasNote" id="sasLogNote889_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              226.31k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:07 AM</div><div class="sasNote">      Step Count                        207  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           48</div><div class="sasNote">      </div><div class="sasSource">2983  proc casutil;</div><div class="sasNote" id="sasLogNote890_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2984  </div><div class="sasSource">2984!  droptable casdata="russia_event" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote891_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.011388 seconds.</div><div class="sasSource">2985  </div><div class="sasSource">2985!  droptable casdata="russia_event2" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote892_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.010879 seconds.</div><div class="sasSource">2986  </div><div class="sasSource">2986!  droptable casdata="russia_event_t" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote893_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.013713 seconds.</div><div class="sasSource">2987  /* promote casdata="abt14_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2988      droptable casdata="abt13_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote894_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.017139 seconds.</div><div class="sasSource">2989  run;</div><div class="sasSource">2990  /******15. Добавим ценовые ранги ******/</div><div class="sasNote" id="sasLogNote895_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              116.53k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        208  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        21</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2991  proc casutil;</div><div class="sasNote" id="sasLogNote896_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">2992  </div><div class="sasSource">2992!  droptable casdata="abt15_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote897_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016386 seconds.</div><div class="sasSource">2993  </div><div class="sasSource">2993!  droptable casdata="unique_day_price" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote898_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.018466 seconds.</div><div class="sasSource">2994  </div><div class="sasSource">2994!  droptable casdata="sum_count_price" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote899_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016592 seconds.</div><div class="sasSource">2995  </div><div class="sasSource">2995!  droptable casdata="price_rank" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote900_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.014349 seconds.</div><div class="sasSource">2996  </div><div class="sasSource">2996!  droptable casdata="price_rank2" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote901_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016363 seconds.</div><div class="sasSource">2997  </div><div class="sasSource">2997!  droptable casdata="price_rank3" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote902_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.017899 seconds.</div><div class="sasSource">2998  </div><div class="sasSource">2998!  droptable casdata="price_feature" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote903_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.017887 seconds.</div><div class="sasSource">2999  </div><div class="sasSource">3000  run;</div><div class="sasSource">3001  /* уникальные ПБО/день/категория товаров/товар/цена */</div><div class="sasNote" id="sasLogNote904_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.18 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              117.56k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        209  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        36</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">3002  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote905_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3003  create table public.unique_day_price as</div><div class="sasSource">3004  select distinct</div><div class="sasSource">3005  t1.pbo_location_id,</div><div class="sasSource">3006  t1.PROD_LVL3_ID,</div><div class="sasSource">3007  t1.sales_dt,</div><div class="sasSource">3008  t1.product_id,</div><div class="sasSource">3009  t1.GROSS_PRICE_AMT</div><div class="sasSource">3010  from</div><div class="sasSource">3011  public.abt14_ml as t1</div><div class="sasSource">3012  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote906_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.ABT14_ML" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError55_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote907_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">3013  quit;</div><div class="sasNote" id="sasLogNote908_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.90k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        210  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">3014  /* Считаем суммарную цену в групе и количество товаров */</div><div class="sasSource">3015  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote909_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3016  create table public.sum_count_price{options replace = true} as</div><div class="sasSource">3017  select</div><div class="sasSource">3018  t1.pbo_location_id,</div><div class="sasSource">3019  t1.PROD_LVL3_ID,</div><div class="sasSource">3020  t1.sales_dt,</div><div class="sasSource">3021  count(t1.product_id) as count_product,</div><div class="sasSource">3022  sum(t1.GROSS_PRICE_AMT) as sum_gross_price_amt</div><div class="sasSource">3023  from public.unique_day_price as t1</div><div class="sasSource">3024  group by</div><div class="sasSource">3025  t1.pbo_location_id,</div><div class="sasSource">3026  t1.PROD_LVL3_ID,</div><div class="sasSource">3027  t1.sales_dt</div><div class="sasSource">3028  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote910_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.UNIQUE_DAY_PRICE" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError56_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote911_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">3029  quit;</div><div class="sasNote" id="sasLogNote912_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.90k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        211  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        28</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">3030  /* считаем позицию товара в отсортированном списке цен */</div><div class="sasSource">3031  data public.price_rank;</div><div class="sasSource">3032  set public.unique_day_price;</div><div class="sasNote" id="sasLogNote913_1620885733386">NOTE: The table PUBLIC.UNIQUE_DAY_PRICE does not exist in Cloud Analytic Services.</div><div class="sasError" id="sasLogError57_1620885733386">ERROR: File PUBLIC.UNIQUE_DAY_PRICE.DATA does not exist.</div><div class="sasSource">3033  by pbo_location_id sales_dt PROD_LVL3_ID GROSS_PRICE_AMT ;</div><div class="sasSource">3034  if first.PROD_LVL3_ID then i = 0;</div><div class="sasSource">3035  if GROSS_PRICE_AMT ^= lag(GROSS_PRICE_AMT) then i+1;</div><div class="sasSource">3036  run;</div><div class="sasNote" id="sasLogNote914_1620885733386">NOTE: The SAS System stopped processing this step because of errors.</div><div class="sasWarning" id="sasLogWarning21_1620885733386">WARNING: The data set PUBLIC.PRICE_RANK may be incomplete.  When this step was stopped there were 0 observations and 2 variables.</div><div class="sasWarning" id="sasLogWarning22_1620885733386">WARNING: Data set PUBLIC.PRICE_RANK was not replaced because this step was stopped.</div><div class="sasNote" id="sasLogNote915_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              334.31k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        212  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     8</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        10</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">3037  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote916_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3038  create table public.price_rank2{options replace=true} as</div><div class="sasSource">3039  select</div><div class="sasSource">3040  t1.pbo_location_id,</div><div class="sasSource">3041  t1.sales_dt,</div><div class="sasSource">3042  t1.PROD_LVL3_ID,</div><div class="sasSource">3043  max(t1.i) as max_i</div><div class="sasSource">3044  from</div><div class="sasSource">3045  public.price_rank as t1</div><div class="sasSource">3046  group by</div><div class="sasSource">3047  t1.pbo_location_id,</div><div class="sasSource">3048  t1.sales_dt,</div><div class="sasSource">3049  t1.PROD_LVL3_ID</div><div class="sasSource">3050  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote917_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.PRICE_RANK" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError58_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote918_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">3051  quit;</div><div class="sasNote" id="sasLogNote919_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.12k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        213  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        28</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">3052  /* Соединяем таблицы price_rank, price_rank2 */</div><div class="sasSource">3053  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote920_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3054  create table public.price_rank3{options replace=true} as</div><div class="sasSource">3055  select</div><div class="sasSource">3056  t1.product_id,</div><div class="sasSource">3057  t1.pbo_location_id,</div><div class="sasSource">3058  t1.PROD_LVL3_ID,</div><div class="sasSource">3059  t1.sales_dt,</div><div class="sasSource">3060  t1.GROSS_PRICE_AMT,</div><div class="sasSource">3061  t1.i,</div><div class="sasSource">3062  t2.max_i</div><div class="sasSource">3063  from</div><div class="sasSource">3064  public.price_rank as t1</div><div class="sasSource">3065  left join</div><div class="sasSource">3066  public.price_rank2 as t2</div><div class="sasSource">3067  on</div><div class="sasSource">3068  t1.pbo_location_id = t2.pbo_location_id and</div><div class="sasSource">3069  t1.PROD_LVL3_ID = t2.PROD_LVL3_ID and</div><div class="sasSource">3070  t1.sales_dt = t2.sales_dt</div><div class="sasSource">3071  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote921_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.PRICE_RANK" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError59_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote922_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">3072  quit;</div><div class="sasNote" id="sasLogNote923_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.12k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        214  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        28</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">3073  /* Соединяем таблицы price_rank3 и sum_count_price */</div><div class="sasSource">3074  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote924_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3075  create table public.price_feature{options replace=true} as</div><div class="sasSource">3076  select</div><div class="sasSource">3077  t1.product_id,</div><div class="sasSource">3078  t1.pbo_location_id,</div><div class="sasSource">3079  t1.PROD_LVL3_ID,</div><div class="sasSource">3080  t1.sales_dt,</div><div class="sasSource">3081  t1.GROSS_PRICE_AMT,</div><div class="sasSource">3082  t1.i,</div><div class="sasSource">3083  t1.max_i,</div><div class="sasSource">3084  t2.count_product,</div><div class="sasSource">3085  t2.sum_gross_price_amt,</div><div class="sasSource">3086  divide(t1.i,t1.max_i) as price_rank,</div><div class="sasSource">3087  (</div><div class="sasSource">3088  case</div><div class="sasSource">3089  when t2.sum_gross_price_amt = t1.GROSS_PRICE_AMT then 1</div><div class="sasSource">3090  else divide(t1.GROSS_PRICE_AMT,divide((t2.sum_gross_price_amt - t1.GROSS_PRICE_AMT),(t2.count_product - 1)))</div><div class="sasSource">3091  end</div><div class="sasSource">3092  ) as price_index</div><div class="sasSource">3093  from</div><div class="sasSource">3094  public.price_rank3 as t1</div><div class="sasSource">3095  left join</div><div class="sasSource">3096  public.sum_count_price as t2</div><div class="sasSource">3097  on</div><div class="sasSource">3098  t1.pbo_location_id = t2.pbo_location_id and</div><div class="sasSource">3099  t1.PROD_LVL3_ID = t2.PROD_LVL3_ID and</div><div class="sasSource">3100  t1.sales_dt = t2.sales_dt</div><div class="sasSource">3101  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote925_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.PRICE_RANK3" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError60_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote926_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">3102  quit;</div><div class="sasNote" id="sasLogNote927_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              102.18k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        215  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">3103  /* Добавляем в витрину */</div><div class="sasSource">3104  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote928_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3105  create table public.abt15_ml{options replace=true} as</div><div class="sasSource">3106  select</div><div class="sasSource">3107  t1.PBO_LOCATION_ID,</div><div class="sasSource">3108  t1.PRODUCT_ID,</div><div class="sasSource">3109  t1.CHANNEL_CD,</div><div class="sasSource">3110  t1.SALES_DT,</div><div class="sasSource">3111  t1.sum_qty,</div><div class="sasSource">3112  t1.GROSS_PRICE_AMT,</div><div class="sasSource">3113  t1.lag_halfyear_avg,</div><div class="sasSource">3114  t1.lag_halfyear_med,</div><div class="sasSource">3115  t1.lag_month_avg,</div><div class="sasSource">3116  t1.lag_month_med,</div><div class="sasSource">3117  t1.lag_qtr_avg,</div><div class="sasSource">3118  t1.lag_qtr_med,</div><div class="sasSource">3119  t1.lag_week_avg,</div><div class="sasSource">3120  t1.lag_week_med,</div><div class="sasSource">3121  t1.lag_year_avg,</div><div class="sasSource">3122  t1.lag_year_med,</div><div class="sasSource">3123  t1.lag_halfyear_std,</div><div class="sasSource">3124  t1.lag_month_std,</div><div class="sasSource">3125  t1.lag_qtr_std,</div><div class="sasSource">3126  t1.lag_week_std,</div><div class="sasSource">3127  t1.lag_year_std,</div><div class="sasSource">3128  t1.lag_halfyear_pct10,</div><div class="sasSource">3129  t1.lag_halfyear_pct90,</div><div class="sasSource">3130  t1.lag_month_pct10,</div><div class="sasSource">3131  t1.lag_month_pct90,</div><div class="sasSource">3132  t1.lag_qtr_pct10,</div><div class="sasSource">3133  t1.lag_qtr_pct90,</div><div class="sasSource">3134  t1.lag_week_pct10,</div><div class="sasSource">3135  t1.lag_week_pct90,</div><div class="sasSource">3136  t1.lag_year_pct10,</div><div class="sasSource">3137  t1.lag_year_pct90,</div><div class="sasSource">3138  &amp;promo_list_sql.,</div><div class="sasWarning" id="sasLogWarning23_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">3139   t1.NP_GIFT_PRICE_AMT,</div><div class="sasSource">3140  t1.side_promo_flag,</div><div class="sasSource">3141  t1.A_CPI,</div><div class="sasSource">3142  t1.A_GPD,</div><div class="sasSource">3143  t1.A_RDI,</div><div class="sasSource">3144  t1.TEMPERATURE,</div><div class="sasSource">3145  t1.PRECIPITATION,</div><div class="sasSource">3146  t1.comp_trp_BK,</div><div class="sasSource">3147  t1.comp_trp_KFC,</div><div class="sasSource">3148  t1.sum_trp,</div><div class="sasSource">3149  t1.prod_lvl4_id,</div><div class="sasSource">3150  t1.prod_lvl3_id,</div><div class="sasSource">3151  t1.prod_lvl2_id,</div><div class="sasSource">3152  t1.hero,</div><div class="sasSource">3153  t1.item_size,</div><div class="sasSource">3154  t1.offer_type,</div><div class="sasSource">3155  t1.price_tier,</div><div class="sasSource">3156  t1.lvl3_id,</div><div class="sasSource">3157  t1.lvl2_id,</div><div class="sasSource">3158  t1.agreement_type,</div><div class="sasSource">3159  t1.breakfast,</div><div class="sasSource">3160  t1.building_type,</div><div class="sasSource">3161  t1.company,</div><div class="sasSource">3162  t1.delivery,</div><div class="sasSource">3163  t1.drive_thru,</div><div class="sasSource">3164  t1.mccafe_type,</div><div class="sasSource">3165  t1.price_level,</div><div class="sasSource">3166  t1.window_type,</div><div class="sasSource">3167  t1.week,</div><div class="sasSource">3168  t1.weekday,</div><div class="sasSource">3169  t1.month,</div><div class="sasSource">3170  t1.weekend_flag,</div><div class="sasSource">3171  t1.defender_day,</div><div class="sasSource">3172  t1.female_day,</div><div class="sasSource">3173  t1.may_holiday,</div><div class="sasSource">3174  t1.new_year,</div><div class="sasSource">3175  t1.russia_day,</div><div class="sasSource">3176  t1.school_start,</div><div class="sasSource">3177  t1.student_day,</div><div class="sasSource">3178  t1.summer_start,</div><div class="sasSource">3179  t1.valentine_day,</div><div class="sasSource">3180  t2.price_rank,</div><div class="sasSource">3181  t2.price_index</div><div class="sasSource">3182  from</div><div class="sasSource">3183  public.abt14_ml as t1</div><div class="sasSource">3184  left join</div><div class="sasSource">3185  public.price_feature as t2</div><div class="sasSource">3186  on</div><div class="sasSource">3187  t1.pbo_location_id = t2.pbo_location_id and</div><div class="sasSource">3188  t1.product_id = t2.product_id and</div><div class="sasSource">3189  t1.sales_dt = t2.sales_dt</div><div class="sasSource">3190  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote929_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Syntax error at or near "PROMO_LIST_SQL."</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError61_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote930_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">3191  quit;</div><div class="sasNote" id="sasLogNote931_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              226.31k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        216  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           48</div><div class="sasNote">      </div><div class="sasSource">3192  proc casutil;</div><div class="sasNote" id="sasLogNote932_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">3193  </div><div class="sasSource">3193!  droptable casdata="unique_day_price" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote933_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.013573 seconds.</div><div class="sasSource">3194  </div><div class="sasSource">3194!  droptable casdata="sum_count_price" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote934_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.014738 seconds.</div><div class="sasSource">3195  </div><div class="sasSource">3195!  droptable casdata="price_rank" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote935_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015354 seconds.</div><div class="sasSource">3196  </div><div class="sasSource">3196!  droptable casdata="price_rank2" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote936_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016586 seconds.</div><div class="sasSource">3197  </div><div class="sasSource">3197!  droptable casdata="price_rank3" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote937_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.016646 seconds.</div><div class="sasSource">3198  </div><div class="sasSource">3198!  droptable casdata="price_feature" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote938_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.017914 seconds.</div><div class="sasSource">3199  /* promote casdata="abt15_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">3200      droptable casdata="abt14_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote939_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015255 seconds.</div><div class="sasSource">3201  run;</div><div class="sasSource">3202  /******16. Перекодируем channel_cd  ******/</div><div class="sasNote" id="sasLogNote940_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.16 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              117.65k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        217  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        39</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">3203  proc casutil;</div><div class="sasNote" id="sasLogNote941_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">3204  </div><div class="sasSource">3204!  droptable casdata="units_abt_NOV_DEC_JAN" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote942_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015105 seconds.</div><div class="sasSource">3205  run;</div><div class="sasSource">3206  %text_encoding(public.abt15_ml, channel_cd)</div><div class="sasNote" id="sasLogNote943_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              121.84k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        218  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     8</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        6</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote944_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_channel_cd" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote945_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.015789 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote946_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              115.12k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        219  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote947_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct channel_cd from public.abt15_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote948_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.ABT15_ML" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError62_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote949_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote950_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.43k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:08 AM</div><div class="sasNote">      Step Count                        220  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        28</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote951_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote952_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote953_1620885733386">NOTE: There were 7 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote954_1620885733386">NOTE: The data set WORK.UNIQUE has 7 observations and 1 variables.</div><div class="sasNote" id="sasLogNote955_1620885733386">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote956_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.10 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              538.81k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:09 AM</div><div class="sasNote">      Step Count                        221  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     323</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        54</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_channel_cd;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   channel_cd_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote957_1620885733386">NOTE: There were 7 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote958_1620885733386">NOTE: The data set WORK.ENCODING_CHANNEL_CD has 7 observations and 2 variables.</div><div class="sasNote" id="sasLogNote959_1620885733386">NOTE: Compressing data set WORK.ENCODING_CHANNEL_CD increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote960_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              561.90k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:09 AM</div><div class="sasNote">      Step Count                        222  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_channel_cd;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_channel_cd;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote961_1620885733386">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote962_1620885733386">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote963_1620885733386">NOTE: There were 7 observations read from the data set WORK.ENCODING_CHANNEL_CD.</div><div class="sasNote" id="sasLogNote964_1620885733386">NOTE: The data set PUBLIC.ENCODING_CHANNEL_CD has 7 observations and 2 variables.</div><div class="sasNote" id="sasLogNote965_1620885733386">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              905.43k</div><div class="sasNote">      OS Memory           37144.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:09 AM</div><div class="sasNote">      Step Count                        223  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     454</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        42</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote966_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.abt15_ml{options replace=true} as select t1.*, t2.channel_cd_id from </div><div class="sasSource">public.abt15_ml as t1 left join public.encoding_channel_cd as t2 on t1.channel_cd = t2.channel_cd ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote967_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Table "PUBLIC.ABT15_ML" does not exist or cannot be accessed</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError63_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote968_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote969_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              85.12k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:09 AM</div><div class="sasNote">      Step Count                        224  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote970_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_channel_cd" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote971_1620885733386">NOTE: Cloud Analytic Services promoted table ENCODING_CHANNEL_CD in caslib Public to table encoding_channel_cd in caslib public.</div><div class="sasNote" id="sasLogNote972_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.025501 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">3207  /* Заменяем текстовое поле на числовое */</div><div class="sasNote" id="sasLogNote973_1620885733386">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              230.71k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:09 AM</div><div class="sasNote">      Step Count                        225  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     8</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        33</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">3208  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote974_1620885733386">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3209  create table public.units_abt_NOV_DEC_JAN{options replace=true} as</div><div class="sasSource">3210  select</div><div class="sasSource">3211  t1.PBO_LOCATION_ID,</div><div class="sasSource">3212  t1.PRODUCT_ID,</div><div class="sasSource">3213  t1.CHANNEL_CD as channel_cd,</div><div class="sasSource">3214  t1.SALES_DT,</div><div class="sasSource">3215  t1.sum_qty,</div><div class="sasSource">3216  t1.GROSS_PRICE_AMT,</div><div class="sasSource">3217  t1.lag_halfyear_avg,</div><div class="sasSource">3218  t1.lag_halfyear_med,</div><div class="sasSource">3219  t1.lag_month_avg,</div><div class="sasSource">3220  t1.lag_month_med,</div><div class="sasSource">3221  t1.lag_qtr_avg,</div><div class="sasSource">3222  t1.lag_qtr_med,</div><div class="sasSource">3223  t1.lag_week_avg,</div><div class="sasSource">3224  t1.lag_week_med,</div><div class="sasSource">3225  t1.lag_year_avg,</div><div class="sasSource">3226  t1.lag_year_med,</div><div class="sasSource">3227  t1.lag_halfyear_std,</div><div class="sasSource">3228  t1.lag_month_std,</div><div class="sasSource">3229  t1.lag_qtr_std,</div><div class="sasSource">3230  t1.lag_week_std,</div><div class="sasSource">3231  t1.lag_year_std,</div><div class="sasSource">3232  t1.lag_halfyear_pct10,</div><div class="sasSource">3233  t1.lag_halfyear_pct90,</div><div class="sasSource">3234  t1.lag_month_pct10,</div><div class="sasSource">3235  t1.lag_month_pct90,</div><div class="sasSource">3236  t1.lag_qtr_pct10,</div><div class="sasSource">3237  t1.lag_qtr_pct90,</div><div class="sasSource">3238  t1.lag_week_pct10,</div><div class="sasSource">3239  t1.lag_week_pct90,</div><div class="sasSource">3240  t1.lag_year_pct10,</div><div class="sasSource">3241  t1.lag_year_pct90,</div><div class="sasSource">3242  &amp;promo_list_sql.,</div><div class="sasWarning" id="sasLogWarning24_1620885733386">WARNING: Apparent symbolic reference PROMO_LIST_SQL not resolved.</div><div class="sasSource">3243   t1.NP_GIFT_PRICE_AMT,</div><div class="sasSource">3244  t1.side_promo_flag,</div><div class="sasSource">3245  t1.A_CPI,</div><div class="sasSource">3246  t1.A_GPD,</div><div class="sasSource">3247  t1.A_RDI,</div><div class="sasSource">3248  t1.TEMPERATURE,</div><div class="sasSource">3249  t1.PRECIPITATION,</div><div class="sasSource">3250  t1.comp_trp_BK,</div><div class="sasSource">3251  t1.comp_trp_KFC,</div><div class="sasSource">3252  t1.sum_trp,</div><div class="sasSource">3253  t1.prod_lvl4_id,</div><div class="sasSource">3254  t1.prod_lvl3_id,</div><div class="sasSource">3255  t1.prod_lvl2_id,</div><div class="sasSource">3256  t1.hero,</div><div class="sasSource">3257  t1.item_size,</div><div class="sasSource">3258  t1.offer_type,</div><div class="sasSource">3259  t1.price_tier,</div><div class="sasSource">3260  t1.lvl3_id,</div><div class="sasSource">3261  t1.lvl2_id,</div><div class="sasSource">3262  t1.agreement_type,</div><div class="sasSource">3263  t1.breakfast,</div><div class="sasSource">3264  t1.building_type,</div><div class="sasSource">3265  t1.company,</div><div class="sasSource">3266  t1.delivery,</div><div class="sasSource">3267  t1.drive_thru,</div><div class="sasSource">3268  t1.mccafe_type,</div><div class="sasSource">3269  t1.price_level,</div><div class="sasSource">3270  t1.window_type,</div><div class="sasSource">3271  t1.week,</div><div class="sasSource">3272  t1.weekday,</div><div class="sasSource">3273  t1.month,</div><div class="sasSource">3274  t1.weekend_flag,</div><div class="sasSource">3275  t1.defender_day,</div><div class="sasSource">3276  t1.female_day,</div><div class="sasSource">3277  t1.may_holiday,</div><div class="sasSource">3278  t1.new_year,</div><div class="sasSource">3279  t1.russia_day,</div><div class="sasSource">3280  t1.school_start,</div><div class="sasSource">3281  t1.student_day,</div><div class="sasSource">3282  t1.summer_start,</div><div class="sasSource">3283  t1.valentine_day,</div><div class="sasSource">3284  t1.price_rank,</div><div class="sasSource">3285  t1.price_index</div><div class="sasSource">3286  from</div><div class="sasSource">3287  public.abt15_ml as t1</div><div class="sasSource">3288  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote975_1620885733386">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">ERROR: Syntax error at or near "PROMO_LIST_SQL."</div><div class="sasSource">ERROR: The action stopped due to errors.</div><div class="sasError" id="sasLogError64_1620885733386">ERROR: The FedSQL action was not successful.</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x000003f4</div><div class="sasNote" id="sasLogNote976_1620885733386">NOTE: PROC FEDSQL has set option NOEXEC and will continue to prepare statements.</div><div class="sasSource">3289  quit;</div><div class="sasNote" id="sasLogNote977_1620885733386">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              225.31k</div><div class="sasNote">      OS Memory           36628.00k</div><div class="sasNote">      Timestamp           05/13/2021 01:53:09 AM</div><div class="sasNote">      Step Count                        226  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           48</div><div class="sasNote">      </div><div class="sasSource">3290  </div><div class="sasSource">3291  proc casutil;</div><div class="sasNote" id="sasLogNote978_1620885733386">NOTE: The UUID 'b077ec27-042e-1e40-b3a8-d124cf38af46' is connected using session CASAUTO.</div><div class="sasSource">3292  </div><div class="sasSource">3292!  promote casdata="units_abt_NOV_DEC_JAN" casout="units_abt_NOV_DEC_JAN" incaslib="public" outcaslib="public";</div><div class="sasError" id="sasLogError65_1620885733386">ERROR: There is no session-scope table units_abt_NOV_DEC_JAN in caslib Public of Cloud Analytic Services.</div><div class="sasError" id="sasLogError66_1620885733386">ERROR: The action stopped due to errors.</div><div class="sasNote" id="sasLogNote979_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.009413 seconds.</div><div class="sasSource">3293  </div><div class="sasSource">3293!  promote casdata="units_abt_NOV_DEC_JAN" casout="units_abt_NOV_DEC_JAN" incaslib="public" outcaslib="MAX_CASL";</div><div class="sasError" id="sasLogError67_1620885733386">ERROR: There is no session-scope table units_abt_NOV_DEC_JAN in caslib Public of Cloud Analytic Services.</div><div class="sasError" id="sasLogError68_1620885733386">ERROR: The action stopped due to errors.</div><div class="sasNote" id="sasLogNote980_1620885733386">NOTE: The Cloud Analytic Services server processed the request in 0.008786 seconds.</div><div class="sasSource">3294  run;</div><div class="sasSource">3295  </div><div class="sasSource">3296  %studio_hide_wrapper;</div><div class="sasSource">MPRINT(STUDIO_HIDE_WRAPPER):   options nonotes;</div><div class="sasSource">MPRINT(STUDIO_HIDE_WRAPPER):   options nosource;</div><div class="sasSource">MPRINT(STUDIO_HIDE_WRAPPER):   options nostimer;</div><div class="sasSource">MPRINT(STUDIO_RESTORE_WRAPPER):   options NOTES;</div><div class="sasSource">MPRINT(STUDIO_RESTORE_WRAPPER):   options SOURCE;</div><div class="sasSource">MPRINT(STUDIO_RESTORE_WRAPPER):   options STIMER;</div></pre></body></html>