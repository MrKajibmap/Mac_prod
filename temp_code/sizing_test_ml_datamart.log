<!DOCTYPE HTML><html><head><meta charset="UTF-8"></meta><style rel="stylesheet">.sasError {color: #d80000;}.sasMessage{color:ssSourceColor;}.sasWarning{color:#1b7a1b;}.sasSource{color:ssSourceColor;}.sasNote {color:#0072b2;}</style><title>Log:sizing_test_ml_datamart.sas</title></head><body class='sasLog'><pre class='sasLog' id='pre_sasLog_1044' style='background-color:transparent; -webkit-user-select: text; -webkit-user-modify: read-only;-webkit-touch-callout: default;border-top-width: 0px;border-bottom-width: 0px'><div class="sasSource">786   %studio_hide_wrapper;</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  Beginning execution.</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %GLOBAL  _STUDIONOTES</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %GLOBAL  _STUDIOSOURCE</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %GLOBAL  _STUDIOSTIMER</div><div class="sasSource">SYMBOLGEN:  Macro variable _STUDIONOTES resolves to </div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %IF condition &amp;_studionotes = is TRUE</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %LET (variable name is _STUDIONOTES)</div><div class="sasSource">MPRINT(STUDIO_HIDE_WRAPPER):   options nonotes;</div><div class="sasSource">SYMBOLGEN:  Macro variable _STUDIOSOURCE resolves to </div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %IF condition &amp;_studiosource = is TRUE</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %LET (variable name is _STUDIOSOURCE)</div><div class="sasSource">MPRINT(STUDIO_HIDE_WRAPPER):   options nosource;</div><div class="sasSource">SYMBOLGEN:  Macro variable _STUDIOSTIMER resolves to </div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %IF condition &amp;_studiostimer = is TRUE</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  %LET (variable name is _STUDIOSTIMER)</div><div class="sasSource">MPRINT(STUDIO_HIDE_WRAPPER):   options nostimer;</div><div class="sasSource">MLOGIC(STUDIO_HIDE_WRAPPER):  Ending execution.</div><div class="sasSource">SYMBOLGEN:  Macro variable TWORKLOC resolves to "/data/work/SAS_workA6A600002973_sasdevinf.ru-central1.internal"</div><div class="sasSource">SYMBOLGEN:  Macro variable SASWORKLOCATION resolves to "/data/work/SAS_workA6A600002973_sasdevinf.ru-central1.internal/"</div><div class="sasSource">SYMBOLGEN:  Macro variable _SASWSTEMP_ resolves to /data/work/SAS_workA6A600002973_sasdevinf.ru-central1.internal</div><div class="sasSource">SYMBOLGEN:  Some characters in the above value which were subject to macro quoting have been unquoted for printing.</div><div class="sasSource">SYMBOLGEN:  Macro variable _SASWSTEMP_ resolves to /data/work/SAS_workA6A600002973_sasdevinf.ru-central1.internal</div><div class="sasSource">SYMBOLGEN:  Some characters in the above value which were subject to macro quoting have been unquoted for printing.</div><div class="sasSource">SYMBOLGEN:  Macro variable GRAPHINIT resolves to GOPTIONS RESET=ALL GSFNAME=_GSFNAME;</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  Beginning execution.</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  %GLOBAL  _STUDIONOTES</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  %GLOBAL  _STUDIOSOURCE</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  %GLOBAL  _STUDIOSTIMER</div><div class="sasSource">SYMBOLGEN:  Macro variable _STUDIONOTES resolves to NOTES</div><div class="sasSource">MPRINT(STUDIO_RESTORE_WRAPPER):   options NOTES;</div><div class="sasSource">SYMBOLGEN:  Macro variable _STUDIOSOURCE resolves to SOURCE</div><div class="sasSource">MPRINT(STUDIO_RESTORE_WRAPPER):   options SOURCE;</div><div class="sasSource">SYMBOLGEN:  Macro variable _STUDIOSTIMER resolves to STIMER</div><div class="sasSource">MPRINT(STUDIO_RESTORE_WRAPPER):   options STIMER;</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  %LET (variable name is _STUDIONOTES)</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  %LET (variable name is _STUDIOSOURCE)</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  %LET (variable name is _STUDIOSTIMER)</div><div class="sasSource">MLOGIC(STUDIO_RESTORE_WRAPPER):  Ending execution.</div><div class="sasSource">867   /*</div><div class="sasSource">868   Схема программы:</div><div class="sasSource">869   </div><div class="sasSource">870   0. Объявление макропеременных: первый и последний день в истории,</div><div class="sasSource">870 ! фильтрация по категориям</div><div class="sasSource">871   товаров и каналам.</div><div class="sasSource">872   1. Сбор "каркаса" из таблиц ia_pmix и ia_pmix_history с учетом фильтра.</div><div class="sasSource">873   2. Добавление цен.</div><div class="sasSource">874   3. Протягиваем временные ряды на 91 день с последнего дня в истории.</div><div class="sasSource">874 ! Целевую переменную</div><div class="sasSource">875   заполняем пропусками, цены заполняем предыдущим значением.</div><div class="sasSource">876   4. Фильтрация:</div><div class="sasSource">877   * Убираем временные закрытия ПБО.</div><div class="sasSource">878   * Убираем закрытые магазины из справочника ПБО.</div><div class="sasSource">879   * Убираем из истории пропуски в продажах (появившиеся после</div><div class="sasSource">879 ! протяжки временных рядов).</div><div class="sasSource">880   * PLM, убираем выведенные товары (пока на паузе).</div><div class="sasSource">881   * Пересекаем с ассортиментной матрицей скоринговую витрину.</div><div class="sasSource">882   5. Подсчет лагов.</div><div class="sasSource">883   6. Добавление промо:</div><div class="sasSource">884   * Бинарные флаги промо по промо механикам.</div><div class="sasSource">885   * Флаг side_promo для регулярного товара вне промо.</div><div class="sasSource">886   * Скидка?</div><div class="sasSource">887   7. Добавляем мароэкономику (проверить заполненность на будущее).</div><div class="sasSource">888   8. Добавляем погоду (проверить заполненность на будещее).</div><div class="sasSource">889   9. Добавляем trp конкурентов.</div><div class="sasSource">890   10. Добавляем медиаподдержку.</div><div class="sasSource">891   11. Добавим атрибуты товаров. Дополнительно перекодируем текстовые</div><div class="sasSource">891 ! переменные.</div><div class="sasSource">892   12. Добавляем атрибуты ПБО. Дополнительно перекодируем текстовые</div><div class="sasSource">892 ! переменные.</div><div class="sasSource">893   13. Добавляем календарные признаки.</div><div class="sasSource">894   14. Добавляем события. Можно забить на те события, которые нам</div><div class="sasSource">894 ! передают сейчас, а</div><div class="sasSource">895   просто взять и использовать, те события, которые Лиза считает</div><div class="sasSource">895 ! существенными.</div><div class="sasSource">896   *** Взять день города! ***</div><div class="sasSource">897   15. Добавим ценовые ранги.</div><div class="sasSource">898   16. Перекодируем channel_cd (текстовое поле на число). Делаем это в</div><div class="sasSource">898 ! последнюю очередб</div><div class="sasSource">899    для удобства соединения таблиц.</div><div class="sasSource">900   17. Разделяем витрину на обучение и скоринг.</div><div class="sasSource">901   </div><div class="sasSource">902   Что еще хочется видеть в витрине?</div><div class="sasSource">903   * Закодировать ID ПБО и товаров через агрегаты целевой переменной</div><div class="sasSource">904   * Придумать признаков по промо.</div><div class="sasSource">905   */</div><div class="sasSource">906   </div><div class="sasSource">907   /****** 0. Объявление макропеременных ******/</div><div class="sasSource">908   options mprint nomprintnest nomlogic nomlogicnest nosymbolgen mcompilenote=all mreplace;</div><div class="sasSource">909   /*Создать cas-сессию, если её нет*/</div><div class="sasSource">910   %macro assign;</div><div class="sasSource">911   %let casauto_ok = %sysfunc(SESSFOUND ( casauto)) ;</div><div class="sasSource">912   %if &amp;casauto_ok = 0 %then %do; /*set all stuff only if casauto is absent */</div><div class="sasSource">913    cas casauto;</div><div class="sasSource">914    caslib _all_ assign;</div><div class="sasSource">915   %end;</div><div class="sasSource">916   %mend;</div><div class="sasNote" id="sasLogNote1_1594283467627">NOTE: The macro ASSIGN completed compilation without errors.</div><div class="sasNote">      15 instructions 336 bytes.</div><div class="sasSource">917   %assign</div><div class="sasSource">MPRINT(ASSIGN):   cas casauto;</div><div class="sasNote" id="sasLogNote2_1594283467627">NOTE: The session CASAUTO connected successfully to Cloud Analytic Services sasdevinf.ru-central1.internal using port 5570. The </div><div class="sasNote">      UUID is 107acdf8-aeac-d246-a638-db57ea7a7986. The user is RU-AMikhailova and the active caslib is CASUSER(RU-AMikhailova).</div><div class="sasNote" id="sasLogNote3_1594283467627">NOTE: The SAS option SESSREF was updated with the value CASAUTO.</div><div class="sasNote" id="sasLogNote4_1594283467627">NOTE: The SAS macro _SESSREF_ was updated with the value CASAUTO.</div><div class="sasNote" id="sasLogNote5_1594283467627">NOTE: The session is using 1 worker.</div><div class="sasSource">MPRINT(ASSIGN):   caslib _all_ assign;</div><div class="sasNote" id="sasLogNote6_1594283467627">NOTE: A SAS Library associated with a caslib can only reference library member names that conform to SAS Library naming conventions.</div><div class="sasNote" id="sasLogNote7_1594283467627">NOTE: CASLIB CASUSER(RU-AMikhailova) for session CASAUTO will be mapped to SAS Library CASUSER.</div><div class="sasNote" id="sasLogNote8_1594283467627">NOTE: CASLIB CPSAppData for session CASAUTO will not be mapped to SAS Library CPSAppData. The CASLIB name is not valid for use as a </div><div class="sasNote">      libref.</div><div class="sasNote" id="sasLogNote9_1594283467627">NOTE: CASLIB Formats for session CASAUTO will be mapped to SAS Library FORMATS.</div><div class="sasNote" id="sasLogNote10_1594283467627">NOTE: CASLIB ModelPerformanceData for session CASAUTO will not be mapped to SAS Library ModelPerformanceData. The CASLIB name is </div><div class="sasNote">      not valid for use as a libref.</div><div class="sasNote" id="sasLogNote11_1594283467627">NOTE: CASLIB Models for session CASAUTO will be mapped to SAS Library MODELS.</div><div class="sasNote" id="sasLogNote12_1594283467627">NOTE: CASLIB Public for session CASAUTO will be mapped to SAS Library PUBLIC.</div><div class="sasNote" id="sasLogNote13_1594283467627">NOTE: CASLIB Samples for session CASAUTO will be mapped to SAS Library SAMPLES.</div><div class="sasNote" id="sasLogNote14_1594283467627">NOTE: CASLIB SystemData for session CASAUTO will not be mapped to SAS Library SystemData. The CASLIB name is not valid for use as a </div><div class="sasNote">      libref.</div><div class="sasSource">918   </div><div class="sasSource">919   /* Подключение библиотек */</div><div class="sasSource">920   libname ETL_STG "/data/ETL_STG";</div><div class="sasNote" id="sasLogNote15_1594283467627">NOTE: Libref ETL_STG refers to the same physical library as ETL_STG2.</div><div class="sasNote" id="sasLogNote16_1594283467627">NOTE: Libref ETL_STG was successfully assigned as follows: </div><div class="sasNote">      Engine:        V9 </div><div class="sasNote">      Physical Name: /data/ETL_STG</div><div class="sasSource">921   /* Объявление макропеременных */</div><div class="sasSource">922   %let inlib=ETL_STG;</div><div class="sasSource">923   /* только бургеры в канале ALL */</div><div class="sasSource">924   %let filter = %str(1=1);</div><div class="sasSource">925   %let hist_start_dt = date '2019-03-02';</div><div class="sasSource">926   %let hist_end_dt = date '2020-05-31';</div><div class="sasSource">927   </div><div class="sasSource">928   </div><div class="sasSource">929   /****** 1. Сбор "каркаса" из таблиц ia_pmix и ia_pmix_history с учетом фильтра ******/</div><div class="sasSource">930   /* Сначала собираем справочник товаров для того, чтобы создать фильтр</div><div class="sasSource">930 !  */</div><div class="sasSource">931   proc casutil;</div><div class="sasNote" id="sasLogNote17_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">932     droptable casdata="product_dictionary_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote18_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.01439 seconds.</div><div class="sasSource">933     load data=&amp;inlib..IA_product casout='ia_product' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote19_1594283467627">NOTE: ETL_STG.IA_PRODUCT was successfully added to the "Public" caslib as "IA_PRODUCT".</div><div class="sasSource">934     load data=&amp;inlib..IA_product_HIERARCHY casout='IA_product_HIERARCHY' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote20_1594283467627">NOTE: ETL_STG.IA_PRODUCT_HIERARCHY was successfully added to the "Public" caslib as "IA_PRODUCT_HIERARCHY".</div><div class="sasSource">935     load data=&amp;inlib..IA_product_ATTRIBUTES casout='IA_product_ATTRIBUTES' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote21_1594283467627">NOTE: ETL_STG.IA_PRODUCT_ATTRIBUTES was successfully added to the "Public" caslib as "IA_PRODUCT_ATTRIBUTES".</div><div class="sasSource">936   run;</div><div class="sasSource">937   </div><div class="sasNote" id="sasLogNote22_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.15 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              2094.84k</div><div class="sasNote">      OS Memory           33052.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:09 PM</div><div class="sasNote">      Step Count                        22  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1860</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        82</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">938   proc cas;</div><div class="sasSource">939   transpose.transpose /</div><div class="sasSource">940      table={name="ia_product_attributes", caslib="public", groupby={"product_id"}}</div><div class="sasSource">941      attributes={{name="product_id"}}</div><div class="sasSource">942      transpose={"PRODUCT_ATTR_VALUE"}</div><div class="sasSource">943      prefix="A_"</div><div class="sasSource">944      id={"PRODUCT_ATTR_NM"}</div><div class="sasSource">945      casout={name="attr_transposed", caslib="public", replace=true};</div><div class="sasSource">946   quit;</div><div class="sasNote" id="sasLogNote23_1594283467627">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote24_1594283467627">NOTE: Added action set 'transpose'.</div><div class="sasNote" id="sasLogNote25_1594283467627">NOTE: There were 17079 rows read from the table IA_PRODUCT_ATTRIBUTES.</div><div class="sasNote" id="sasLogNote26_1594283467627">NOTE: The table attr_transposed has 2512 rows and 10 columns.</div><div class="sasNote" id="sasLogNote27_1594283467627">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              10917.43k</div><div class="sasNote">      OS Memory           42892.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:09 PM</div><div class="sasNote">      Step Count                        23  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1213</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        16</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">947   </div><div class="sasSource">948   proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote28_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">949      create table public.product_hier_flat{options replace=true} as</div><div class="sasSource">950   select t1.product_id,</div><div class="sasSource">951      t2.product_id  as LVL4_ID,</div><div class="sasSource">952      t3.product_id  as LVL3_ID,</div><div class="sasSource">953      t3.PARENT_product_id as LVL2_ID,</div><div class="sasSource">954      1 as LVL1_ID</div><div class="sasSource">955   from</div><div class="sasSource">956   (select * from public.ia_product_hierarchy where product_lvl=5) as t1</div><div class="sasSource">957   left join</div><div class="sasSource">958   (select * from public.ia_product_hierarchy where product_lvl=4) as t2</div><div class="sasSource">959   on t1.PARENT_PRODUCT_ID=t2.PRODUCT_ID</div><div class="sasSource">960   left join</div><div class="sasSource">961   (select * from public.ia_product_hierarchy where product_lvl=3) as t3</div><div class="sasSource">962   on t2.PARENT_PRODUCT_ID=t3.PRODUCT_ID</div><div class="sasSource">963    ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote29_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_HIER_FLAT was created in caslib Public with 2512 rows returned.</div><div class="sasNote" id="sasLogNote30_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">964   quit;</div><div class="sasNote" id="sasLogNote31_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.35 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              128.03k</div><div class="sasNote">      OS Memory           32788.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:10 PM</div><div class="sasNote">      Step Count                        24  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     40</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">965   </div><div class="sasSource">966   proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote32_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">967      create table public.product_dictionary_ml{options replace=true} as</div><div class="sasSource">968      select t1.product_id,</div><div class="sasSource">969      coalesce(t1.lvl4_id,-9999) as prod_lvl4_id,</div><div class="sasSource">970      coalesce(t1.lvl3_id,-999) as prod_lvl3_id,</div><div class="sasSource">971      coalesce(t1.lvl2_id,-99) as prod_lvl2_id,</div><div class="sasSource">972      coalesce(t15.product_nm,'NA') as product_nm,</div><div class="sasSource">973      coalesce(t14.product_nm,'NA') as prod_lvl4_nm,</div><div class="sasSource">974      coalesce(t13.product_nm,'NA') as prod_lvl3_nm,</div><div class="sasSource">975      coalesce(t12.product_nm,'NA') as prod_lvl2_nm,</div><div class="sasSource">976          t3.A_HERO,</div><div class="sasSource">977          t3.A_ITEM_SIZE,</div><div class="sasSource">978      t3.A_OFFER_TYPE,</div><div class="sasSource">979      t3.A_PRICE_TIER</div><div class="sasSource">980      from public.product_hier_flat t1</div><div class="sasSource">981      left join public.attr_transposed t3</div><div class="sasSource">982      on t1.product_id=t3.product_id</div><div class="sasSource">983      left join PUBLIC.IA_product t15</div><div class="sasSource">984      on t1.product_id=t15.product_id</div><div class="sasSource">985      left join PUBLIC.IA_product t14</div><div class="sasSource">986      on t1.lvl4_id=t14.product_id</div><div class="sasSource">987      left join PUBLIC.IA_product t13</div><div class="sasSource">988      on t1.lvl3_id=t13.product_id</div><div class="sasSource">989      left join PUBLIC.IA_product t12</div><div class="sasSource">990      on t1.lvl2_id=t12.product_id;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote33_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_DICTIONARY_ML was created in caslib Public with 2512 rows returned.</div><div class="sasNote" id="sasLogNote34_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">991   quit;</div><div class="sasNote" id="sasLogNote35_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.59 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              122.96k</div><div class="sasNote">      OS Memory           32788.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:10 PM</div><div class="sasNote">      Step Count                        25  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     8</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        22</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">992   </div><div class="sasSource">993   /* Перекодировка текстовых переменных. */</div><div class="sasSource">994   %macro text_encoding(table, variable);</div><div class="sasSource">995       /*</div><div class="sasSource">996       Параметры:</div><div class="sasSource">997           table : таблица в которой хотим заненить текстовую переменную</div><div class="sasSource">998           variable : название текстовой переменной</div><div class="sasSource">999       Выход:</div><div class="sasSource">1000          * Таблица table с дополнительным столбцом variable_id</div><div class="sasSource">1001          * Таблица encoding_variable с привозкой id к старым значениям</div><div class="sasSource">1002      */</div><div class="sasSource">1003      proc casutil;</div><div class="sasSource">1004           droptable casdata="encoding_&amp;variable." incaslib="public" quiet;</div><div class="sasSource">1005       run;</div><div class="sasSource">1006  </div><div class="sasSource">1007  </div><div class="sasSource">1008  </div><div class="sasSource">1009      proc fedsql sessref=casauto;</div><div class="sasSource">1010          create table public.unique{options replace=true} as</div><div class="sasSource">1011              select distinct</div><div class="sasSource">1012                  &amp;variable</div><div class="sasSource">1013              from</div><div class="sasSource">1014                  &amp;table.</div><div class="sasSource">1015              ;</div><div class="sasSource">1016      quit;</div><div class="sasSource">1017  </div><div class="sasSource">1018  </div><div class="sasSource">1019  </div><div class="sasSource">1020      data work.unique;</div><div class="sasSource">1021          set public.unique;</div><div class="sasSource">1022      run;</div><div class="sasSource">1023  </div><div class="sasSource">1024  </div><div class="sasSource">1025  </div><div class="sasSource">1026      data work.encoding_&amp;variable.;</div><div class="sasSource">1027          set work.unique;</div><div class="sasSource">1028          &amp;variable._id = _N_;</div><div class="sasSource">1029      run;</div><div class="sasSource">1030  </div><div class="sasSource">1031  </div><div class="sasSource">1032  </div><div class="sasSource">1033      data public.encoding_&amp;variable.;</div><div class="sasSource">1034          set work.encoding_&amp;variable.;</div><div class="sasSource">1035      run;</div><div class="sasSource">1036  </div><div class="sasSource">1037  </div><div class="sasSource">1038  </div><div class="sasSource">1039      proc fedsql sessref = casauto;</div><div class="sasSource">1040          create table public.&amp;table.{options replace=true} as</div><div class="sasSource">1041              select</div><div class="sasSource">1042                  t1.*,</div><div class="sasSource">1043                  t2.&amp;variable._id</div><div class="sasSource">1044              from</div><div class="sasSource">1045                  &amp;table. as t1</div><div class="sasSource">1046              left join</div><div class="sasSource">1047                  public.encoding_&amp;variable. as t2</div><div class="sasSource">1048              on</div><div class="sasSource">1049                  t1.&amp;variable = t2.&amp;variable</div><div class="sasSource">1050          ;</div><div class="sasSource">1051      quit;</div><div class="sasSource">1052  </div><div class="sasSource">1053  </div><div class="sasSource">1054  </div><div class="sasSource">1055      %if &amp;variable=channel_cd %then %do;</div><div class="sasSource">1056  proc casutil;</div><div class="sasSource">1057  promote casdata="encoding_&amp;variable." incaslib="public" outcaslib="public";</div><div class="sasSource">1058  run;</div><div class="sasSource">1059  %end;</div><div class="sasSource">1060  %mend;</div><div class="sasNote" id="sasLogNote36_1594283467627">NOTE: The macro TEXT_ENCODING completed compilation without errors.</div><div class="sasNote">      25 instructions 1536 bytes.</div><div class="sasSource">1061  </div><div class="sasSource">1062  %text_encoding(public.product_dictionary_ml, a_hero)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote37_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_a_hero" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote38_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.01313 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote39_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.01 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              112.75k</div><div class="sasNote">      OS Memory           32788.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:10 PM</div><div class="sasNote">      Step Count                        26  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote40_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct a_hero from </div><div class="sasSource">public.product_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote41_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 2 rows returned.</div><div class="sasNote" id="sasLogNote42_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote43_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              83.59k</div><div class="sasNote">      OS Memory           32788.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:10 PM</div><div class="sasNote">      Step Count                        27  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote44_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote45_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote46_1594283467627">NOTE: There were 2 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote47_1594283467627">NOTE: The data set WORK.UNIQUE has 2 observations and 1 variables.</div><div class="sasNote" id="sasLogNote48_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote49_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              492.18k</div><div class="sasNote">      OS Memory           33044.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:10 PM</div><div class="sasNote">      Step Count                        28  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     114</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_a_hero;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   a_hero_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote50_1594283467627">NOTE: There were 2 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote51_1594283467627">NOTE: The data set WORK.ENCODING_A_HERO has 2 observations and 2 variables.</div><div class="sasNote" id="sasLogNote52_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_HERO increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote53_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              600.62k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:10 PM</div><div class="sasNote">      Step Count                        29  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     93</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_a_hero;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_a_hero;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote54_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote55_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote56_1594283467627">NOTE: There were 2 observations read from the data set WORK.ENCODING_A_HERO.</div><div class="sasNote" id="sasLogNote57_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_HERO has 2 observations and 2 variables.</div><div class="sasNote" id="sasLogNote58_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              903.21k</div><div class="sasNote">      OS Memory           33816.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:10 PM</div><div class="sasNote">      Step Count                        30  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     155</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote59_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.product_dictionary_ml{options replace=true} as select t1.*, t2.a_hero_id from </div><div class="sasSource">public.product_dictionary_ml as t1 left join public.encoding_a_hero as t2 on t1.a_hero = t2.a_hero ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote60_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_DICTIONARY_ML was created in caslib PUBLIC with 2512 rows returned.</div><div class="sasNote" id="sasLogNote61_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote62_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.65k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        31  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     11</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1063  %text_encoding(public.product_dictionary_ml, a_item_size)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote63_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_a_item_size" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote64_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.01028 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote65_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.01 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              100.75k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        32  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote66_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct a_item_size from </div><div class="sasSource">public.product_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote67_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 19 rows returned.</div><div class="sasNote" id="sasLogNote68_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote69_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.12 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              70.37k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        33  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote70_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote71_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote72_1594283467627">NOTE: There were 19 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote73_1594283467627">NOTE: The data set WORK.UNIQUE has 19 observations and 1 variables.</div><div class="sasNote" id="sasLogNote74_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote75_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              522.93k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        34  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     17</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        31</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_a_item_size;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   a_item_size_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote76_1594283467627">NOTE: There were 19 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote77_1594283467627">NOTE: The data set WORK.ENCODING_A_ITEM_SIZE has 19 observations and 2 variables.</div><div class="sasNote" id="sasLogNote78_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_ITEM_SIZE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote79_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              563.84k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        35  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     12</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_a_item_size;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_a_item_size;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote80_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote81_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote82_1594283467627">NOTE: There were 19 observations read from the data set WORK.ENCODING_A_ITEM_SIZE.</div><div class="sasNote" id="sasLogNote83_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_ITEM_SIZE has 19 observations and 2 variables.</div><div class="sasNote" id="sasLogNote84_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              903.40k</div><div class="sasNote">      OS Memory           33816.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        36  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     148</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote85_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.product_dictionary_ml{options replace=true} as select t1.*, t2.a_item_size_id </div><div class="sasSource">from public.product_dictionary_ml as t1 left join public.encoding_a_item_size as t2 on t1.a_item_size = t2.a_item_size ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote86_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_DICTIONARY_ML was created in caslib PUBLIC with 2512 rows returned.</div><div class="sasNote" id="sasLogNote87_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote88_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.15 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              72.37k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        37  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1064  %text_encoding(public.product_dictionary_ml, a_offer_type)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote89_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_a_offer_type" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote90_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012758 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote91_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.01 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              99.75k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        38  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote92_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct a_offer_type from </div><div class="sasSource">public.product_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote93_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 3 rows returned.</div><div class="sasNote" id="sasLogNote94_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote95_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.14 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              69.37k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        39  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote96_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote97_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote98_1594283467627">NOTE: There were 3 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote99_1594283467627">NOTE: The data set WORK.UNIQUE has 3 observations and 1 variables.</div><div class="sasNote" id="sasLogNote100_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote101_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              516.21k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        40  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     17</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_a_offer_type;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   a_offer_type_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote102_1594283467627">NOTE: There were 3 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote103_1594283467627">NOTE: The data set WORK.ENCODING_A_OFFER_TYPE has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote104_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_OFFER_TYPE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote105_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              563.96k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        41  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_a_offer_type;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_a_offer_type;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote106_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote107_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote108_1594283467627">NOTE: There were 3 observations read from the data set WORK.ENCODING_A_OFFER_TYPE.</div><div class="sasNote" id="sasLogNote109_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_OFFER_TYPE has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote110_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              903.37k</div><div class="sasNote">      OS Memory           33816.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        42  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     145</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote111_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.product_dictionary_ml{options replace=true} as select t1.*, t2.a_offer_type_id </div><div class="sasSource">from public.product_dictionary_ml as t1 left join public.encoding_a_offer_type as t2 on t1.a_offer_type = t2.a_offer_type ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote112_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_DICTIONARY_ML was created in caslib PUBLIC with 2512 rows returned.</div><div class="sasNote" id="sasLogNote113_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote114_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.14 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              72.37k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        43  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1065  %text_encoding(public.product_dictionary_ml, a_price_tier)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote115_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_a_price_tier" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote116_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.011634 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote117_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.01 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              99.46k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        44  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote118_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct a_price_tier from </div><div class="sasSource">public.product_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote119_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 5 rows returned.</div><div class="sasNote" id="sasLogNote120_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote121_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.12 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              69.37k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:11 PM</div><div class="sasNote">      Step Count                        45  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote122_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote123_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote124_1594283467627">NOTE: There were 5 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote125_1594283467627">NOTE: The data set WORK.UNIQUE has 5 observations and 1 variables.</div><div class="sasNote" id="sasLogNote126_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote127_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              506.25k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:12 PM</div><div class="sasNote">      Step Count                        46  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     17</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        31</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_a_price_tier;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   a_price_tier_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote128_1594283467627">NOTE: There were 5 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote129_1594283467627">NOTE: The data set WORK.ENCODING_A_PRICE_TIER has 5 observations and 2 variables.</div><div class="sasNote" id="sasLogNote130_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_PRICE_TIER increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote131_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              568.62k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:12 PM</div><div class="sasNote">      Step Count                        47  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     15</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_a_price_tier;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_a_price_tier;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote132_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote133_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote134_1594283467627">NOTE: There were 5 observations read from the data set WORK.ENCODING_A_PRICE_TIER.</div><div class="sasNote" id="sasLogNote135_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_PRICE_TIER has 5 observations and 2 variables.</div><div class="sasNote" id="sasLogNote136_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              909.28k</div><div class="sasNote">      OS Memory           33816.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:12 PM</div><div class="sasNote">      Step Count                        48  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     145</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        21</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote137_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.product_dictionary_ml{options replace=true} as select t1.*, t2.a_price_tier_id </div><div class="sasSource">from public.product_dictionary_ml as t1 left join public.encoding_a_price_tier as t2 on t1.a_price_tier = t2.a_price_tier ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote138_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_DICTIONARY_ML was created in caslib PUBLIC with 2512 rows returned.</div><div class="sasNote" id="sasLogNote139_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote140_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.15 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              72.37k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:12 PM</div><div class="sasNote">      Step Count                        49  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1066  </div><div class="sasSource">1067  proc casutil;</div><div class="sasNote" id="sasLogNote141_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1068    droptable casdata='ia_product' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote142_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.009554 seconds.</div><div class="sasSource">1069    droptable casdata='IA_product_HIERARCHY' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote143_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008858 seconds.</div><div class="sasSource">1070    droptable casdata='IA_product_ATTRIBUTES' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote144_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.01079 seconds.</div><div class="sasSource">1071    droptable casdata='product_hier_flat' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote145_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008424 seconds.</div><div class="sasSource">1072    droptable casdata='attr_transposed' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote146_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008085 seconds.</div><div class="sasSource">1073  run;</div><div class="sasSource">1074  </div><div class="sasSource">1075  /* Подготовка таблицы с продажами */</div><div class="sasNote" id="sasLogNote147_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.78k</div><div class="sasNote">      OS Memory           33300.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:36:12 PM</div><div class="sasNote">      Step Count                        50  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1076  proc casutil;</div><div class="sasNote" id="sasLogNote148_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1077  </div><div class="sasSource">1077!  droptable casdata="abt1_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote149_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.011206 seconds.</div><div class="sasSource">1078  </div><div class="sasSource">1078!  load data=&amp;inlib..IA_pmix_sales casout='ia_pmix_sales' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote150_1594283467627">NOTE: ETL_STG.IA_PMIX_SALES was successfully added to the "Public" caslib as "IA_PMIX_SALES".</div><div class="sasSource">1079  </div><div class="sasSource">1079!  load data=&amp;inlib..IA_pmix_sales_HISTORY casout='IA_pmix_sales_HISTORY' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote151_1594283467627">NOTE: ETL_STG.IA_PMIX_SALES_HISTORY was successfully added to the "Public" caslib as "IA_PMIX_SALES_HISTORY".</div><div class="sasSource">1080  run;</div><div class="sasSource">1081  </div><div class="sasNote" id="sasLogNote152_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           5:07.43</div><div class="sasNote">      user cpu time       1:21.22</div><div class="sasNote">      system cpu time     22.85 seconds</div><div class="sasNote">      memory              1641.18k</div><div class="sasNote">      OS Memory           34588.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:41:19 PM</div><div class="sasNote">      Step Count                        51  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     4877653</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        152279</div><div class="sasNote">      Involuntary Context Switches      265</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           72</div><div class="sasNote">      </div><div class="sasSource">1082  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote153_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1083  create table public.abt1_ml{options replace=true} as</div><div class="sasSource">1084  select</div><div class="sasSource">1085  t1.PBO_LOCATION_ID,</div><div class="sasSource">1086  t1.PRODUCT_ID,</div><div class="sasSource">1087  t1.CHANNEL_CD,</div><div class="sasSource">1088  t1.SALES_DT,</div><div class="sasSource">1089  t1.sum_qty</div><div class="sasSource">1090  from (</div><div class="sasSource">1091  select</div><div class="sasSource">1092  coalesce(t1.PBO_LOCATION_ID, t2.PBO_LOCATION_ID) as PBO_LOCATION_ID,</div><div class="sasSource">1093  coalesce(t1.PRODUCT_ID, t2.PRODUCT_ID) as PRODUCT_ID,</div><div class="sasSource">1094  coalesce(t1.CHANNEL_CD, t2.CHANNEL_CD) as CHANNEL_CD,</div><div class="sasSource">1095  coalesce(t1.SALES_D, t2.SALES_D) as SALES_DT,</div><div class="sasSource">1096  coalesce(t1.SALES_QTY, t2.SALES_QTY, 0) + coalesce(t1.SALES_QTY_PROMO, t2.SALES_QTY_PROMO, 0) as sum_qty</div><div class="sasSource">1097  from (</div><div class="sasSource">1098  select *, datepart(sales_dt) as sales_d from public.ia_pmix_sales</div><div class="sasSource">1099  ) t1 full outer join (</div><div class="sasSource">1100  select *, datepart(sales_dt) as sales_d from public.ia_pmix_sales_history</div><div class="sasSource">1101  ) t2 on</div><div class="sasSource">1102  t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">1103  t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">1104  t1.CHANNEL_CD = t2.CHANNEL_CD and</div><div class="sasSource">1105  t1.SALES_D = t2.SALES_D</div><div class="sasSource">1106  ) as t1</div><div class="sasSource">1107  left join</div><div class="sasSource">1108   public.product_dictionary_ml as t2</div><div class="sasSource">1109  on</div><div class="sasSource">1110  t1.product_id = t2.product_id</div><div class="sasSource">1111  where</div><div class="sasSource">1112  &amp;filter and</div><div class="sasSource">1113  t1.SALES_DT &gt;= &amp;hist_start_dt and</div><div class="sasSource">1114  t1.SALES_DT &lt;= &amp;hist_end_dt</div><div class="sasSource">1115  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote154_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT1_ML was created in caslib Public with 96337695 rows returned.</div><div class="sasNote" id="sasLogNote155_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1116  quit;</div><div class="sasNote" id="sasLogNote156_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           4:30.23</div><div class="sasNote">      user cpu time       0.12 seconds</div><div class="sasNote">      system cpu time     0.05 seconds</div><div class="sasNote">      memory              237.46k</div><div class="sasNote">      OS Memory           33556.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:45:50 PM</div><div class="sasNote">      Step Count                        52  Switch Count  4</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     318</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        1459</div><div class="sasNote">      Involuntary Context Switches      5</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           64</div><div class="sasNote">      </div><div class="sasSource">1117  </div><div class="sasSource">1118  proc casutil;</div><div class="sasNote" id="sasLogNote157_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1119  </div><div class="sasSource">1119!  droptable casdata="ia_pmix_sales" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote158_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.097547 seconds.</div><div class="sasSource">1120  </div><div class="sasSource">1120!  droptable casdata="IA_pmix_sales_HISTORY" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote159_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 2.501441 seconds.</div><div class="sasSource">1121  /* promote casdata="abt1_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">1122  run;</div><div class="sasSource">1123  </div><div class="sasSource">1124  </div><div class="sasSource">1125  /****** 2. Добавление цен ******/</div><div class="sasNote" id="sasLogNote160_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           2.61 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              115.25k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:45:52 PM</div><div class="sasNote">      Step Count                        53  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     36</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        21</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1126  proc casutil;</div><div class="sasNote" id="sasLogNote161_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1127    droptable casdata="price_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote162_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.026468 seconds.</div><div class="sasSource">1128    droptable casdata="abt2_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote163_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013599 seconds.</div><div class="sasSource">1129    load data=&amp;inlib..ia_price_history casout='ia_price_history' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote164_1594283467627">NOTE: ETL_STG.IA_PRICE_HISTORY was successfully added to the "Public" caslib as "IA_PRICE_HISTORY".</div><div class="sasSource">1130    load data=&amp;inlib..ia_price casout='ia_price' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote165_1594283467627">NOTE: ETL_STG.IA_PRICE was successfully added to the "Public" caslib as "IA_PRICE".</div><div class="sasSource">1131  run;</div><div class="sasSource">1132  </div><div class="sasNote" id="sasLogNote166_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           1.70 seconds</div><div class="sasNote">      user cpu time       0.37 seconds</div><div class="sasNote">      system cpu time     0.14 seconds</div><div class="sasNote">      memory              1598.09k</div><div class="sasNote">      OS Memory           34844.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:45:54 PM</div><div class="sasNote">      Step Count                        54  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     26639</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        853</div><div class="sasNote">      Involuntary Context Switches      8</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1133  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote167_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1134  /* Объединяем историю с актуальными данными */</div><div class="sasSource">1135  create table public.price_ml{options replace=true} as</div><div class="sasSource">1136  select</div><div class="sasSource">1137  coalesce(t1.PBO_LOCATION_ID, t2.PBO_LOCATION_ID) as PBO_LOCATION_ID,</div><div class="sasSource">1138  coalesce(t1.PRODUCT_ID, t2.PRODUCT_ID) as PRODUCT_ID,</div><div class="sasSource">1139  coalesce(datepart(t1.start_dt), datepart(t2.start_dt)) as start_dt,</div><div class="sasSource">1140  coalesce(datepart(t1.end_dt), datepart(t2.end_dt)) as end_dt,</div><div class="sasSource">1141  coalesce(t1.GROSS_PRICE_AMT, t2.GROSS_PRICE_AMT) as GROSS_PRICE_AMT,</div><div class="sasSource">1142  coalesce(t1.NET_PRICE_AMT, t2.NET_PRICE_AMT) as NET_PRICE_AMT,</div><div class="sasSource">1143  coalesce(t1.PRICE_TYPE, t2.PRICE_TYPE) as PRICE_TYPE</div><div class="sasSource">1144  from</div><div class="sasSource">1145  public.ia_price as t1</div><div class="sasSource">1146  full outer join</div><div class="sasSource">1147  public.ia_price_history as t2 on</div><div class="sasSource">1148  t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">1149  t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">1150  t1.start_dt = t2.start_dt and</div><div class="sasSource">1151  t1.end_dt = t2.end_dt and</div><div class="sasSource">1152  t1.PRICE_TYPE = t2.PRICE_TYPE</div><div class="sasSource">1153  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote168_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table PRICE_ML was created in caslib Public with 1523672 rows returned.</div><div class="sasNote" id="sasLogNote169_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1154  quit;</div><div class="sasNote" id="sasLogNote170_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           1.21 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              218.78k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:45:55 PM</div><div class="sasNote">      Step Count                        55  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     9</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        31</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1155  </div><div class="sasSource">1156  /* Добавляем к продажам цены */</div><div class="sasSource">1157  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote171_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1158  create table public.abt2_ml{options replace=true} as</div><div class="sasSource">1159          select</div><div class="sasSource">1160              t1.PBO_LOCATION_ID,</div><div class="sasSource">1161              t1.PRODUCT_ID,</div><div class="sasSource">1162              t1.CHANNEL_CD,</div><div class="sasSource">1163              t1.SALES_DT,</div><div class="sasSource">1164              t1.sum_qty,</div><div class="sasSource">1165              max(t2.GROSS_PRICE_AMT) as GROSS_PRICE_AMT</div><div class="sasSource">1166          from</div><div class="sasSource">1167              public.abt1_ml as t1 left join</div><div class="sasSource">1168              public.price_ml as t2</div><div class="sasSource">1169          on</div><div class="sasSource">1170              t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">1171              t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">1172              t1.SALES_DT &lt;= t2.end_dt and</div><div class="sasSource">1173              t1.SALES_DT &gt;= t2.start_dt</div><div class="sasSource">1174          group by</div><div class="sasSource">1175  t1.PBO_LOCATION_ID,</div><div class="sasSource">1176              t1.PRODUCT_ID,</div><div class="sasSource">1177              t1.CHANNEL_CD,</div><div class="sasSource">1178              t1.SALES_DT,</div><div class="sasSource">1179              t1.sum_qty</div><div class="sasSource">1180      ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote172_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT2_ML was created in caslib Public with 96337695 rows returned.</div><div class="sasNote" id="sasLogNote173_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1181  quit;</div><div class="sasNote" id="sasLogNote174_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           1:17.51</div><div class="sasNote">      user cpu time       0.03 seconds</div><div class="sasNote">      system cpu time     0.02 seconds</div><div class="sasNote">      memory              107.15k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:47:13 PM</div><div class="sasNote">      Step Count                        56  Switch Count  4</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     48</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        441</div><div class="sasNote">      Involuntary Context Switches      2</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           32</div><div class="sasNote">      </div><div class="sasSource">1182  </div><div class="sasSource">1183  proc casutil;</div><div class="sasNote" id="sasLogNote175_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1184    droptable casdata="price_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote176_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.025234 seconds.</div><div class="sasSource">1185    droptable casdata="ia_price_history" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote177_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.036684 seconds.</div><div class="sasSource">1186    droptable casdata="ia_price" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote178_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012137 seconds.</div><div class="sasSource">1187  /*   promote casdata="abt2_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">1188  run;</div><div class="sasSource">1189  </div><div class="sasSource">1190  </div><div class="sasSource">1191  /****** 3. Протяжка временных рядов ******/</div><div class="sasNote" id="sasLogNote179_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              115.50k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:47:13 PM</div><div class="sasNote">      Step Count                        57  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        13</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1192  proc casutil;</div><div class="sasNote" id="sasLogNote180_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1193    droptable casdata="abt3_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote181_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.011721 seconds.</div><div class="sasSource">1194  run;</div><div class="sasSource">1195  </div><div class="sasSource">1196  %let fc_end_sas=%sysfunc(inputn(%scan(%bquote(&amp;hist_end_dt),2,%bquote(' )),yymmdd10.));</div><div class="sasSource">1197  %let fc_end= %sysfunc(intnx(day,&amp;fc_end_sas, 91),yymmddd10.);</div><div class="sasSource">1198  </div><div class="sasNote" id="sasLogNote182_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.01 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              117.62k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:47:13 PM</div><div class="sasNote">      Step Count                        58  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     243</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1199  proc cas;</div><div class="sasSource">1200  timeData.timeSeries result =r /</div><div class="sasSource">1201  series={</div><div class="sasSource">1202  {name="sum_qty", setmiss="MISSING"},</div><div class="sasSource">1203  {name="GROSS_PRICE_AMT", setmiss="PREV"}</div><div class="sasSource">1204  }</div><div class="sasSource">1205  tEnd= "&amp;fc_end"</div><div class="sasSource">1206  table={</div><div class="sasSource">1207  caslib="public",</div><div class="sasSource">1208  name="abt2_ml",</div><div class="sasSource">1209  groupby={"PBO_LOCATION_ID","PRODUCT_ID", "CHANNEL_CD"}</div><div class="sasSource">1210  }</div><div class="sasSource">1211  timeId="SALES_DT"</div><div class="sasSource">1212  trimId="LEFT"</div><div class="sasSource">1213  interval="day"</div><div class="sasSource">1214  casOut={caslib="public", name="abt3_ml", replace=True}</div><div class="sasSource">1215  ;</div><div class="sasSource">1216  run;</div><div class="sasNote" id="sasLogNote183_1594283467627">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote184_1594283467627">NOTE: Added action set 'timeData'.</div><div class="sasSource">1217  quit;</div><div class="sasNote" id="sasLogNote185_1594283467627">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           5:23.19</div><div class="sasNote">      user cpu time       0.13 seconds</div><div class="sasNote">      system cpu time     0.08 seconds</div><div class="sasNote">      memory              10389.78k</div><div class="sasNote">      OS Memory           43916.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:52:36 PM</div><div class="sasNote">      Step Count                        59  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1429</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        1705</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           64</div><div class="sasNote">      </div><div class="sasSource">1218  </div><div class="sasSource">1219  proc casutil;</div><div class="sasNote" id="sasLogNote186_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1220  /*   promote casdata="abt3_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">1221  run;</div><div class="sasSource">1222  </div><div class="sasSource">1223  </div><div class="sasSource">1224  /****** 4. Фильтрация ******/</div><div class="sasSource">1225  /* 4.1 Убираем временные закрытия ПБО */</div><div class="sasNote" id="sasLogNote187_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.18k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:52:36 PM</div><div class="sasNote">      Step Count                        60  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1226  proc casutil;</div><div class="sasNote" id="sasLogNote188_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1227  </div><div class="sasSource">1227!  droptable casdata="pbo_closed_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote189_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.015987 seconds.</div><div class="sasSource">1228  </div><div class="sasSource">1228!  droptable casdata="abt4_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote190_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.014631 seconds.</div><div class="sasSource">1229  </div><div class="sasSource">1229!  load data=&amp;inlib..ia_pbo_close_period casout='ia_pbo_close_period' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote191_1594283467627">NOTE: ETL_STG.IA_PBO_CLOSE_PERIOD was successfully added to the "Public" caslib as "IA_PBO_CLOSE_PERIOD".</div><div class="sasSource">1230  run;</div><div class="sasSource">1231  </div><div class="sasSource">1232  /* заполняем пропуски в end_dt */</div><div class="sasNote" id="sasLogNote192_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           1.34 seconds</div><div class="sasNote">      user cpu time       0.12 seconds</div><div class="sasNote">      system cpu time     0.06 seconds</div><div class="sasNote">      memory              1518.93k</div><div class="sasNote">      OS Memory           34844.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:52:37 PM</div><div class="sasNote">      Step Count                        61  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     19022</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        607</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1233  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote193_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1234  create table public.pbo_closed_ml {options replace=true} as</div><div class="sasSource">1235  select</div><div class="sasSource">1236  CHANNEL_CD,</div><div class="sasSource">1237  PBO_LOCATION_ID,</div><div class="sasSource">1238  datepart(start_dt) as start_dt,</div><div class="sasSource">1239  coalesce(datepart(end_dt), date '2100-01-01') as end_dt,</div><div class="sasSource">1240  CLOSE_PERIOD_DESC</div><div class="sasSource">1241  from</div><div class="sasSource">1242  public.ia_pbo_close_period</div><div class="sasSource">1243  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote194_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table PBO_CLOSED_ML was created in caslib Public with 90845 rows returned.</div><div class="sasNote" id="sasLogNote195_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1244  quit;</div><div class="sasNote" id="sasLogNote196_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.23 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              87.43k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:52:37 PM</div><div class="sasNote">      Step Count                        62  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        25</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1245  </div><div class="sasSource">1246  /* Удалаем даты закрытия pbo из abt */</div><div class="sasSource">1247  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote197_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1248  create table public.abt4_ml{options replace=true} as</div><div class="sasSource">1249  select</div><div class="sasSource">1250  t1.PBO_LOCATION_ID,</div><div class="sasSource">1251  t1.PRODUCT_ID,</div><div class="sasSource">1252  t1.CHANNEL_CD,</div><div class="sasSource">1253  t1.SALES_DT,</div><div class="sasSource">1254  t1.sum_qty,</div><div class="sasSource">1255  t1.GROSS_PRICE_AMT</div><div class="sasSource">1256  from</div><div class="sasSource">1257  public.abt3_ml as t1</div><div class="sasSource">1258  left join</div><div class="sasSource">1259  public.pbo_closed_ml as t2</div><div class="sasSource">1260  on</div><div class="sasSource">1261  t1.sales_dt &gt;= t2.start_dt and</div><div class="sasSource">1262  t1.sales_dt &lt;= t2.end_dt and</div><div class="sasSource">1263  t1.pbo_location_id = t2.pbo_location_id and</div><div class="sasSource">1264  t1.channel_cd = t2.channel_cd</div><div class="sasSource">1265  where</div><div class="sasSource">1266  t2.pbo_location_id is missing</div><div class="sasSource">1267  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote198_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT4_ML was created in caslib Public with 255790388 rows returned.</div><div class="sasNote" id="sasLogNote199_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1268  quit;</div><div class="sasNote" id="sasLogNote200_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           42.14 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              168.18k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:53:20 PM</div><div class="sasNote">      Step Count                        63  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     25</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        247</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           32</div><div class="sasNote">      </div><div class="sasSource">1269  </div><div class="sasSource">1270  /* 4.2 Убираем закрытые насовсем магазины */</div><div class="sasSource">1271  proc casutil;</div><div class="sasNote" id="sasLogNote201_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1272  </div><div class="sasSource">1272!  load data=&amp;inlib..IA_PBO_LOC_ATTRIBUTES casout='IA_PBO_LOC_ATTRIBUTES' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote202_1594283467627">NOTE: ETL_STG.IA_PBO_LOC_ATTRIBUTES was successfully added to the "Public" caslib as "IA_PBO_LOC_ATTRIBUTES".</div><div class="sasSource">1273  </div><div class="sasSource">1273!  droptable casdata="closed_pbo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote203_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013561 seconds.</div><div class="sasSource">1274  run;</div><div class="sasSource">1275  </div><div class="sasNote" id="sasLogNote204_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              1514.96k</div><div class="sasNote">      OS Memory           34844.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:53:20 PM</div><div class="sasNote">      Step Count                        64  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1154</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        47</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1276  proc cas;</div><div class="sasSource">1277  transpose.transpose /</div><div class="sasSource">1278     table={name="ia_pbo_loc_attributes", caslib="public", groupby={"pbo_location_id"}}</div><div class="sasSource">1279     attributes={{name="pbo_location_id"}}</div><div class="sasSource">1280     transpose={"PBO_LOC_ATTR_VALUE"}</div><div class="sasSource">1281     prefix="A_"</div><div class="sasSource">1282     id={"PBO_LOC_ATTR_NM"}</div><div class="sasSource">1283     casout={name="attr_transposed", caslib="public", replace=true};</div><div class="sasSource">1284  quit;</div><div class="sasNote" id="sasLogNote205_1594283467627">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote206_1594283467627">NOTE: There were 14760 rows read from the table IA_PBO_LOC_ATTRIBUTES.</div><div class="sasNote" id="sasLogNote207_1594283467627">NOTE: The table attr_transposed has 820 rows and 21 columns.</div><div class="sasNote" id="sasLogNote208_1594283467627">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              10243.71k</div><div class="sasNote">      OS Memory           43916.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:53:20 PM</div><div class="sasNote">      Step Count                        65  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     990</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        13</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1285  </div><div class="sasSource">1286  /* Преобразовываем даты открытия и закрытия магазинов */</div><div class="sasSource">1287  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote209_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1288  create table public.closed_pbo{options replace=true} as</div><div class="sasSource">1289  select distinct</div><div class="sasSource">1290  pbo_location_id,</div><div class="sasSource">1291      cast(inputn(A_OPEN_DATE,'ddmmyy10.') as date) as OPEN_DATE,</div><div class="sasSource">1292      coalesce(</div><div class="sasSource">1293  cast(inputn(A_CLOSE_DATE,'ddmmyy10.') as date),</div><div class="sasSource">1294  date '2100-01-01'</div><div class="sasSource">1295  ) as CLOSE_DATE</div><div class="sasSource">1296  from public.attr_transposed</div><div class="sasSource">1297  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote210_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table CLOSED_PBO was created in caslib Public with 820 rows returned.</div><div class="sasNote" id="sasLogNote211_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1298  quit;</div><div class="sasNote" id="sasLogNote212_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.23 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              92.06k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:53:20 PM</div><div class="sasNote">      Step Count                        66  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     9</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        34</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1299  </div><div class="sasSource">1300  /* Удаляем закрытые насовсем магазины  */</div><div class="sasSource">1301  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote213_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1302  create table public.abt4_ml{options replace = true} as</div><div class="sasSource">1303  select</div><div class="sasSource">1304  t1.PBO_LOCATION_ID,</div><div class="sasSource">1305  t1.PRODUCT_ID,</div><div class="sasSource">1306  t1.CHANNEL_CD,</div><div class="sasSource">1307  t1.SALES_DT,</div><div class="sasSource">1308  t1.sum_qty,</div><div class="sasSource">1309  t1.GROSS_PRICE_AMT</div><div class="sasSource">1310  from</div><div class="sasSource">1311  public.abt4_ml as t1</div><div class="sasSource">1312  left join</div><div class="sasSource">1313  public.closed_pbo as t2</div><div class="sasSource">1314  on</div><div class="sasSource">1315  t1.pbo_location_id = t2.pbo_location_id and</div><div class="sasSource">1316  t1.sales_dt &gt;= OPEN_DATE and</div><div class="sasSource">1317  t1.sales_dt &lt;= CLOSE_DATE</div><div class="sasSource">1318  where</div><div class="sasSource">1319  t2.pbo_location_id is not missing</div><div class="sasSource">1320  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote214_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT4_ML was created in caslib Public with 255063328 rows returned.</div><div class="sasNote" id="sasLogNote215_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1321  quit;</div><div class="sasNote" id="sasLogNote216_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           30.90 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              166.46k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:53:51 PM</div><div class="sasNote">      Step Count                        67  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     15</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        182</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">1322  </div><div class="sasSource">1323  /* 4.3 Убираем из истории пропуски в продажах */</div><div class="sasSource">1324  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote217_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1325  create table public.abt4_ml{options replace=true} as</div><div class="sasSource">1326  select</div><div class="sasSource">1327  t1.PBO_LOCATION_ID,</div><div class="sasSource">1328  t1.PRODUCT_ID,</div><div class="sasSource">1329  t1.CHANNEL_CD,</div><div class="sasSource">1330  t1.SALES_DT,</div><div class="sasSource">1331  t1.sum_qty,</div><div class="sasSource">1332  t1.GROSS_PRICE_AMT</div><div class="sasSource">1333  from</div><div class="sasSource">1334  public.abt4_ml as t1</div><div class="sasSource">1335  where</div><div class="sasSource">1336  (t1.sum_qty is not missing and t1.sales_dt &lt;= &amp;hist_end_dt.) or</div><div class="sasSource">1337  (t1.sales_dt &gt; &amp;hist_end_dt.)</div><div class="sasSource">1338  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote218_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT4_ML was created in caslib Public with 165145014 rows returned.</div><div class="sasNote" id="sasLogNote219_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1339  quit;</div><div class="sasNote" id="sasLogNote220_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           32.87 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              167.87k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:54:24 PM</div><div class="sasNote">      Step Count                        68  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     17</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        196</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">1340  </div><div class="sasSource">1341  /* 4.4 Пересекаем с ассортиментной матрицей скоринговую витрину */</div><div class="sasSource">1342  proc casutil;</div><div class="sasNote" id="sasLogNote221_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1343  </div><div class="sasSource">1343!  load data=&amp;inlib..ia_assort_matrix casout='ia_assort_matrix' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote222_1594283467627">NOTE: ETL_STG.IA_ASSORT_MATRIX was successfully added to the "Public" caslib as "IA_ASSORT_MATRIX".</div><div class="sasSource">1344  run;</div><div class="sasSource">1345  </div><div class="sasNote" id="sasLogNote223_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.02 seconds</div><div class="sasNote">      memory              1517.87k</div><div class="sasNote">      OS Memory           34844.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:54:24 PM</div><div class="sasNote">      Step Count                        69  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1617</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        58</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1346  data public.assort_matrix;</div><div class="sasSource">1347  set public.ia_assort_matrix;</div><div class="sasSource">1348  format sales_dt date9.;</div><div class="sasSource">1349  do sales_dt=datepart(start_dt) to datepart(end_dt);</div><div class="sasSource">1350  output;</div><div class="sasSource">1351  sales_dt+1;</div><div class="sasSource">1352  end;</div><div class="sasSource">1353  run;</div><div class="sasNote" id="sasLogNote224_1594283467627">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote225_1594283467627">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote226_1594283467627">NOTE: There were 187409 observations read from the table IA_ASSORT_MATRIX in caslib Public.</div><div class="sasNote" id="sasLogNote227_1594283467627">NOTE: The table assort_matrix in caslib Public has 88451804 observations and 5 variables.</div><div class="sasNote" id="sasLogNote228_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           2.57 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1434.56k</div><div class="sasNote">      OS Memory           34840.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:54:27 PM</div><div class="sasNote">      Step Count                        70  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     230</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        86</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1354  </div><div class="sasSource">1355  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote229_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1356  create table public.assort_matrix {options replace=true} as</div><div class="sasSource">1357  select distinct</div><div class="sasSource">1358  PBO_LOCATION_ID,</div><div class="sasSource">1359  PRODUCT_ID,</div><div class="sasSource">1360  sales_dt</div><div class="sasSource">1361  from public.assort_matrix</div><div class="sasSource">1362  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote230_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ASSORT_MATRIX was created in caslib Public with 88204852 rows returned.</div><div class="sasNote" id="sasLogNote231_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1363  quit;</div><div class="sasNote" id="sasLogNote232_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           44.47 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              167.75k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:55:11 PM</div><div class="sasNote">      Step Count                        71  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     26</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        262</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">1364  </div><div class="sasSource">1365  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote233_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1366  create table public.abt4_ml {options replace = true} as</div><div class="sasSource">1367  select</div><div class="sasSource">1368  t1.PBO_LOCATION_ID,</div><div class="sasSource">1369  t1.PRODUCT_ID,</div><div class="sasSource">1370  t1.CHANNEL_CD,</div><div class="sasSource">1371  t1.SALES_DT,</div><div class="sasSource">1372  t1.sum_qty,</div><div class="sasSource">1373  t1.GROSS_PRICE_AMT</div><div class="sasSource">1374  from</div><div class="sasSource">1375  public.abt4_ml as t1</div><div class="sasSource">1376  left join</div><div class="sasSource">1377  public.assort_matrix  t2</div><div class="sasSource">1378  on</div><div class="sasSource">1379  t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">1380  t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">1381  t1.SALES_DT = t2.SALES_DT</div><div class="sasSource">1382  where</div><div class="sasSource">1383  (t1.SALES_DT &lt;= &amp;hist_end_dt) or</div><div class="sasSource">1384  (t2.PBO_LOCATION_ID is not missing)</div><div class="sasSource">1385  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote234_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT4_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote235_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1386  quit;</div><div class="sasNote" id="sasLogNote236_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           2:51.01</div><div class="sasNote">      user cpu time       0.07 seconds</div><div class="sasNote">      system cpu time     0.03 seconds</div><div class="sasNote">      memory              254.34k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:58:02 PM</div><div class="sasNote">      Step Count                        72  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     69</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        915</div><div class="sasNote">      Involuntary Context Switches      2</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           72</div><div class="sasNote">      </div><div class="sasSource">1387  </div><div class="sasSource">1388  proc casutil;</div><div class="sasNote" id="sasLogNote237_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1389  </div><div class="sasSource">1389!  droptable casdata="pbo_closed_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote238_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.034572 seconds.</div><div class="sasSource">1390  </div><div class="sasSource">1390!  droptable casdata="closed_pbo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote239_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.014669 seconds.</div><div class="sasSource">1391  </div><div class="sasSource">1391!  droptable casdata="ia_assort_matrix" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote240_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010682 seconds.</div><div class="sasSource">1392  </div><div class="sasSource">1392!  droptable casdata="ia_pbo_close_period" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote241_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.027081 seconds.</div><div class="sasSource">1393  </div><div class="sasSource">1393!  droptable casdata="IA_PBO_LOC_ATTRIBUTES" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote242_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012075 seconds.</div><div class="sasSource">1394  </div><div class="sasSource">1394!  droptable casdata="attr_transposed" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote243_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010386 seconds.</div><div class="sasSource">1395  /* promote casdata="abt4_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">1396  run;</div><div class="sasSource">1397  </div><div class="sasSource">1398  </div><div class="sasSource">1399  /****** 5. Подсчет лагов ******/</div><div class="sasNote" id="sasLogNote244_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.16 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              116.15k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:58:02 PM</div><div class="sasNote">      Step Count                        73  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1400  proc casutil;</div><div class="sasNote" id="sasLogNote245_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1401    droptable casdata='lag_abt1' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote246_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.015664 seconds.</div><div class="sasSource">1402    droptable casdata='lag_abt2' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote247_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.014339 seconds.</div><div class="sasSource">1403    droptable casdata='lag_abt3' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote248_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.014147 seconds.</div><div class="sasSource">1404    droptable casdata='abt5_ml' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote249_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013475 seconds.</div><div class="sasSource">1405  run;</div><div class="sasSource">1406  </div><div class="sasSource">1407  /* Макрос разворачивает переменную var в список элементов массива,</div><div class="sasSource">1407! разделенных запятой */</div><div class="sasSource">1408  /* var[t-0],var[t-1],var[t-2],... */</div><div class="sasSource">1409  %macro argt(var,index,start,end);</div><div class="sasSource">1410  %do ii=&amp;start. %to &amp;end.;</div><div class="sasSource">1411   &amp;var.[&amp;index.-&amp;ii.]</div><div class="sasSource">1412   %if &amp;ii. ne &amp;end. %then %do;</div><div class="sasSource">1413    ,</div><div class="sasSource">1414   %end;</div><div class="sasSource">1415  %end;</div><div class="sasSource">1416  %mend argt;</div><div class="sasNote" id="sasLogNote250_1594283467627">NOTE: The macro ARGT completed compilation without errors.</div><div class="sasNote">      25 instructions 592 bytes.</div><div class="sasSource">1417  </div><div class="sasSource">1418  /* Перекодирование числа дней в название интервала*/</div><div class="sasSource">1419  %macro namet(l_int);</div><div class="sasSource">1420  %if &amp;l_int=7 %then week ;</div><div class="sasSource">1421  %if &amp;l_int=30 %then month ;</div><div class="sasSource">1422  %if &amp;l_int=90 %then qtr ;</div><div class="sasSource">1423  %if &amp;l_int=180 %then halfyear ;</div><div class="sasSource">1424  %if &amp;l_int=365 %then year ;</div><div class="sasSource">1425  %mend namet;</div><div class="sasNote" id="sasLogNote251_1594283467627">NOTE: The macro NAMET completed compilation without errors.</div><div class="sasNote">      35 instructions 752 bytes.</div><div class="sasSource">1426  </div><div class="sasSource">1427  /* считаем медиану и среднее арифметическое */</div><div class="sasSource">1428  %macro cmpcode;</div><div class="sasSource">1429  proc cas;</div><div class="sasSource">1430  timeData.runTimeCode result=r /</div><div class="sasSource">1431  table = {</div><div class="sasSource">1432  name ='abt4_ml',</div><div class="sasSource">1433  caslib = 'public',</div><div class="sasSource">1434          groupBy = {</div><div class="sasSource">1435  {name = 'PRODUCT_ID'},</div><div class="sasSource">1436  {name = 'PBO_LOCATION_ID'},</div><div class="sasSource">1437  {name = 'CHANNEL_CD'}</div><div class="sasSource">1438  }</div><div class="sasSource">1439  },</div><div class="sasSource">1440   series = {{name='sum_qty'}},</div><div class="sasSource">1441   interval='DAY',</div><div class="sasSource">1442  timeId = {name='SALES_DT'},</div><div class="sasSource">1443  trimId = "LEFT",</div><div class="sasSource">1444  code=</div><div class="sasSource">1445  %unquote(%str(%"))</div><div class="sasSource">1446  %let names=; /*будущий список выходных переменных для proc cas */</div><div class="sasSource">1447  %let minlag=91; /*параметр MinLag*/</div><div class="sasSource">1448  /*-=-=-=-=-= min_lag + окна -=-=-=-=-=-*/</div><div class="sasSource">1449  %let window_list = 7 30 90 180 365;</div><div class="sasSource">1450  %let lag=&amp;minlag;</div><div class="sasSource">1451  %let n_win_list=%sysfunc(countw(&amp;window_list.));</div><div class="sasSource">1452  %do ic=1 %to &amp;n_win_list.;</div><div class="sasSource">1453    %let window=%scan(&amp;window_list,&amp;ic); /*текущее окно*/</div><div class="sasSource">1454    %let intnm=%namet(&amp;window);        /*название интервала окна; 7-&gt;week итд */</div><div class="sasSource">1455    %let intnm=%sysfunc(strip(&amp;intnm.));</div><div class="sasSource">1456    do t = %eval(&amp;lag+&amp;window) to _length_; /*from=(lag)+(window)*/</div><div class="sasSource">1457      lag_&amp;intnm._avg[t]=mean(%argt(sum_qty,t,%eval(&amp;lag),%eval(&amp;lag+&amp;window-1)));</div><div class="sasSource">1458      lag_&amp;intnm._med[t]=median(%argt(sum_qty,t,%eval(&amp;lag),%eval(&amp;lag+&amp;window-1)));</div><div class="sasSource">1459    end;</div><div class="sasSource">1460   %let names={name=%tslit(lag_&amp;intnm._avg)}, &amp;names;</div><div class="sasSource">1461   %let names={name=%tslit(lag_&amp;intnm._med)}, &amp;names;</div><div class="sasSource">1462  </div><div class="sasSource">1463  %end; /* ic over window_list*/</div><div class="sasSource">1464  /*remove last comma from names*/</div><div class="sasSource">1465  %let len=%length(&amp;names);</div><div class="sasSource">1466  %let names=%substr(%quote(&amp;names),1,%eval(&amp;len-1));</div><div class="sasSource">1467  /*-=-=-завершающий код proc cas=-=-=*/</div><div class="sasSource">1468  %unquote(%str(%"))</div><div class="sasSource">1469  ,</div><div class="sasSource">1470  arrayOut={</div><div class="sasSource">1471  table={name='lag_abt1', replace=true, caslib='Public'},</div><div class="sasSource">1472      arrays={&amp;names}</div><div class="sasSource">1473  }</div><div class="sasSource">1474  ;</div><div class="sasSource">1475  run;</div><div class="sasSource">1476  quit;</div><div class="sasSource">1477  %mend cmpcode;</div><div class="sasNote" id="sasLogNote252_1594283467627">NOTE: The macro CMPCODE completed compilation without errors.</div><div class="sasNote">      67 instructions 2136 bytes.</div><div class="sasSource">1478  </div><div class="sasSource">1479  %cmpcode</div><div class="sasNote" id="sasLogNote253_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.08 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              631.03k</div><div class="sasNote">      OS Memory           34328.00k</div><div class="sasNote">      Timestamp           07/08/2020 09:58:02 PM</div><div class="sasNote">      Step Count                        74  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     195</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        16</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">MPRINT(CMPCODE):   proc cas;</div><div class="sasSource">MPRINT(CMPCODE):   timeData.runTimeCode result=r / table = { name ='abt4_ml', caslib = 'public', groupBy = { {name = 'PRODUCT_ID'}, </div><div class="sasSource">{name = 'PBO_LOCATION_ID'}, {name = 'CHANNEL_CD'} } }, series = {{name='sum_qty'}}, interval='DAY', timeId = {name='SALES_DT'}, </div><div class="sasSource">trimId = "LEFT", code=</div><div class="sasNote" id="sasLogNote254_1594283467627">NOTE: The quoted string currently being processed has become more than 262 bytes long.  You might have unbalanced quotation marks.</div><div class="sasNote" id="sasLogNote255_1594283467627">NOTE: The macro TSLIT completed compilation without errors.</div><div class="sasNote">      46 instructions 992 bytes.</div><div class="sasSource">MPRINT(CMPCODE):   "     do t = 98 to _length_;        lag_week_avg[t]=mean(sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   , </div><div class="sasSource"> sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]);       lag_week_med[t]=median(sum_qty[t-91]   ,  </div><div class="sasSource">sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]);     end;     do t = </div><div class="sasSource">121 to _length_;        lag_month_avg[t]=mean(sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  </div><div class="sasSource">sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   </div><div class="sasSource">,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  </div><div class="sasSource">sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  </div><div class="sasSource">sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  </div><div class="sasSource">sum_qty[t-120]);       lag_month_med[t]=median(sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  </div><div class="sasSource">sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   </div><div class="sasSource">,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  </div><div class="sasSource">sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  </div><div class="sasSource">sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  </div><div class="sasSource">sum_qty[t-120]);     end;     do t = 181 to _length_;        lag_qtr_avg[t]=mean(sum_qty[t-91]   ,  sum_qty[t-92]   ,  </div><div class="sasSource">sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   , </div><div class="sasSource"> sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  </div><div class="sasSource">sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  </div><div class="sasSource">sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  </div><div class="sasSource">sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  </div><div class="sasSource">sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  </div><div class="sasSource">sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  </div><div class="sasSource">sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  </div><div class="sasSource">sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  </div><div class="sasSource">sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  </div><div class="sasSource">sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  </div><div class="sasSource">sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  </div><div class="sasSource">sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  </div><div class="sasSource">sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  </div><div class="sasSource">sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]);       lag_qtr_med[t]=median(sum_qty[t-91]   ,  sum_qty[t-92]   ,  </div><div class="sasSource">sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   , </div><div class="sasSource"> sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  </div><div class="sasSource">sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  </div><div class="sasSource">sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  </div><div class="sasSource">sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  </div><div class="sasSource">sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  </div><div class="sasSource">sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  </div><div class="sasSource">sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  </div><div class="sasSource">sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  </div><div class="sasSource">sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  </div><div class="sasSource">sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  </div><div class="sasSource">sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  </div><div class="sasSource">sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  </div><div class="sasSource">sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  </div><div class="sasSource">sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]);     end;     do t = 271 to _length_;        </div><div class="sasSource">lag_halfyear_avg[t]=mean(sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  </div><div class="sasSource">sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]  </div><div class="sasSource"> ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  </div><div class="sasSource">sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  </div><div class="sasSource">sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  </div><div class="sasSource">sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  </div><div class="sasSource">sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  </div><div class="sasSource">sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  </div><div class="sasSource">sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  </div><div class="sasSource">sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  </div><div class="sasSource">sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  </div><div class="sasSource">sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  </div><div class="sasSource">sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  </div><div class="sasSource">sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  </div><div class="sasSource">sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  </div><div class="sasSource">sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  </div><div class="sasSource">sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  </div><div class="sasSource">sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  </div><div class="sasSource">sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  </div><div class="sasSource">sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  </div><div class="sasSource">sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  </div><div class="sasSource">sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]   ,  sum_qty[t-222]   ,  </div><div class="sasSource">sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  sum_qty[t-226]   ,  sum_qty[t-227]   ,  sum_qty[t-228]   ,  </div><div class="sasSource">sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  sum_qty[t-232]   ,  sum_qty[t-233]   ,  sum_qty[t-234]   ,  </div><div class="sasSource">sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  sum_qty[t-238]   ,  sum_qty[t-239]   ,  sum_qty[t-240]   ,  </div><div class="sasSource">sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  sum_qty[t-244]   ,  sum_qty[t-245]   ,  sum_qty[t-246]   ,  </div><div class="sasSource">sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  sum_qty[t-250]   ,  sum_qty[t-251]   ,  sum_qty[t-252]   ,  </div><div class="sasSource">sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  sum_qty[t-256]   ,  sum_qty[t-257]   ,  sum_qty[t-258]   ,  </div><div class="sasSource">sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  sum_qty[t-262]   ,  sum_qty[t-263]   ,  sum_qty[t-264]   ,  </div><div class="sasSource">sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  sum_qty[t-268]   ,  sum_qty[t-269]   ,  sum_qty[t-270]);       </div><div class="sasSource">lag_halfyear_med[t]=median(sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  </div><div class="sasSource">sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]  </div><div class="sasSource"> ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  </div><div class="sasSource">sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  </div><div class="sasSource">sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  </div><div class="sasSource">sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  </div><div class="sasSource">sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  </div><div class="sasSource">sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  </div><div class="sasSource">sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  </div><div class="sasSource">sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  </div><div class="sasSource">sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  </div><div class="sasSource">sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  </div><div class="sasSource">sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  </div><div class="sasSource">sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  </div><div class="sasSource">sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  </div><div class="sasSource">sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  </div><div class="sasSource">sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  </div><div class="sasSource">sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  </div><div class="sasSource">sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  </div><div class="sasSource">sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  </div><div class="sasSource">sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  </div><div class="sasSource">sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]   ,  sum_qty[t-222]   ,  </div><div class="sasSource">sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  sum_qty[t-226]   ,  sum_qty[t-227]   ,  sum_qty[t-228]   ,  </div><div class="sasSource">sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  sum_qty[t-232]   ,  sum_qty[t-233]   ,  sum_qty[t-234]   ,  </div><div class="sasSource">sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  sum_qty[t-238]   ,  sum_qty[t-239]   ,  sum_qty[t-240]   ,  </div><div class="sasSource">sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  sum_qty[t-244]   ,  sum_qty[t-245]   ,  sum_qty[t-246]   ,  </div><div class="sasSource">sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  sum_qty[t-250]   ,  sum_qty[t-251]   ,  sum_qty[t-252]   ,  </div><div class="sasSource">sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  sum_qty[t-256]   ,  sum_qty[t-257]   ,  sum_qty[t-258]   ,  </div><div class="sasSource">sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  sum_qty[t-262]   ,  sum_qty[t-263]   ,  sum_qty[t-264]   ,  </div><div class="sasSource">sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  sum_qty[t-268]   ,  sum_qty[t-269]   ,  sum_qty[t-270]);     end;     </div><div class="sasSource">do t = 456 to _length_;        lag_year_avg[t]=mean(sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  </div><div class="sasSource">sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   </div><div class="sasSource">,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  </div><div class="sasSource">sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  </div><div class="sasSource">sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  </div><div class="sasSource">sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  </div><div class="sasSource">sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  </div><div class="sasSource">sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  </div><div class="sasSource">sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  </div><div class="sasSource">sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  </div><div class="sasSource">sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  </div><div class="sasSource">sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  </div><div class="sasSource">sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  </div><div class="sasSource">sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  </div><div class="sasSource">sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  </div><div class="sasSource">sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  </div><div class="sasSource">sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  </div><div class="sasSource">sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  </div><div class="sasSource">sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  </div><div class="sasSource">sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  </div><div class="sasSource">sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  </div><div class="sasSource">sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]   ,  </div><div class="sasSource">sum_qty[t-222]   ,  sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  sum_qty[t-226]   ,  sum_qty[t-227]   ,  </div><div class="sasSource">sum_qty[t-228]   ,  sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  sum_qty[t-232]   ,  sum_qty[t-233]   ,  </div><div class="sasSource">sum_qty[t-234]   ,  sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  sum_qty[t-238]   ,  sum_qty[t-239]   ,  </div><div class="sasSource">sum_qty[t-240]   ,  sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  sum_qty[t-244]   ,  sum_qty[t-245]   ,  </div><div class="sasSource">sum_qty[t-246]   ,  sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  sum_qty[t-250]   ,  sum_qty[t-251]   ,  </div><div class="sasSource">sum_qty[t-252]   ,  sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  sum_qty[t-256]   ,  sum_qty[t-257]   ,  </div><div class="sasSource">sum_qty[t-258]   ,  sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  sum_qty[t-262]   ,  sum_qty[t-263]   ,  </div><div class="sasSource">sum_qty[t-264]   ,  sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  sum_qty[t-268]   ,  sum_qty[t-269]   ,  </div><div class="sasSource">sum_qty[t-270]   ,  sum_qty[t-271]   ,  sum_qty[t-272]   ,  sum_qty[t-273]   ,  sum_qty[t-274]   ,  sum_qty[t-275]   ,  </div><div class="sasSource">sum_qty[t-276]   ,  sum_qty[t-277]   ,  sum_qty[t-278]   ,  sum_qty[t-279]   ,  sum_qty[t-280]   ,  sum_qty[t-281]   ,  </div><div class="sasSource">sum_qty[t-282]   ,  sum_qty[t-283]   ,  sum_qty[t-284]   ,  sum_qty[t-285]   ,  sum_qty[t-286]   ,  sum_qty[t-287]   ,  </div><div class="sasSource">sum_qty[t-288]   ,  sum_qty[t-289]   ,  sum_qty[t-290]   ,  sum_qty[t-291]   ,  sum_qty[t-292]   ,  sum_qty[t-293]   ,  </div><div class="sasSource">sum_qty[t-294]   ,  sum_qty[t-295]   ,  sum_qty[t-296]   ,  sum_qty[t-297]   ,  sum_qty[t-298]   ,  sum_qty[t-299]   ,  </div><div class="sasSource">sum_qty[t-300]   ,  sum_qty[t-301]   ,  sum_qty[t-302]   ,  sum_qty[t-303]   ,  sum_qty[t-304]   ,  sum_qty[t-305]   ,  </div><div class="sasSource">sum_qty[t-306]   ,  sum_qty[t-307]   ,  sum_qty[t-308]   ,  sum_qty[t-309]   ,  sum_qty[t-310]   ,  sum_qty[t-311]   ,  </div><div class="sasSource">sum_qty[t-312]   ,  sum_qty[t-313]   ,  sum_qty[t-314]   ,  sum_qty[t-315]   ,  sum_qty[t-316]   ,  sum_qty[t-317]   ,  </div><div class="sasSource">sum_qty[t-318]   ,  sum_qty[t-319]   ,  sum_qty[t-320]   ,  sum_qty[t-321]   ,  sum_qty[t-322]   ,  sum_qty[t-323]   ,  </div><div class="sasSource">sum_qty[t-324]   ,  sum_qty[t-325]   ,  sum_qty[t-326]   ,  sum_qty[t-327]   ,  sum_qty[t-328]   ,  sum_qty[t-329]   ,  </div><div class="sasSource">sum_qty[t-330]   ,  sum_qty[t-331]   ,  sum_qty[t-332]   ,  sum_qty[t-333]   ,  sum_qty[t-334]   ,  sum_qty[t-335]   ,  </div><div class="sasSource">sum_qty[t-336]   ,  sum_qty[t-337]   ,  sum_qty[t-338]   ,  sum_qty[t-339]   ,  sum_qty[t-340]   ,  sum_qty[t-341]   ,  </div><div class="sasSource">sum_qty[t-342]   ,  sum_qty[t-343]   ,  sum_qty[t-344]   ,  sum_qty[t-345]   ,  sum_qty[t-346]   ,  sum_qty[t-347]   ,  </div><div class="sasSource">sum_qty[t-348]   ,  sum_qty[t-349]   ,  sum_qty[t-350]   ,  sum_qty[t-351]   ,  sum_qty[t-352]   ,  sum_qty[t-353]   ,  </div><div class="sasSource">sum_qty[t-354]   ,  sum_qty[t-355]   ,  sum_qty[t-356]   ,  sum_qty[t-357]   ,  sum_qty[t-358]   ,  sum_qty[t-359]   ,  </div><div class="sasSource">sum_qty[t-360]   ,  sum_qty[t-361]   ,  sum_qty[t-362]   ,  sum_qty[t-363]   ,  sum_qty[t-364]   ,  sum_qty[t-365]   ,  </div><div class="sasSource">sum_qty[t-366]   ,  sum_qty[t-367]   ,  sum_qty[t-368]   ,  sum_qty[t-369]   ,  sum_qty[t-370]   ,  sum_qty[t-371]   ,  </div><div class="sasSource">sum_qty[t-372]   ,  sum_qty[t-373]   ,  sum_qty[t-374]   ,  sum_qty[t-375]   ,  sum_qty[t-376]   ,  sum_qty[t-377]   ,  </div><div class="sasSource">sum_qty[t-378]   ,  sum_qty[t-379]   ,  sum_qty[t-380]   ,  sum_qty[t-381]   ,  sum_qty[t-382]   ,  sum_qty[t-383]   ,  </div><div class="sasSource">sum_qty[t-384]   ,  sum_qty[t-385]   ,  sum_qty[t-386]   ,  sum_qty[t-387]   ,  sum_qty[t-388]   ,  sum_qty[t-389]   ,  </div><div class="sasSource">sum_qty[t-390]   ,  sum_qty[t-391]   ,  sum_qty[t-392]   ,  sum_qty[t-393]   ,  sum_qty[t-394]   ,  sum_qty[t-395]   ,  </div><div class="sasSource">sum_qty[t-396]   ,  sum_qty[t-397]   ,  sum_qty[t-398]   ,  sum_qty[t-399]   ,  sum_qty[t-400]   ,  sum_qty[t-401]   ,  </div><div class="sasSource">sum_qty[t-402]   ,  sum_qty[t-403]   ,  sum_qty[t-404]   ,  sum_qty[t-405]   ,  sum_qty[t-406]   ,  sum_qty[t-407]   ,  </div><div class="sasSource">sum_qty[t-408]   ,  sum_qty[t-409]   ,  sum_qty[t-410]   ,  sum_qty[t-411]   ,  sum_qty[t-412]   ,  sum_qty[t-413]   ,  </div><div class="sasSource">sum_qty[t-414]   ,  sum_qty[t-415]   ,  sum_qty[t-416]   ,  sum_qty[t-417]   ,  sum_qty[t-418]   ,  sum_qty[t-419]   ,  </div><div class="sasSource">sum_qty[t-420]   ,  sum_qty[t-421]   ,  sum_qty[t-422]   ,  sum_qty[t-423]   ,  sum_qty[t-424]   ,  sum_qty[t-425]   ,  </div><div class="sasSource">sum_qty[t-426]   ,  sum_qty[t-427]   ,  sum_qty[t-428]   ,  sum_qty[t-429]   ,  sum_qty[t-430]   ,  sum_qty[t-431]   ,  </div><div class="sasSource">sum_qty[t-432]   ,  sum_qty[t-433]   ,  sum_qty[t-434]   ,  sum_qty[t-435]   ,  sum_qty[t-436]   ,  sum_qty[t-437]   ,  </div><div class="sasSource">sum_qty[t-438]   ,  sum_qty[t-439]   ,  sum_qty[t-440]   ,  sum_qty[t-441]   ,  sum_qty[t-442]   ,  sum_qty[t-443]   ,  </div><div class="sasSource">sum_qty[t-444]   ,  sum_qty[t-445]   ,  sum_qty[t-446]   ,  sum_qty[t-447]   ,  sum_qty[t-448]   ,  sum_qty[t-449]   ,  </div><div class="sasSource">sum_qty[t-450]   ,  sum_qty[t-451]   ,  sum_qty[t-452]   ,  sum_qty[t-453]   ,  sum_qty[t-454]   ,  sum_qty[t-455]);       </div><div class="sasSource">lag_year_med[t]=median(sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96] </div><div class="sasSource">  ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  </div><div class="sasSource">sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  </div><div class="sasSource">sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  </div><div class="sasSource">sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  </div><div class="sasSource">sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  </div><div class="sasSource">sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  </div><div class="sasSource">sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  </div><div class="sasSource">sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  </div><div class="sasSource">sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  </div><div class="sasSource">sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  </div><div class="sasSource">sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  </div><div class="sasSource">sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  </div><div class="sasSource">sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  </div><div class="sasSource">sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  </div><div class="sasSource">sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  </div><div class="sasSource">sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  </div><div class="sasSource">sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  </div><div class="sasSource">sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  </div><div class="sasSource">sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  </div><div class="sasSource">sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  </div><div class="sasSource">sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]   ,  sum_qty[t-222]   ,  </div><div class="sasSource">sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  sum_qty[t-226]   ,  sum_qty[t-227]   ,  sum_qty[t-228]   ,  </div><div class="sasSource">sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  sum_qty[t-232]   ,  sum_qty[t-233]   ,  sum_qty[t-234]   ,  </div><div class="sasSource">sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  sum_qty[t-238]   ,  sum_qty[t-239]   ,  sum_qty[t-240]   ,  </div><div class="sasSource">sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  sum_qty[t-244]   ,  sum_qty[t-245]   ,  sum_qty[t-246]   ,  </div><div class="sasSource">sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  sum_qty[t-250]   ,  sum_qty[t-251]   ,  sum_qty[t-252]   ,  </div><div class="sasSource">sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  sum_qty[t-256]   ,  sum_qty[t-257]   ,  sum_qty[t-258]   ,  </div><div class="sasSource">sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  sum_qty[t-262]   ,  sum_qty[t-263]   ,  sum_qty[t-264]   ,  </div><div class="sasSource">sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  sum_qty[t-268]   ,  sum_qty[t-269]   ,  sum_qty[t-270]   ,  </div><div class="sasSource">sum_qty[t-271]   ,  sum_qty[t-272]   ,  sum_qty[t-273]   ,  sum_qty[t-274]   ,  sum_qty[t-275]   ,  sum_qty[t-276]   ,  </div><div class="sasSource">sum_qty[t-277]   ,  sum_qty[t-278]   ,  sum_qty[t-279]   ,  sum_qty[t-280]   ,  sum_qty[t-281]   ,  sum_qty[t-282]   ,  </div><div class="sasSource">sum_qty[t-283]   ,  sum_qty[t-284]   ,  sum_qty[t-285]   ,  sum_qty[t-286]   ,  sum_qty[t-287]   ,  sum_qty[t-288]   ,  </div><div class="sasSource">sum_qty[t-289]   ,  sum_qty[t-290]   ,  sum_qty[t-291]   ,  sum_qty[t-292]   ,  sum_qty[t-293]   ,  sum_qty[t-294]   ,  </div><div class="sasSource">sum_qty[t-295]   ,  sum_qty[t-296]   ,  sum_qty[t-297]   ,  sum_qty[t-298]   ,  sum_qty[t-299]   ,  sum_qty[t-300]   ,  </div><div class="sasSource">sum_qty[t-301]   ,  sum_qty[t-302]   ,  sum_qty[t-303]   ,  sum_qty[t-304]   ,  sum_qty[t-305]   ,  sum_qty[t-306]   ,  </div><div class="sasSource">sum_qty[t-307]   ,  sum_qty[t-308]   ,  sum_qty[t-309]   ,  sum_qty[t-310]   ,  sum_qty[t-311]   ,  sum_qty[t-312]   ,  </div><div class="sasSource">sum_qty[t-313]   ,  sum_qty[t-314]   ,  sum_qty[t-315]   ,  sum_qty[t-316]   ,  sum_qty[t-317]   ,  sum_qty[t-318]   ,  </div><div class="sasSource">sum_qty[t-319]   ,  sum_qty[t-320]   ,  sum_qty[t-321]   ,  sum_qty[t-322]   ,  sum_qty[t-323]   ,  sum_qty[t-324]   ,  </div><div class="sasSource">sum_qty[t-325]   ,  sum_qty[t-326]   ,  sum_qty[t-327]   ,  sum_qty[t-328]   ,  sum_qty[t-329]   ,  sum_qty[t-330]   ,  </div><div class="sasSource">sum_qty[t-331]   ,  sum_qty[t-332]   ,  sum_qty[t-333]   ,  sum_qty[t-334]   ,  sum_qty[t-335]   ,  sum_qty[t-336]   ,  </div><div class="sasSource">sum_qty[t-337]   ,  sum_qty[t-338]   ,  sum_qty[t-339]   ,  sum_qty[t-340]   ,  sum_qty[t-341]   ,  sum_qty[t-342]   ,  </div><div class="sasSource">sum_qty[t-343]   ,  sum_qty[t-344]   ,  sum_qty[t-345]   ,  sum_qty[t-346]   ,  sum_qty[t-347]   ,  sum_qty[t-348]   ,  </div><div class="sasSource">sum_qty[t-349]   ,  sum_qty[t-350]   ,  sum_qty[t-351]   ,  sum_qty[t-352]   ,  sum_qty[t-353]   ,  sum_qty[t-354]   ,  </div><div class="sasSource">sum_qty[t-355]   ,  sum_qty[t-356]   ,  sum_qty[t-357]   ,  sum_qty[t-358]   ,  sum_qty[t-359]   ,  sum_qty[t-360]   ,  </div><div class="sasSource">sum_qty[t-361]   ,  sum_qty[t-362]   ,  sum_qty[t-363]   ,  sum_qty[t-364]   ,  sum_qty[t-365]   ,  sum_qty[t-366]   ,  </div><div class="sasSource">sum_qty[t-367]   ,  sum_qty[t-368]   ,  sum_qty[t-369]   ,  sum_qty[t-370]   ,  sum_qty[t-371]   ,  sum_qty[t-372]   ,  </div><div class="sasSource">sum_qty[t-373]   ,  sum_qty[t-374]   ,  sum_qty[t-375]   ,  sum_qty[t-376]   ,  sum_qty[t-377]   ,  sum_qty[t-378]   ,  </div><div class="sasSource">sum_qty[t-379]   ,  sum_qty[t-380]   ,  sum_qty[t-381]   ,  sum_qty[t-382]   ,  sum_qty[t-383]   ,  sum_qty[t-384]   ,  </div><div class="sasSource">sum_qty[t-385]   ,  sum_qty[t-386]   ,  sum_qty[t-387]   ,  sum_qty[t-388]   ,  sum_qty[t-389]   ,  sum_qty[t-390]   ,  </div><div class="sasSource">sum_qty[t-391]   ,  sum_qty[t-392]   ,  sum_qty[t-393]   ,  sum_qty[t-394]   ,  sum_qty[t-395]   ,  sum_qty[t-396]   ,  </div><div class="sasSource">sum_qty[t-397]   ,  sum_qty[t-398]   ,  sum_qty[t-399]   ,  sum_qty[t-400]   ,  sum_qty[t-401]   ,  sum_qty[t-402]   ,  </div><div class="sasSource">sum_qty[t-403]   ,  sum_qty[t-404]   ,  sum_qty[t-405]   ,  sum_qty[t-406]   ,  sum_qty[t-407]   ,  sum_qty[t-408]   ,  </div><div class="sasSource">sum_qty[t-409]   ,  sum_qty[t-410]   ,  sum_qty[t-411]   ,  sum_qty[t-412]   ,  sum_qty[t-413]   ,  sum_qty[t-414]   ,  </div><div class="sasSource">sum_qty[t-415]   ,  sum_qty[t-416]   ,  sum_qty[t-417]   ,  sum_qty[t-418]   ,  sum_qty[t-419]   ,  sum_qty[t-420]   ,  </div><div class="sasSource">sum_qty[t-421]   ,  sum_qty[t-422]   ,  sum_qty[t-423]   ,  sum_qty[t-424]   ,  sum_qty[t-425]   ,  sum_qty[t-426]   ,  </div><div class="sasSource">sum_qty[t-427]   ,  sum_qty[t-428]   ,  sum_qty[t-429]   ,  sum_qty[t-430]   ,  sum_qty[t-431]   ,  sum_qty[t-432]   ,  </div><div class="sasSource">sum_qty[t-433]   ,  sum_qty[t-434]   ,  sum_qty[t-435]   ,  sum_qty[t-436]   ,  sum_qty[t-437]   ,  sum_qty[t-438]   ,  </div><div class="sasSource">sum_qty[t-439]   ,  sum_qty[t-440]   ,  sum_qty[t-441]   ,  sum_qty[t-442]   ,  sum_qty[t-443]   ,  sum_qty[t-444]   ,  </div><div class="sasSource">sum_qty[t-445]   ,  sum_qty[t-446]   ,  sum_qty[t-447]   ,  sum_qty[t-448]   ,  sum_qty[t-449]   ,  sum_qty[t-450]   ,  </div><div class="sasSource">sum_qty[t-451]   ,  sum_qty[t-452]   ,  sum_qty[t-453]   ,  sum_qty[t-454]   ,  sum_qty[t-455]);     end;      " , arrayOut={ </div><div class="sasSource">table={name='lag_abt1', replace=true, caslib='Public'}, arrays={{name='lag_year_med'}, {name='lag_year_avg'}, </div><div class="sasSource">{name='lag_halfyear_med'}, {name='lag_halfyear_avg'}, {name='lag_qtr_med'}, {name='lag_qtr_avg'}, {name='lag_month_med'}, </div><div class="sasSource">{name='lag_month_avg'}, {name='lag_week_med'}, {name='lag_week_avg'}} } ;</div><div class="sasSource">MPRINT(CMPCODE):   run;</div><div class="sasNote" id="sasLogNote256_1594283467627">NOTE: Active Session now CASAUTO.</div><div class="sasSource">MPRINT(CMPCODE):   quit;</div><div class="sasNote" id="sasLogNote257_1594283467627">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           10:46.86</div><div class="sasNote">      user cpu time       1.75 seconds</div><div class="sasNote">      system cpu time     0.16 seconds</div><div class="sasNote">      memory              10815.90k</div><div class="sasNote">      OS Memory           44164.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:08:49 PM</div><div class="sasNote">      Step Count                        75  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     2914</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        3398</div><div class="sasNote">      Involuntary Context Switches      100</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           146696</div><div class="sasNote">      </div><div class="sasSource">1480  </div><div class="sasSource">1481  /* Считаем стандартное отклонение */</div><div class="sasSource">1482  %macro cmpcode2;</div><div class="sasSource">1483  proc cas;</div><div class="sasSource">1484  timeData.runTimeCode result=r /</div><div class="sasSource">1485  table = {</div><div class="sasSource">1486  name ='abt4_ml',</div><div class="sasSource">1487  caslib = 'public',</div><div class="sasSource">1488          groupBy = {</div><div class="sasSource">1489  {name = 'PRODUCT_ID'},</div><div class="sasSource">1490  {name = 'PBO_LOCATION_ID'},</div><div class="sasSource">1491  {name = 'CHANNEL_CD'}</div><div class="sasSource">1492  }</div><div class="sasSource">1493  },</div><div class="sasSource">1494   series = {{name='sum_qty'}},</div><div class="sasSource">1495   interval='DAY',</div><div class="sasSource">1496  timeId = {name='SALES_DT'},</div><div class="sasSource">1497  trimId = "LEFT",</div><div class="sasSource">1498  code=</div><div class="sasSource">1499  %unquote(%str(%"))</div><div class="sasSource">1500  %let names=; /*будущий список выходных переменных для proc cas */</div><div class="sasSource">1501  %let minlag=91; /*параметр MinLag*/</div><div class="sasSource">1502  /*-=-=-=-=-= min_lag + окна -=-=-=-=-=-*/</div><div class="sasSource">1503  %let window_list = 7 30 90 180 365;</div><div class="sasSource">1504  %let lag=&amp;minlag;</div><div class="sasSource">1505  %let n_win_list=%sysfunc(countw(&amp;window_list.));</div><div class="sasSource">1506  %do ic=1 %to &amp;n_win_list.;</div><div class="sasSource">1507    %let window=%scan(&amp;window_list,&amp;ic); /*текущее окно*/</div><div class="sasSource">1508    %let intnm=%namet(&amp;window);        /*название интервала окна; 7-&gt;week итд */</div><div class="sasSource">1509    %let intnm=%sysfunc(strip(&amp;intnm.));</div><div class="sasSource">1510    do t = %eval(&amp;lag+&amp;window) to _length_; /*from=(lag)+(window)*/</div><div class="sasSource">1511      lag_&amp;intnm._std[t]=std(%argt(sum_qty,t,%eval(&amp;lag),%eval(&amp;lag+&amp;window-1)));</div><div class="sasSource">1512    end;</div><div class="sasSource">1513   %let names={name=%tslit(lag_&amp;intnm._std)}, &amp;names;</div><div class="sasSource">1514  </div><div class="sasSource">1515  %end; /* ic over window_list*/</div><div class="sasSource">1516  /*remove last comma from names*/</div><div class="sasSource">1517  %let len=%length(&amp;names);</div><div class="sasSource">1518  %let names=%substr(%quote(&amp;names),1,%eval(&amp;len-1));</div><div class="sasSource">1519  /*-=-=-завершающий код proc cas=-=-=*/</div><div class="sasSource">1520  %unquote(%str(%"))</div><div class="sasSource">1521  ,</div><div class="sasSource">1522  arrayOut={</div><div class="sasSource">1523  table={name='lag_abt2', replace=true, caslib='Public'},</div><div class="sasSource">1524      arrays={&amp;names}</div><div class="sasSource">1525  }</div><div class="sasSource">1526  ;</div><div class="sasSource">1527  run;</div><div class="sasSource">1528  quit;</div><div class="sasSource">1529  %mend cmpcode2;</div><div class="sasNote" id="sasLogNote258_1594283467627">NOTE: The macro CMPCODE2 completed compilation without errors.</div><div class="sasNote">      63 instructions 1936 bytes.</div><div class="sasSource">1530  </div><div class="sasSource">1531  %cmpcode2</div><div class="sasSource">MPRINT(CMPCODE2):   proc cas;</div><div class="sasSource">MPRINT(CMPCODE2):   timeData.runTimeCode result=r / table = { name ='abt4_ml', caslib = 'public', groupBy = { {name = </div><div class="sasSource">'PRODUCT_ID'}, {name = 'PBO_LOCATION_ID'}, {name = 'CHANNEL_CD'} } }, series = {{name='sum_qty'}}, interval='DAY', timeId = </div><div class="sasSource">{name='SALES_DT'}, trimId = "LEFT", code=</div><div class="sasNote" id="sasLogNote259_1594283467627">NOTE: The quoted string currently being processed has become more than 262 bytes long.  You might have unbalanced quotation marks.</div><div class="sasSource">MPRINT(CMPCODE2):   "     do t = 98 to _length_;        lag_week_std[t]=std(sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   , </div><div class="sasSource"> sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]);     end;     do t = 121 to _length_;        </div><div class="sasSource">lag_month_std[t]=std(sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   </div><div class="sasSource">,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  </div><div class="sasSource">sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  </div><div class="sasSource">sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  </div><div class="sasSource">sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]);     end;     </div><div class="sasSource">do t = 181 to _length_;        lag_qtr_std[t]=std(sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  </div><div class="sasSource">sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   </div><div class="sasSource">,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  </div><div class="sasSource">sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  </div><div class="sasSource">sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  </div><div class="sasSource">sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  </div><div class="sasSource">sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  </div><div class="sasSource">sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  </div><div class="sasSource">sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  </div><div class="sasSource">sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  </div><div class="sasSource">sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  </div><div class="sasSource">sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  </div><div class="sasSource">sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  </div><div class="sasSource">sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  </div><div class="sasSource">sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  </div><div class="sasSource">sum_qty[t-180]);     end;     do t = 271 to _length_;        lag_halfyear_std[t]=std(sum_qty[t-91]   ,  sum_qty[t-92]   ,  </div><div class="sasSource">sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   , </div><div class="sasSource"> sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  </div><div class="sasSource">sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  </div><div class="sasSource">sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  </div><div class="sasSource">sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  </div><div class="sasSource">sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  </div><div class="sasSource">sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  </div><div class="sasSource">sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  </div><div class="sasSource">sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  </div><div class="sasSource">sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  </div><div class="sasSource">sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  </div><div class="sasSource">sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  </div><div class="sasSource">sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  </div><div class="sasSource">sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  </div><div class="sasSource">sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  </div><div class="sasSource">sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  </div><div class="sasSource">sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  </div><div class="sasSource">sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  </div><div class="sasSource">sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  </div><div class="sasSource">sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  </div><div class="sasSource">sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  </div><div class="sasSource">sum_qty[t-220]   ,  sum_qty[t-221]   ,  sum_qty[t-222]   ,  sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  </div><div class="sasSource">sum_qty[t-226]   ,  sum_qty[t-227]   ,  sum_qty[t-228]   ,  sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  </div><div class="sasSource">sum_qty[t-232]   ,  sum_qty[t-233]   ,  sum_qty[t-234]   ,  sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  </div><div class="sasSource">sum_qty[t-238]   ,  sum_qty[t-239]   ,  sum_qty[t-240]   ,  sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  </div><div class="sasSource">sum_qty[t-244]   ,  sum_qty[t-245]   ,  sum_qty[t-246]   ,  sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  </div><div class="sasSource">sum_qty[t-250]   ,  sum_qty[t-251]   ,  sum_qty[t-252]   ,  sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  </div><div class="sasSource">sum_qty[t-256]   ,  sum_qty[t-257]   ,  sum_qty[t-258]   ,  sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  </div><div class="sasSource">sum_qty[t-262]   ,  sum_qty[t-263]   ,  sum_qty[t-264]   ,  sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  </div><div class="sasSource">sum_qty[t-268]   ,  sum_qty[t-269]   ,  sum_qty[t-270]);     end;     do t = 456 to _length_;        </div><div class="sasSource">lag_year_std[t]=std(sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   </div><div class="sasSource">,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  </div><div class="sasSource">sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  </div><div class="sasSource">sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  </div><div class="sasSource">sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  </div><div class="sasSource">sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  </div><div class="sasSource">sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  </div><div class="sasSource">sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  </div><div class="sasSource">sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  </div><div class="sasSource">sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  </div><div class="sasSource">sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  </div><div class="sasSource">sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  </div><div class="sasSource">sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  </div><div class="sasSource">sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  </div><div class="sasSource">sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  </div><div class="sasSource">sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  </div><div class="sasSource">sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  </div><div class="sasSource">sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  </div><div class="sasSource">sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  </div><div class="sasSource">sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  </div><div class="sasSource">sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  </div><div class="sasSource">sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]   ,  sum_qty[t-222]   ,  </div><div class="sasSource">sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  sum_qty[t-226]   ,  sum_qty[t-227]   ,  sum_qty[t-228]   ,  </div><div class="sasSource">sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  sum_qty[t-232]   ,  sum_qty[t-233]   ,  sum_qty[t-234]   ,  </div><div class="sasSource">sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  sum_qty[t-238]   ,  sum_qty[t-239]   ,  sum_qty[t-240]   ,  </div><div class="sasSource">sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  sum_qty[t-244]   ,  sum_qty[t-245]   ,  sum_qty[t-246]   ,  </div><div class="sasSource">sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  sum_qty[t-250]   ,  sum_qty[t-251]   ,  sum_qty[t-252]   ,  </div><div class="sasSource">sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  sum_qty[t-256]   ,  sum_qty[t-257]   ,  sum_qty[t-258]   ,  </div><div class="sasSource">sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  sum_qty[t-262]   ,  sum_qty[t-263]   ,  sum_qty[t-264]   ,  </div><div class="sasSource">sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  sum_qty[t-268]   ,  sum_qty[t-269]   ,  sum_qty[t-270]   ,  </div><div class="sasSource">sum_qty[t-271]   ,  sum_qty[t-272]   ,  sum_qty[t-273]   ,  sum_qty[t-274]   ,  sum_qty[t-275]   ,  sum_qty[t-276]   ,  </div><div class="sasSource">sum_qty[t-277]   ,  sum_qty[t-278]   ,  sum_qty[t-279]   ,  sum_qty[t-280]   ,  sum_qty[t-281]   ,  sum_qty[t-282]   ,  </div><div class="sasSource">sum_qty[t-283]   ,  sum_qty[t-284]   ,  sum_qty[t-285]   ,  sum_qty[t-286]   ,  sum_qty[t-287]   ,  sum_qty[t-288]   ,  </div><div class="sasSource">sum_qty[t-289]   ,  sum_qty[t-290]   ,  sum_qty[t-291]   ,  sum_qty[t-292]   ,  sum_qty[t-293]   ,  sum_qty[t-294]   ,  </div><div class="sasSource">sum_qty[t-295]   ,  sum_qty[t-296]   ,  sum_qty[t-297]   ,  sum_qty[t-298]   ,  sum_qty[t-299]   ,  sum_qty[t-300]   ,  </div><div class="sasSource">sum_qty[t-301]   ,  sum_qty[t-302]   ,  sum_qty[t-303]   ,  sum_qty[t-304]   ,  sum_qty[t-305]   ,  sum_qty[t-306]   ,  </div><div class="sasSource">sum_qty[t-307]   ,  sum_qty[t-308]   ,  sum_qty[t-309]   ,  sum_qty[t-310]   ,  sum_qty[t-311]   ,  sum_qty[t-312]   ,  </div><div class="sasSource">sum_qty[t-313]   ,  sum_qty[t-314]   ,  sum_qty[t-315]   ,  sum_qty[t-316]   ,  sum_qty[t-317]   ,  sum_qty[t-318]   ,  </div><div class="sasSource">sum_qty[t-319]   ,  sum_qty[t-320]   ,  sum_qty[t-321]   ,  sum_qty[t-322]   ,  sum_qty[t-323]   ,  sum_qty[t-324]   ,  </div><div class="sasSource">sum_qty[t-325]   ,  sum_qty[t-326]   ,  sum_qty[t-327]   ,  sum_qty[t-328]   ,  sum_qty[t-329]   ,  sum_qty[t-330]   ,  </div><div class="sasSource">sum_qty[t-331]   ,  sum_qty[t-332]   ,  sum_qty[t-333]   ,  sum_qty[t-334]   ,  sum_qty[t-335]   ,  sum_qty[t-336]   ,  </div><div class="sasSource">sum_qty[t-337]   ,  sum_qty[t-338]   ,  sum_qty[t-339]   ,  sum_qty[t-340]   ,  sum_qty[t-341]   ,  sum_qty[t-342]   ,  </div><div class="sasSource">sum_qty[t-343]   ,  sum_qty[t-344]   ,  sum_qty[t-345]   ,  sum_qty[t-346]   ,  sum_qty[t-347]   ,  sum_qty[t-348]   ,  </div><div class="sasSource">sum_qty[t-349]   ,  sum_qty[t-350]   ,  sum_qty[t-351]   ,  sum_qty[t-352]   ,  sum_qty[t-353]   ,  sum_qty[t-354]   ,  </div><div class="sasSource">sum_qty[t-355]   ,  sum_qty[t-356]   ,  sum_qty[t-357]   ,  sum_qty[t-358]   ,  sum_qty[t-359]   ,  sum_qty[t-360]   ,  </div><div class="sasSource">sum_qty[t-361]   ,  sum_qty[t-362]   ,  sum_qty[t-363]   ,  sum_qty[t-364]   ,  sum_qty[t-365]   ,  sum_qty[t-366]   ,  </div><div class="sasSource">sum_qty[t-367]   ,  sum_qty[t-368]   ,  sum_qty[t-369]   ,  sum_qty[t-370]   ,  sum_qty[t-371]   ,  sum_qty[t-372]   ,  </div><div class="sasSource">sum_qty[t-373]   ,  sum_qty[t-374]   ,  sum_qty[t-375]   ,  sum_qty[t-376]   ,  sum_qty[t-377]   ,  sum_qty[t-378]   ,  </div><div class="sasSource">sum_qty[t-379]   ,  sum_qty[t-380]   ,  sum_qty[t-381]   ,  sum_qty[t-382]   ,  sum_qty[t-383]   ,  sum_qty[t-384]   ,  </div><div class="sasSource">sum_qty[t-385]   ,  sum_qty[t-386]   ,  sum_qty[t-387]   ,  sum_qty[t-388]   ,  sum_qty[t-389]   ,  sum_qty[t-390]   ,  </div><div class="sasSource">sum_qty[t-391]   ,  sum_qty[t-392]   ,  sum_qty[t-393]   ,  sum_qty[t-394]   ,  sum_qty[t-395]   ,  sum_qty[t-396]   ,  </div><div class="sasSource">sum_qty[t-397]   ,  sum_qty[t-398]   ,  sum_qty[t-399]   ,  sum_qty[t-400]   ,  sum_qty[t-401]   ,  sum_qty[t-402]   ,  </div><div class="sasSource">sum_qty[t-403]   ,  sum_qty[t-404]   ,  sum_qty[t-405]   ,  sum_qty[t-406]   ,  sum_qty[t-407]   ,  sum_qty[t-408]   ,  </div><div class="sasSource">sum_qty[t-409]   ,  sum_qty[t-410]   ,  sum_qty[t-411]   ,  sum_qty[t-412]   ,  sum_qty[t-413]   ,  sum_qty[t-414]   ,  </div><div class="sasSource">sum_qty[t-415]   ,  sum_qty[t-416]   ,  sum_qty[t-417]   ,  sum_qty[t-418]   ,  sum_qty[t-419]   ,  sum_qty[t-420]   ,  </div><div class="sasSource">sum_qty[t-421]   ,  sum_qty[t-422]   ,  sum_qty[t-423]   ,  sum_qty[t-424]   ,  sum_qty[t-425]   ,  sum_qty[t-426]   ,  </div><div class="sasSource">sum_qty[t-427]   ,  sum_qty[t-428]   ,  sum_qty[t-429]   ,  sum_qty[t-430]   ,  sum_qty[t-431]   ,  sum_qty[t-432]   ,  </div><div class="sasSource">sum_qty[t-433]   ,  sum_qty[t-434]   ,  sum_qty[t-435]   ,  sum_qty[t-436]   ,  sum_qty[t-437]   ,  sum_qty[t-438]   ,  </div><div class="sasSource">sum_qty[t-439]   ,  sum_qty[t-440]   ,  sum_qty[t-441]   ,  sum_qty[t-442]   ,  sum_qty[t-443]   ,  sum_qty[t-444]   ,  </div><div class="sasSource">sum_qty[t-445]   ,  sum_qty[t-446]   ,  sum_qty[t-447]   ,  sum_qty[t-448]   ,  sum_qty[t-449]   ,  sum_qty[t-450]   ,  </div><div class="sasSource">sum_qty[t-451]   ,  sum_qty[t-452]   ,  sum_qty[t-453]   ,  sum_qty[t-454]   ,  sum_qty[t-455]);     end;      " , arrayOut={ </div><div class="sasSource">table={name='lag_abt2', replace=true, caslib='Public'}, arrays={{name='lag_year_std'}, {name='lag_halfyear_std'}, </div><div class="sasSource">{name='lag_qtr_std'}, {name='lag_month_std'}, {name='lag_week_std'}} } ;</div><div class="sasSource">MPRINT(CMPCODE2):   run;</div><div class="sasNote" id="sasLogNote260_1594283467627">NOTE: Active Session now CASAUTO.</div><div class="sasSource">MPRINT(CMPCODE2):   quit;</div><div class="sasNote" id="sasLogNote261_1594283467627">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           7:49.51</div><div class="sasNote">      user cpu time       0.54 seconds</div><div class="sasNote">      system cpu time     0.10 seconds</div><div class="sasNote">      memory              10355.03k</div><div class="sasNote">      OS Memory           43916.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:16:39 PM</div><div class="sasNote">      Step Count                        76  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1494</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        2455</div><div class="sasNote">      Involuntary Context Switches      19</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           37536</div><div class="sasNote">      </div><div class="sasSource">1532  </div><div class="sasSource">1533  /* Считаем процентили */</div><div class="sasSource">1534  %macro cmpcode3;</div><div class="sasSource">1535  proc cas;</div><div class="sasSource">1536  timeData.runTimeCode result=r /</div><div class="sasSource">1537  table = {</div><div class="sasSource">1538  name ='abt4_ml',</div><div class="sasSource">1539  caslib = 'public',</div><div class="sasSource">1540          groupBy = {</div><div class="sasSource">1541  {name = 'PRODUCT_ID'},</div><div class="sasSource">1542  {name = 'PBO_LOCATION_ID'},</div><div class="sasSource">1543  {name = 'CHANNEL_CD'}</div><div class="sasSource">1544  }</div><div class="sasSource">1545  },</div><div class="sasSource">1546   series = {{name='sum_qty'}},</div><div class="sasSource">1547   interval='DAY',</div><div class="sasSource">1548  timeId = {name='SALES_DT'},</div><div class="sasSource">1549  trimId = "LEFT",</div><div class="sasSource">1550  code=</div><div class="sasSource">1551  %unquote(%str(%"))</div><div class="sasSource">1552  %let names=; /*будущий список выходных переменных для proc cas */</div><div class="sasSource">1553  %let minlag=91; /*параметр MinLag*/</div><div class="sasSource">1554  /*-=-=-=-=-= min_lag + окна -=-=-=-=-=-*/</div><div class="sasSource">1555  %let window_list = 7 30 90 180 365;</div><div class="sasSource">1556  %let lag=&amp;minlag;</div><div class="sasSource">1557  %let n_win_list=%sysfunc(countw(&amp;window_list.));</div><div class="sasSource">1558  %do ic=1 %to &amp;n_win_list.;</div><div class="sasSource">1559    %let window=%scan(&amp;window_list,&amp;ic); /*текущее окно*/</div><div class="sasSource">1560    %let intnm=%namet(&amp;window);        /*название интервала окна; 7-&gt;week итд */</div><div class="sasSource">1561    %let intnm=%sysfunc(strip(&amp;intnm.));</div><div class="sasSource">1562    do t = %eval(&amp;lag+&amp;window) to _length_; /*from=(lag)+(window)*/</div><div class="sasSource">1563  lag_&amp;intnm._pct10[t]=pctl(10,%argt(sum_qty,t,%eval(&amp;lag),%eval(&amp;lag+&amp;window-1))) ;</div><div class="sasSource">1564     lag_&amp;intnm._pct90[t]=pctl(90,%argt(sum_qty,t,%eval(&amp;lag),%eval(&amp;lag+&amp;window-1))) ;</div><div class="sasSource">1565    end;</div><div class="sasSource">1566   %let names={name=%tslit(lag_&amp;intnm._pct10)}, &amp;names;</div><div class="sasSource">1567   %let names={name=%tslit(lag_&amp;intnm._pct90)}, &amp;names;</div><div class="sasSource">1568  </div><div class="sasSource">1569  %end; /* ic over window_list*/</div><div class="sasSource">1570  /*remove last comma from names*/</div><div class="sasSource">1571  %let len=%length(&amp;names);</div><div class="sasSource">1572  %let names=%substr(%quote(&amp;names),1,%eval(&amp;len-1));</div><div class="sasSource">1573  /*-=-=-завершающий код proc cas=-=-=*/</div><div class="sasSource">1574  %unquote(%str(%"))</div><div class="sasSource">1575  ,</div><div class="sasSource">1576  arrayOut={</div><div class="sasSource">1577  table={name='lag_abt3', replace=true, caslib='Public'},</div><div class="sasSource">1578      arrays={&amp;names}</div><div class="sasSource">1579  }</div><div class="sasSource">1580  ;</div><div class="sasSource">1581  run;</div><div class="sasSource">1582  quit;</div><div class="sasSource">1583  %mend cmpcode3;</div><div class="sasNote" id="sasLogNote262_1594283467627">NOTE: The macro CMPCODE3 completed compilation without errors.</div><div class="sasNote">      67 instructions 2144 bytes.</div><div class="sasSource">1584  %cmpcode3</div><div class="sasSource">MPRINT(CMPCODE3):   proc cas;</div><div class="sasSource">MPRINT(CMPCODE3):   timeData.runTimeCode result=r / table = { name ='abt4_ml', caslib = 'public', groupBy = { {name = </div><div class="sasSource">'PRODUCT_ID'}, {name = 'PBO_LOCATION_ID'}, {name = 'CHANNEL_CD'} } }, series = {{name='sum_qty'}}, interval='DAY', timeId = </div><div class="sasSource">{name='SALES_DT'}, trimId = "LEFT", code=</div><div class="sasNote" id="sasLogNote263_1594283467627">NOTE: The quoted string currently being processed has become more than 262 bytes long.  You might have unbalanced quotation marks.</div><div class="sasSource">MPRINT(CMPCODE3):   "     do t = 98 to _length_;     lag_week_pct10[t]=pctl(10,sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]  </div><div class="sasSource"> ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]) ;       lag_week_pct90[t]=pctl(90,sum_qty[t-91]   ,  </div><div class="sasSource">sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]) ;     end;     do t = </div><div class="sasSource">121 to _length_;     lag_month_pct10[t]=pctl(10,sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  </div><div class="sasSource">sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   </div><div class="sasSource">,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  </div><div class="sasSource">sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  </div><div class="sasSource">sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  </div><div class="sasSource">sum_qty[t-120]) ;       lag_month_pct90[t]=pctl(90,sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  </div><div class="sasSource">sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   </div><div class="sasSource">,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  </div><div class="sasSource">sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  </div><div class="sasSource">sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  </div><div class="sasSource">sum_qty[t-120]) ;     end;     do t = 181 to _length_;     lag_qtr_pct10[t]=pctl(10,sum_qty[t-91]   ,  sum_qty[t-92]   ,  </div><div class="sasSource">sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   , </div><div class="sasSource"> sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  </div><div class="sasSource">sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  </div><div class="sasSource">sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  </div><div class="sasSource">sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  </div><div class="sasSource">sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  </div><div class="sasSource">sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  </div><div class="sasSource">sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  </div><div class="sasSource">sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  </div><div class="sasSource">sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  </div><div class="sasSource">sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  </div><div class="sasSource">sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  </div><div class="sasSource">sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  </div><div class="sasSource">sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  </div><div class="sasSource">sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]) ;       lag_qtr_pct90[t]=pctl(90,sum_qty[t-91]   ,  sum_qty[t-92]   ,  </div><div class="sasSource">sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   , </div><div class="sasSource"> sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  </div><div class="sasSource">sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  </div><div class="sasSource">sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  </div><div class="sasSource">sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  </div><div class="sasSource">sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  </div><div class="sasSource">sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  </div><div class="sasSource">sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  </div><div class="sasSource">sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  </div><div class="sasSource">sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  </div><div class="sasSource">sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  </div><div class="sasSource">sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  </div><div class="sasSource">sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  </div><div class="sasSource">sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  </div><div class="sasSource">sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]) ;     end;     do t = 271 to _length_;     </div><div class="sasSource">lag_halfyear_pct10[t]=pctl(10,sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  </div><div class="sasSource">sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]  </div><div class="sasSource"> ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  </div><div class="sasSource">sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  </div><div class="sasSource">sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  </div><div class="sasSource">sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  </div><div class="sasSource">sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  </div><div class="sasSource">sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  </div><div class="sasSource">sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  </div><div class="sasSource">sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  </div><div class="sasSource">sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  </div><div class="sasSource">sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  </div><div class="sasSource">sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  </div><div class="sasSource">sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  </div><div class="sasSource">sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  </div><div class="sasSource">sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  </div><div class="sasSource">sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  </div><div class="sasSource">sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  </div><div class="sasSource">sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  </div><div class="sasSource">sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  </div><div class="sasSource">sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  </div><div class="sasSource">sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]   ,  sum_qty[t-222]   ,  </div><div class="sasSource">sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  sum_qty[t-226]   ,  sum_qty[t-227]   ,  sum_qty[t-228]   ,  </div><div class="sasSource">sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  sum_qty[t-232]   ,  sum_qty[t-233]   ,  sum_qty[t-234]   ,  </div><div class="sasSource">sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  sum_qty[t-238]   ,  sum_qty[t-239]   ,  sum_qty[t-240]   ,  </div><div class="sasSource">sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  sum_qty[t-244]   ,  sum_qty[t-245]   ,  sum_qty[t-246]   ,  </div><div class="sasSource">sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  sum_qty[t-250]   ,  sum_qty[t-251]   ,  sum_qty[t-252]   ,  </div><div class="sasSource">sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  sum_qty[t-256]   ,  sum_qty[t-257]   ,  sum_qty[t-258]   ,  </div><div class="sasSource">sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  sum_qty[t-262]   ,  sum_qty[t-263]   ,  sum_qty[t-264]   ,  </div><div class="sasSource">sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  sum_qty[t-268]   ,  sum_qty[t-269]   ,  sum_qty[t-270]) ;       </div><div class="sasSource">lag_halfyear_pct90[t]=pctl(90,sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  </div><div class="sasSource">sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]  </div><div class="sasSource"> ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  </div><div class="sasSource">sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  </div><div class="sasSource">sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  </div><div class="sasSource">sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  </div><div class="sasSource">sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  </div><div class="sasSource">sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  </div><div class="sasSource">sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  </div><div class="sasSource">sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  </div><div class="sasSource">sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  </div><div class="sasSource">sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  </div><div class="sasSource">sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  </div><div class="sasSource">sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  </div><div class="sasSource">sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  </div><div class="sasSource">sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  </div><div class="sasSource">sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  </div><div class="sasSource">sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  </div><div class="sasSource">sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  </div><div class="sasSource">sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  </div><div class="sasSource">sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  </div><div class="sasSource">sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]   ,  sum_qty[t-222]   ,  </div><div class="sasSource">sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  sum_qty[t-226]   ,  sum_qty[t-227]   ,  sum_qty[t-228]   ,  </div><div class="sasSource">sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  sum_qty[t-232]   ,  sum_qty[t-233]   ,  sum_qty[t-234]   ,  </div><div class="sasSource">sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  sum_qty[t-238]   ,  sum_qty[t-239]   ,  sum_qty[t-240]   ,  </div><div class="sasSource">sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  sum_qty[t-244]   ,  sum_qty[t-245]   ,  sum_qty[t-246]   ,  </div><div class="sasSource">sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  sum_qty[t-250]   ,  sum_qty[t-251]   ,  sum_qty[t-252]   ,  </div><div class="sasSource">sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  sum_qty[t-256]   ,  sum_qty[t-257]   ,  sum_qty[t-258]   ,  </div><div class="sasSource">sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  sum_qty[t-262]   ,  sum_qty[t-263]   ,  sum_qty[t-264]   ,  </div><div class="sasSource">sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  sum_qty[t-268]   ,  sum_qty[t-269]   ,  sum_qty[t-270]) ;     end;     </div><div class="sasSource">do t = 456 to _length_;     lag_year_pct10[t]=pctl(10,sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  </div><div class="sasSource">sum_qty[t-95]   ,  sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   </div><div class="sasSource">,  sum_qty[t-102]   ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  </div><div class="sasSource">sum_qty[t-108]   ,  sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  </div><div class="sasSource">sum_qty[t-114]   ,  sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  </div><div class="sasSource">sum_qty[t-120]   ,  sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  </div><div class="sasSource">sum_qty[t-126]   ,  sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  </div><div class="sasSource">sum_qty[t-132]   ,  sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  </div><div class="sasSource">sum_qty[t-138]   ,  sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  </div><div class="sasSource">sum_qty[t-144]   ,  sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  </div><div class="sasSource">sum_qty[t-150]   ,  sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  </div><div class="sasSource">sum_qty[t-156]   ,  sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  </div><div class="sasSource">sum_qty[t-162]   ,  sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  </div><div class="sasSource">sum_qty[t-168]   ,  sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  </div><div class="sasSource">sum_qty[t-174]   ,  sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  </div><div class="sasSource">sum_qty[t-180]   ,  sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  </div><div class="sasSource">sum_qty[t-186]   ,  sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  </div><div class="sasSource">sum_qty[t-192]   ,  sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  </div><div class="sasSource">sum_qty[t-198]   ,  sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  </div><div class="sasSource">sum_qty[t-204]   ,  sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  </div><div class="sasSource">sum_qty[t-210]   ,  sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  </div><div class="sasSource">sum_qty[t-216]   ,  sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]   ,  </div><div class="sasSource">sum_qty[t-222]   ,  sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  sum_qty[t-226]   ,  sum_qty[t-227]   ,  </div><div class="sasSource">sum_qty[t-228]   ,  sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  sum_qty[t-232]   ,  sum_qty[t-233]   ,  </div><div class="sasSource">sum_qty[t-234]   ,  sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  sum_qty[t-238]   ,  sum_qty[t-239]   ,  </div><div class="sasSource">sum_qty[t-240]   ,  sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  sum_qty[t-244]   ,  sum_qty[t-245]   ,  </div><div class="sasSource">sum_qty[t-246]   ,  sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  sum_qty[t-250]   ,  sum_qty[t-251]   ,  </div><div class="sasSource">sum_qty[t-252]   ,  sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  sum_qty[t-256]   ,  sum_qty[t-257]   ,  </div><div class="sasSource">sum_qty[t-258]   ,  sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  sum_qty[t-262]   ,  sum_qty[t-263]   ,  </div><div class="sasSource">sum_qty[t-264]   ,  sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  sum_qty[t-268]   ,  sum_qty[t-269]   ,  </div><div class="sasSource">sum_qty[t-270]   ,  sum_qty[t-271]   ,  sum_qty[t-272]   ,  sum_qty[t-273]   ,  sum_qty[t-274]   ,  sum_qty[t-275]   ,  </div><div class="sasSource">sum_qty[t-276]   ,  sum_qty[t-277]   ,  sum_qty[t-278]   ,  sum_qty[t-279]   ,  sum_qty[t-280]   ,  sum_qty[t-281]   ,  </div><div class="sasSource">sum_qty[t-282]   ,  sum_qty[t-283]   ,  sum_qty[t-284]   ,  sum_qty[t-285]   ,  sum_qty[t-286]   ,  sum_qty[t-287]   ,  </div><div class="sasSource">sum_qty[t-288]   ,  sum_qty[t-289]   ,  sum_qty[t-290]   ,  sum_qty[t-291]   ,  sum_qty[t-292]   ,  sum_qty[t-293]   ,  </div><div class="sasSource">sum_qty[t-294]   ,  sum_qty[t-295]   ,  sum_qty[t-296]   ,  sum_qty[t-297]   ,  sum_qty[t-298]   ,  sum_qty[t-299]   ,  </div><div class="sasSource">sum_qty[t-300]   ,  sum_qty[t-301]   ,  sum_qty[t-302]   ,  sum_qty[t-303]   ,  sum_qty[t-304]   ,  sum_qty[t-305]   ,  </div><div class="sasSource">sum_qty[t-306]   ,  sum_qty[t-307]   ,  sum_qty[t-308]   ,  sum_qty[t-309]   ,  sum_qty[t-310]   ,  sum_qty[t-311]   ,  </div><div class="sasSource">sum_qty[t-312]   ,  sum_qty[t-313]   ,  sum_qty[t-314]   ,  sum_qty[t-315]   ,  sum_qty[t-316]   ,  sum_qty[t-317]   ,  </div><div class="sasSource">sum_qty[t-318]   ,  sum_qty[t-319]   ,  sum_qty[t-320]   ,  sum_qty[t-321]   ,  sum_qty[t-322]   ,  sum_qty[t-323]   ,  </div><div class="sasSource">sum_qty[t-324]   ,  sum_qty[t-325]   ,  sum_qty[t-326]   ,  sum_qty[t-327]   ,  sum_qty[t-328]   ,  sum_qty[t-329]   ,  </div><div class="sasSource">sum_qty[t-330]   ,  sum_qty[t-331]   ,  sum_qty[t-332]   ,  sum_qty[t-333]   ,  sum_qty[t-334]   ,  sum_qty[t-335]   ,  </div><div class="sasSource">sum_qty[t-336]   ,  sum_qty[t-337]   ,  sum_qty[t-338]   ,  sum_qty[t-339]   ,  sum_qty[t-340]   ,  sum_qty[t-341]   ,  </div><div class="sasSource">sum_qty[t-342]   ,  sum_qty[t-343]   ,  sum_qty[t-344]   ,  sum_qty[t-345]   ,  sum_qty[t-346]   ,  sum_qty[t-347]   ,  </div><div class="sasSource">sum_qty[t-348]   ,  sum_qty[t-349]   ,  sum_qty[t-350]   ,  sum_qty[t-351]   ,  sum_qty[t-352]   ,  sum_qty[t-353]   ,  </div><div class="sasSource">sum_qty[t-354]   ,  sum_qty[t-355]   ,  sum_qty[t-356]   ,  sum_qty[t-357]   ,  sum_qty[t-358]   ,  sum_qty[t-359]   ,  </div><div class="sasSource">sum_qty[t-360]   ,  sum_qty[t-361]   ,  sum_qty[t-362]   ,  sum_qty[t-363]   ,  sum_qty[t-364]   ,  sum_qty[t-365]   ,  </div><div class="sasSource">sum_qty[t-366]   ,  sum_qty[t-367]   ,  sum_qty[t-368]   ,  sum_qty[t-369]   ,  sum_qty[t-370]   ,  sum_qty[t-371]   ,  </div><div class="sasSource">sum_qty[t-372]   ,  sum_qty[t-373]   ,  sum_qty[t-374]   ,  sum_qty[t-375]   ,  sum_qty[t-376]   ,  sum_qty[t-377]   ,  </div><div class="sasSource">sum_qty[t-378]   ,  sum_qty[t-379]   ,  sum_qty[t-380]   ,  sum_qty[t-381]   ,  sum_qty[t-382]   ,  sum_qty[t-383]   ,  </div><div class="sasSource">sum_qty[t-384]   ,  sum_qty[t-385]   ,  sum_qty[t-386]   ,  sum_qty[t-387]   ,  sum_qty[t-388]   ,  sum_qty[t-389]   ,  </div><div class="sasSource">sum_qty[t-390]   ,  sum_qty[t-391]   ,  sum_qty[t-392]   ,  sum_qty[t-393]   ,  sum_qty[t-394]   ,  sum_qty[t-395]   ,  </div><div class="sasSource">sum_qty[t-396]   ,  sum_qty[t-397]   ,  sum_qty[t-398]   ,  sum_qty[t-399]   ,  sum_qty[t-400]   ,  sum_qty[t-401]   ,  </div><div class="sasSource">sum_qty[t-402]   ,  sum_qty[t-403]   ,  sum_qty[t-404]   ,  sum_qty[t-405]   ,  sum_qty[t-406]   ,  sum_qty[t-407]   ,  </div><div class="sasSource">sum_qty[t-408]   ,  sum_qty[t-409]   ,  sum_qty[t-410]   ,  sum_qty[t-411]   ,  sum_qty[t-412]   ,  sum_qty[t-413]   ,  </div><div class="sasSource">sum_qty[t-414]   ,  sum_qty[t-415]   ,  sum_qty[t-416]   ,  sum_qty[t-417]   ,  sum_qty[t-418]   ,  sum_qty[t-419]   ,  </div><div class="sasSource">sum_qty[t-420]   ,  sum_qty[t-421]   ,  sum_qty[t-422]   ,  sum_qty[t-423]   ,  sum_qty[t-424]   ,  sum_qty[t-425]   ,  </div><div class="sasSource">sum_qty[t-426]   ,  sum_qty[t-427]   ,  sum_qty[t-428]   ,  sum_qty[t-429]   ,  sum_qty[t-430]   ,  sum_qty[t-431]   ,  </div><div class="sasSource">sum_qty[t-432]   ,  sum_qty[t-433]   ,  sum_qty[t-434]   ,  sum_qty[t-435]   ,  sum_qty[t-436]   ,  sum_qty[t-437]   ,  </div><div class="sasSource">sum_qty[t-438]   ,  sum_qty[t-439]   ,  sum_qty[t-440]   ,  sum_qty[t-441]   ,  sum_qty[t-442]   ,  sum_qty[t-443]   ,  </div><div class="sasSource">sum_qty[t-444]   ,  sum_qty[t-445]   ,  sum_qty[t-446]   ,  sum_qty[t-447]   ,  sum_qty[t-448]   ,  sum_qty[t-449]   ,  </div><div class="sasSource">sum_qty[t-450]   ,  sum_qty[t-451]   ,  sum_qty[t-452]   ,  sum_qty[t-453]   ,  sum_qty[t-454]   ,  sum_qty[t-455]) ;       </div><div class="sasSource">lag_year_pct90[t]=pctl(90,sum_qty[t-91]   ,  sum_qty[t-92]   ,  sum_qty[t-93]   ,  sum_qty[t-94]   ,  sum_qty[t-95]   ,  </div><div class="sasSource">sum_qty[t-96]   ,  sum_qty[t-97]   ,  sum_qty[t-98]   ,  sum_qty[t-99]   ,  sum_qty[t-100]   ,  sum_qty[t-101]   ,  sum_qty[t-102]  </div><div class="sasSource"> ,  sum_qty[t-103]   ,  sum_qty[t-104]   ,  sum_qty[t-105]   ,  sum_qty[t-106]   ,  sum_qty[t-107]   ,  sum_qty[t-108]   ,  </div><div class="sasSource">sum_qty[t-109]   ,  sum_qty[t-110]   ,  sum_qty[t-111]   ,  sum_qty[t-112]   ,  sum_qty[t-113]   ,  sum_qty[t-114]   ,  </div><div class="sasSource">sum_qty[t-115]   ,  sum_qty[t-116]   ,  sum_qty[t-117]   ,  sum_qty[t-118]   ,  sum_qty[t-119]   ,  sum_qty[t-120]   ,  </div><div class="sasSource">sum_qty[t-121]   ,  sum_qty[t-122]   ,  sum_qty[t-123]   ,  sum_qty[t-124]   ,  sum_qty[t-125]   ,  sum_qty[t-126]   ,  </div><div class="sasSource">sum_qty[t-127]   ,  sum_qty[t-128]   ,  sum_qty[t-129]   ,  sum_qty[t-130]   ,  sum_qty[t-131]   ,  sum_qty[t-132]   ,  </div><div class="sasSource">sum_qty[t-133]   ,  sum_qty[t-134]   ,  sum_qty[t-135]   ,  sum_qty[t-136]   ,  sum_qty[t-137]   ,  sum_qty[t-138]   ,  </div><div class="sasSource">sum_qty[t-139]   ,  sum_qty[t-140]   ,  sum_qty[t-141]   ,  sum_qty[t-142]   ,  sum_qty[t-143]   ,  sum_qty[t-144]   ,  </div><div class="sasSource">sum_qty[t-145]   ,  sum_qty[t-146]   ,  sum_qty[t-147]   ,  sum_qty[t-148]   ,  sum_qty[t-149]   ,  sum_qty[t-150]   ,  </div><div class="sasSource">sum_qty[t-151]   ,  sum_qty[t-152]   ,  sum_qty[t-153]   ,  sum_qty[t-154]   ,  sum_qty[t-155]   ,  sum_qty[t-156]   ,  </div><div class="sasSource">sum_qty[t-157]   ,  sum_qty[t-158]   ,  sum_qty[t-159]   ,  sum_qty[t-160]   ,  sum_qty[t-161]   ,  sum_qty[t-162]   ,  </div><div class="sasSource">sum_qty[t-163]   ,  sum_qty[t-164]   ,  sum_qty[t-165]   ,  sum_qty[t-166]   ,  sum_qty[t-167]   ,  sum_qty[t-168]   ,  </div><div class="sasSource">sum_qty[t-169]   ,  sum_qty[t-170]   ,  sum_qty[t-171]   ,  sum_qty[t-172]   ,  sum_qty[t-173]   ,  sum_qty[t-174]   ,  </div><div class="sasSource">sum_qty[t-175]   ,  sum_qty[t-176]   ,  sum_qty[t-177]   ,  sum_qty[t-178]   ,  sum_qty[t-179]   ,  sum_qty[t-180]   ,  </div><div class="sasSource">sum_qty[t-181]   ,  sum_qty[t-182]   ,  sum_qty[t-183]   ,  sum_qty[t-184]   ,  sum_qty[t-185]   ,  sum_qty[t-186]   ,  </div><div class="sasSource">sum_qty[t-187]   ,  sum_qty[t-188]   ,  sum_qty[t-189]   ,  sum_qty[t-190]   ,  sum_qty[t-191]   ,  sum_qty[t-192]   ,  </div><div class="sasSource">sum_qty[t-193]   ,  sum_qty[t-194]   ,  sum_qty[t-195]   ,  sum_qty[t-196]   ,  sum_qty[t-197]   ,  sum_qty[t-198]   ,  </div><div class="sasSource">sum_qty[t-199]   ,  sum_qty[t-200]   ,  sum_qty[t-201]   ,  sum_qty[t-202]   ,  sum_qty[t-203]   ,  sum_qty[t-204]   ,  </div><div class="sasSource">sum_qty[t-205]   ,  sum_qty[t-206]   ,  sum_qty[t-207]   ,  sum_qty[t-208]   ,  sum_qty[t-209]   ,  sum_qty[t-210]   ,  </div><div class="sasSource">sum_qty[t-211]   ,  sum_qty[t-212]   ,  sum_qty[t-213]   ,  sum_qty[t-214]   ,  sum_qty[t-215]   ,  sum_qty[t-216]   ,  </div><div class="sasSource">sum_qty[t-217]   ,  sum_qty[t-218]   ,  sum_qty[t-219]   ,  sum_qty[t-220]   ,  sum_qty[t-221]   ,  sum_qty[t-222]   ,  </div><div class="sasSource">sum_qty[t-223]   ,  sum_qty[t-224]   ,  sum_qty[t-225]   ,  sum_qty[t-226]   ,  sum_qty[t-227]   ,  sum_qty[t-228]   ,  </div><div class="sasSource">sum_qty[t-229]   ,  sum_qty[t-230]   ,  sum_qty[t-231]   ,  sum_qty[t-232]   ,  sum_qty[t-233]   ,  sum_qty[t-234]   ,  </div><div class="sasSource">sum_qty[t-235]   ,  sum_qty[t-236]   ,  sum_qty[t-237]   ,  sum_qty[t-238]   ,  sum_qty[t-239]   ,  sum_qty[t-240]   ,  </div><div class="sasSource">sum_qty[t-241]   ,  sum_qty[t-242]   ,  sum_qty[t-243]   ,  sum_qty[t-244]   ,  sum_qty[t-245]   ,  sum_qty[t-246]   ,  </div><div class="sasSource">sum_qty[t-247]   ,  sum_qty[t-248]   ,  sum_qty[t-249]   ,  sum_qty[t-250]   ,  sum_qty[t-251]   ,  sum_qty[t-252]   ,  </div><div class="sasSource">sum_qty[t-253]   ,  sum_qty[t-254]   ,  sum_qty[t-255]   ,  sum_qty[t-256]   ,  sum_qty[t-257]   ,  sum_qty[t-258]   ,  </div><div class="sasSource">sum_qty[t-259]   ,  sum_qty[t-260]   ,  sum_qty[t-261]   ,  sum_qty[t-262]   ,  sum_qty[t-263]   ,  sum_qty[t-264]   ,  </div><div class="sasSource">sum_qty[t-265]   ,  sum_qty[t-266]   ,  sum_qty[t-267]   ,  sum_qty[t-268]   ,  sum_qty[t-269]   ,  sum_qty[t-270]   ,  </div><div class="sasSource">sum_qty[t-271]   ,  sum_qty[t-272]   ,  sum_qty[t-273]   ,  sum_qty[t-274]   ,  sum_qty[t-275]   ,  sum_qty[t-276]   ,  </div><div class="sasSource">sum_qty[t-277]   ,  sum_qty[t-278]   ,  sum_qty[t-279]   ,  sum_qty[t-280]   ,  sum_qty[t-281]   ,  sum_qty[t-282]   ,  </div><div class="sasSource">sum_qty[t-283]   ,  sum_qty[t-284]   ,  sum_qty[t-285]   ,  sum_qty[t-286]   ,  sum_qty[t-287]   ,  sum_qty[t-288]   ,  </div><div class="sasSource">sum_qty[t-289]   ,  sum_qty[t-290]   ,  sum_qty[t-291]   ,  sum_qty[t-292]   ,  sum_qty[t-293]   ,  sum_qty[t-294]   ,  </div><div class="sasSource">sum_qty[t-295]   ,  sum_qty[t-296]   ,  sum_qty[t-297]   ,  sum_qty[t-298]   ,  sum_qty[t-299]   ,  sum_qty[t-300]   ,  </div><div class="sasSource">sum_qty[t-301]   ,  sum_qty[t-302]   ,  sum_qty[t-303]   ,  sum_qty[t-304]   ,  sum_qty[t-305]   ,  sum_qty[t-306]   ,  </div><div class="sasSource">sum_qty[t-307]   ,  sum_qty[t-308]   ,  sum_qty[t-309]   ,  sum_qty[t-310]   ,  sum_qty[t-311]   ,  sum_qty[t-312]   ,  </div><div class="sasSource">sum_qty[t-313]   ,  sum_qty[t-314]   ,  sum_qty[t-315]   ,  sum_qty[t-316]   ,  sum_qty[t-317]   ,  sum_qty[t-318]   ,  </div><div class="sasSource">sum_qty[t-319]   ,  sum_qty[t-320]   ,  sum_qty[t-321]   ,  sum_qty[t-322]   ,  sum_qty[t-323]   ,  sum_qty[t-324]   ,  </div><div class="sasSource">sum_qty[t-325]   ,  sum_qty[t-326]   ,  sum_qty[t-327]   ,  sum_qty[t-328]   ,  sum_qty[t-329]   ,  sum_qty[t-330]   ,  </div><div class="sasSource">sum_qty[t-331]   ,  sum_qty[t-332]   ,  sum_qty[t-333]   ,  sum_qty[t-334]   ,  sum_qty[t-335]   ,  sum_qty[t-336]   ,  </div><div class="sasSource">sum_qty[t-337]   ,  sum_qty[t-338]   ,  sum_qty[t-339]   ,  sum_qty[t-340]   ,  sum_qty[t-341]   ,  sum_qty[t-342]   ,  </div><div class="sasSource">sum_qty[t-343]   ,  sum_qty[t-344]   ,  sum_qty[t-345]   ,  sum_qty[t-346]   ,  sum_qty[t-347]   ,  sum_qty[t-348]   ,  </div><div class="sasSource">sum_qty[t-349]   ,  sum_qty[t-350]   ,  sum_qty[t-351]   ,  sum_qty[t-352]   ,  sum_qty[t-353]   ,  sum_qty[t-354]   ,  </div><div class="sasSource">sum_qty[t-355]   ,  sum_qty[t-356]   ,  sum_qty[t-357]   ,  sum_qty[t-358]   ,  sum_qty[t-359]   ,  sum_qty[t-360]   ,  </div><div class="sasSource">sum_qty[t-361]   ,  sum_qty[t-362]   ,  sum_qty[t-363]   ,  sum_qty[t-364]   ,  sum_qty[t-365]   ,  sum_qty[t-366]   ,  </div><div class="sasSource">sum_qty[t-367]   ,  sum_qty[t-368]   ,  sum_qty[t-369]   ,  sum_qty[t-370]   ,  sum_qty[t-371]   ,  sum_qty[t-372]   ,  </div><div class="sasSource">sum_qty[t-373]   ,  sum_qty[t-374]   ,  sum_qty[t-375]   ,  sum_qty[t-376]   ,  sum_qty[t-377]   ,  sum_qty[t-378]   ,  </div><div class="sasSource">sum_qty[t-379]   ,  sum_qty[t-380]   ,  sum_qty[t-381]   ,  sum_qty[t-382]   ,  sum_qty[t-383]   ,  sum_qty[t-384]   ,  </div><div class="sasSource">sum_qty[t-385]   ,  sum_qty[t-386]   ,  sum_qty[t-387]   ,  sum_qty[t-388]   ,  sum_qty[t-389]   ,  sum_qty[t-390]   ,  </div><div class="sasSource">sum_qty[t-391]   ,  sum_qty[t-392]   ,  sum_qty[t-393]   ,  sum_qty[t-394]   ,  sum_qty[t-395]   ,  sum_qty[t-396]   ,  </div><div class="sasSource">sum_qty[t-397]   ,  sum_qty[t-398]   ,  sum_qty[t-399]   ,  sum_qty[t-400]   ,  sum_qty[t-401]   ,  sum_qty[t-402]   ,  </div><div class="sasSource">sum_qty[t-403]   ,  sum_qty[t-404]   ,  sum_qty[t-405]   ,  sum_qty[t-406]   ,  sum_qty[t-407]   ,  sum_qty[t-408]   ,  </div><div class="sasSource">sum_qty[t-409]   ,  sum_qty[t-410]   ,  sum_qty[t-411]   ,  sum_qty[t-412]   ,  sum_qty[t-413]   ,  sum_qty[t-414]   ,  </div><div class="sasSource">sum_qty[t-415]   ,  sum_qty[t-416]   ,  sum_qty[t-417]   ,  sum_qty[t-418]   ,  sum_qty[t-419]   ,  sum_qty[t-420]   ,  </div><div class="sasSource">sum_qty[t-421]   ,  sum_qty[t-422]   ,  sum_qty[t-423]   ,  sum_qty[t-424]   ,  sum_qty[t-425]   ,  sum_qty[t-426]   ,  </div><div class="sasSource">sum_qty[t-427]   ,  sum_qty[t-428]   ,  sum_qty[t-429]   ,  sum_qty[t-430]   ,  sum_qty[t-431]   ,  sum_qty[t-432]   ,  </div><div class="sasSource">sum_qty[t-433]   ,  sum_qty[t-434]   ,  sum_qty[t-435]   ,  sum_qty[t-436]   ,  sum_qty[t-437]   ,  sum_qty[t-438]   ,  </div><div class="sasSource">sum_qty[t-439]   ,  sum_qty[t-440]   ,  sum_qty[t-441]   ,  sum_qty[t-442]   ,  sum_qty[t-443]   ,  sum_qty[t-444]   ,  </div><div class="sasSource">sum_qty[t-445]   ,  sum_qty[t-446]   ,  sum_qty[t-447]   ,  sum_qty[t-448]   ,  sum_qty[t-449]   ,  sum_qty[t-450]   ,  </div><div class="sasSource">sum_qty[t-451]   ,  sum_qty[t-452]   ,  sum_qty[t-453]   ,  sum_qty[t-454]   ,  sum_qty[t-455]) ;     end;      " , arrayOut={ </div><div class="sasSource">table={name='lag_abt3', replace=true, caslib='Public'}, arrays={{name='lag_year_pct90'}, {name='lag_year_pct10'}, </div><div class="sasSource">{name='lag_halfyear_pct90'}, {name='lag_halfyear_pct10'}, {name='lag_qtr_pct90'}, {name='lag_qtr_pct10'}, {name='lag_month_pct90'}, </div><div class="sasSource">{name='lag_month_pct10'}, {name='lag_week_pct90'}, {name='lag_week_pct10'}} } ;</div><div class="sasSource">MPRINT(CMPCODE3):   run;</div><div class="sasNote" id="sasLogNote264_1594283467627">NOTE: Active Session now CASAUTO.</div><div class="sasSource">MPRINT(CMPCODE3):   quit;</div><div class="sasNote" id="sasLogNote265_1594283467627">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           11:10.11</div><div class="sasNote">      user cpu time       1.74 seconds</div><div class="sasNote">      system cpu time     0.12 seconds</div><div class="sasNote">      memory              10495.50k</div><div class="sasNote">      OS Memory           43916.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:27:49 PM</div><div class="sasNote">      Step Count                        77  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     3880</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        3505</div><div class="sasNote">      Involuntary Context Switches      79</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           147248</div><div class="sasNote">      </div><div class="sasSource">1585  </div><div class="sasSource">1586  /* соеденим среднее, медиану, стд, процентили вместе, убирая пропуску</div><div class="sasSource">1586! вр ВР */</div><div class="sasSource">1587  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote266_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1588  create table public.abt5_ml{options replace=true} as</div><div class="sasSource">1589  select</div><div class="sasSource">1590  t1.PBO_LOCATION_ID,</div><div class="sasSource">1591  t1.PRODUCT_ID,</div><div class="sasSource">1592  t1.CHANNEL_CD,</div><div class="sasSource">1593  t1.SALES_DT,</div><div class="sasSource">1594  t1.sum_qty,</div><div class="sasSource">1595  t1.GROSS_PRICE_AMT,</div><div class="sasSource">1596  t2.lag_halfyear_avg,</div><div class="sasSource">1597  t2.lag_halfyear_med,</div><div class="sasSource">1598  t2.lag_month_avg,</div><div class="sasSource">1599  t2.lag_month_med,</div><div class="sasSource">1600  t2.lag_qtr_avg,</div><div class="sasSource">1601  t2.lag_qtr_med,</div><div class="sasSource">1602  t2.lag_week_avg,</div><div class="sasSource">1603  t2.lag_week_med,</div><div class="sasSource">1604  t2.lag_year_avg,</div><div class="sasSource">1605  t2.lag_year_med</div><div class="sasSource">1606  from</div><div class="sasSource">1607  public.abt4_ml as t1,</div><div class="sasSource">1608  public.lag_abt1 as t2</div><div class="sasSource">1609  where</div><div class="sasSource">1610  t1.CHANNEL_CD = t2.CHANNEL_CD and</div><div class="sasSource">1611  t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">1612  t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">1613  t1.SALES_DT = t2.SALES_DT</div><div class="sasSource">1614  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote267_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT5_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote268_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1615  quit;</div><div class="sasNote" id="sasLogNote269_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           7:13.37</div><div class="sasNote">      user cpu time       0.18 seconds</div><div class="sasNote">      system cpu time     0.07 seconds</div><div class="sasNote">      memory              259.31k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:35:02 PM</div><div class="sasNote">      Step Count                        78  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     321</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        2281</div><div class="sasNote">      Involuntary Context Switches      3</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           136</div><div class="sasNote">      </div><div class="sasSource">1616  </div><div class="sasSource">1617  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote270_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1618  create table public.abt5_ml{options replace=true} as</div><div class="sasSource">1619  select</div><div class="sasSource">1620  t1.PBO_LOCATION_ID,</div><div class="sasSource">1621  t1.PRODUCT_ID,</div><div class="sasSource">1622  t1.CHANNEL_CD,</div><div class="sasSource">1623  t1.SALES_DT,</div><div class="sasSource">1624  t1.sum_qty,</div><div class="sasSource">1625  t1.GROSS_PRICE_AMT,</div><div class="sasSource">1626  t1.lag_halfyear_avg,</div><div class="sasSource">1627  t1.lag_halfyear_med,</div><div class="sasSource">1628  t1.lag_month_avg,</div><div class="sasSource">1629  t1.lag_month_med,</div><div class="sasSource">1630  t1.lag_qtr_avg,</div><div class="sasSource">1631  t1.lag_qtr_med,</div><div class="sasSource">1632  t1.lag_week_avg,</div><div class="sasSource">1633  t1.lag_week_med,</div><div class="sasSource">1634  t1.lag_year_avg,</div><div class="sasSource">1635  t1.lag_year_med,</div><div class="sasSource">1636  t2.lag_halfyear_std,</div><div class="sasSource">1637  t2.lag_month_std,</div><div class="sasSource">1638  t2.lag_qtr_std,</div><div class="sasSource">1639  t2.lag_week_std,</div><div class="sasSource">1640  t2.lag_year_std</div><div class="sasSource">1641  from</div><div class="sasSource">1642  public.abt5_ml as t1,</div><div class="sasSource">1643  public.lag_abt2 as t2</div><div class="sasSource">1644  where</div><div class="sasSource">1645  t1.CHANNEL_CD = t2.CHANNEL_CD and</div><div class="sasSource">1646  t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">1647  t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">1648  t1.SALES_DT = t2.SALES_DT</div><div class="sasSource">1649  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote271_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT5_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote272_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1650  quit;</div><div class="sasNote" id="sasLogNote273_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           6:57.37</div><div class="sasNote">      user cpu time       0.19 seconds</div><div class="sasNote">      system cpu time     0.08 seconds</div><div class="sasNote">      memory              273.21k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:42:00 PM</div><div class="sasNote">      Step Count                        79  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     199</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        2212</div><div class="sasNote">      Involuntary Context Switches      4</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           144</div><div class="sasNote">      </div><div class="sasSource">1651  </div><div class="sasSource">1652  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote274_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1653  create table public.abt5_ml{options replace=true} as</div><div class="sasSource">1654  select</div><div class="sasSource">1655  t1.PBO_LOCATION_ID,</div><div class="sasSource">1656  t1.PRODUCT_ID,</div><div class="sasSource">1657  t1.CHANNEL_CD,</div><div class="sasSource">1658  t1.SALES_DT,</div><div class="sasSource">1659  t1.sum_qty,</div><div class="sasSource">1660  t1.GROSS_PRICE_AMT,</div><div class="sasSource">1661  t1.lag_halfyear_avg,</div><div class="sasSource">1662  t1.lag_halfyear_med,</div><div class="sasSource">1663  t1.lag_month_avg,</div><div class="sasSource">1664  t1.lag_month_med,</div><div class="sasSource">1665  t1.lag_qtr_avg,</div><div class="sasSource">1666  t1.lag_qtr_med,</div><div class="sasSource">1667  t1.lag_week_avg,</div><div class="sasSource">1668  t1.lag_week_med,</div><div class="sasSource">1669  t1.lag_year_avg,</div><div class="sasSource">1670  t1.lag_year_med,</div><div class="sasSource">1671  t1.lag_halfyear_std,</div><div class="sasSource">1672  t1.lag_month_std,</div><div class="sasSource">1673  t1.lag_qtr_std,</div><div class="sasSource">1674  t1.lag_week_std,</div><div class="sasSource">1675  t1.lag_year_std,</div><div class="sasSource">1676  t2.lag_halfyear_pct10,</div><div class="sasSource">1677  t2.lag_halfyear_pct90,</div><div class="sasSource">1678  t2.lag_month_pct10,</div><div class="sasSource">1679  t2.lag_month_pct90,</div><div class="sasSource">1680  t2.lag_qtr_pct10,</div><div class="sasSource">1681  t2.lag_qtr_pct90,</div><div class="sasSource">1682  t2.lag_week_pct10,</div><div class="sasSource">1683  t2.lag_week_pct90,</div><div class="sasSource">1684  t2.lag_year_pct10,</div><div class="sasSource">1685  t2.lag_year_pct90</div><div class="sasSource">1686  from</div><div class="sasSource">1687  public.abt5_ml as t1,</div><div class="sasSource">1688  public.lag_abt3 as t2</div><div class="sasSource">1689  where</div><div class="sasSource">1690  t1.CHANNEL_CD = t2.CHANNEL_CD and</div><div class="sasSource">1691  t1.PBO_LOCATION_ID = t2.PBO_LOCATION_ID and</div><div class="sasSource">1692  t1.PRODUCT_ID = t2.PRODUCT_ID and</div><div class="sasSource">1693  t1.SALES_DT = t2.SALES_DT</div><div class="sasSource">1694  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote275_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT5_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote276_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1695  quit;</div><div class="sasNote" id="sasLogNote277_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           8:56.73</div><div class="sasNote">      user cpu time       0.25 seconds</div><div class="sasNote">      system cpu time     0.10 seconds</div><div class="sasNote">      memory              276.21k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:50:56 PM</div><div class="sasNote">      Step Count                        80  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     260</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        2841</div><div class="sasNote">      Involuntary Context Switches      2</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           184</div><div class="sasNote">      </div><div class="sasSource">1696  </div><div class="sasSource">1697  proc casutil;</div><div class="sasNote" id="sasLogNote278_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1698  /*   promote casdata="abt5_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">1699    droptable casdata='lag_abt1' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote279_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 5.891826 seconds.</div><div class="sasSource">1700    droptable casdata='lag_abt2' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote280_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 3.772455 seconds.</div><div class="sasSource">1701    droptable casdata='lag_abt3' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote281_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 5.634423 seconds.</div><div class="sasSource">1702  run;</div><div class="sasSource">1703  </div><div class="sasSource">1704  </div><div class="sasSource">1705  /****** 6. Добавление промо ******/</div><div class="sasNote" id="sasLogNote282_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           15.32 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              261.18k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:51:12 PM</div><div class="sasNote">      Step Count                        81  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     77</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        91</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           40</div><div class="sasNote">      </div><div class="sasSource">1706  proc casutil;</div><div class="sasNote" id="sasLogNote283_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">1707  </div><div class="sasSource">1707!  load data=&amp;inlib..ia_pbo_loc_hierarchy casout='ia_pbo_loc_hierarchy' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote284_1594283467627">NOTE: ETL_STG.IA_PBO_LOC_HIERARCHY was successfully added to the "Public" caslib as "IA_PBO_LOC_HIERARCHY".</div><div class="sasSource">1708  </div><div class="sasSource">1708!  load data=&amp;inlib..ia_product_hierarchy casout='ia_product_hierarchy' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote285_1594283467627">NOTE: ETL_STG.IA_PRODUCT_HIERARCHY was successfully added to the "Public" caslib as "IA_PRODUCT_HIERARCHY".</div><div class="sasSource">1709  </div><div class="sasSource">1709!  load data=&amp;inlib..ia_promo casout='ia_promo' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote286_1594283467627">NOTE: ETL_STG.IA_PROMO was successfully added to the "Public" caslib as "IA_PROMO".</div><div class="sasSource">1710  </div><div class="sasSource">1710!  load data=&amp;inlib..ia_promo_x_pbo casout='ia_promo_x_pbo' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote287_1594283467627">NOTE: ETL_STG.IA_PROMO_X_PBO was successfully added to the "Public" caslib as "IA_PROMO_X_PBO".</div><div class="sasSource">1711  </div><div class="sasSource">1711!  load data=&amp;inlib..ia_promo_x_product casout='ia_promo_x_product' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote288_1594283467627">NOTE: ETL_STG.IA_PROMO_X_PRODUCT was successfully added to the "Public" caslib as "IA_PROMO_X_PRODUCT".</div><div class="sasSource">1712  </div><div class="sasSource">1713  </div><div class="sasSource">1713!  droptable casdata="pbo_hier_flat" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote289_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013392 seconds.</div><div class="sasSource">1714  </div><div class="sasSource">1714!  droptable casdata="product_hier_flat" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote290_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.01168 seconds.</div><div class="sasSource">1715  </div><div class="sasSource">1715!  droptable casdata="lvl5" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote291_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.011022 seconds.</div><div class="sasSource">1716  </div><div class="sasSource">1716!  droptable casdata="lvl4" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote292_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.0107 seconds.</div><div class="sasSource">1717  </div><div class="sasSource">1717!  droptable casdata="lvl3" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote293_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012211 seconds.</div><div class="sasSource">1718  </div><div class="sasSource">1718!  droptable casdata="lvl2" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote294_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012397 seconds.</div><div class="sasSource">1719  </div><div class="sasSource">1719!  droptable casdata="lvl1" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote295_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.0122 seconds.</div><div class="sasSource">1720  </div><div class="sasSource">1720!  droptable casdata="pbo_lvl_all" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote296_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.015574 seconds.</div><div class="sasSource">1721  </div><div class="sasSource">1721!  droptable casdata="product_lvl_all" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote297_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012221 seconds.</div><div class="sasSource">1722    </div><div class="sasSource">1722!    droptable casdata="promo_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote298_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012676 seconds.</div><div class="sasSource">1723    </div><div class="sasSource">1723!    droptable casdata="promo_transposed" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote299_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012335 seconds.</div><div class="sasSource">1724    </div><div class="sasSource">1724!    droptable casdata="abt6_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote300_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012182 seconds.</div><div class="sasSource">1725    </div><div class="sasSource">1725!    droptable casdata="ia_promo_x_product_leaf" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote301_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.011351 seconds.</div><div class="sasSource">1726    </div><div class="sasSource">1726!    droptable casdata="ia_promo_x_pbo_leaf" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote302_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.01261 seconds.</div><div class="sasSource">1727    </div><div class="sasSource">1727!    droptable casdata="promo_ml_main_code" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote303_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.011744 seconds.</div><div class="sasSource">1728    </div><div class="sasSource">1728!    droptable casdata="abt_promo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote304_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012358 seconds.</div><div class="sasSource">1729  run;</div><div class="sasSource">1730  </div><div class="sasSource">1731  /* Создаем таблицу связывающую PBO на листовом уровне и на любом другом</div><div class="sasSource">1731!  */</div><div class="sasNote" id="sasLogNote305_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.42 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              1376.96k</div><div class="sasNote">      OS Memory           34844.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:51:12 PM</div><div class="sasNote">      Step Count                        82  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     956</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        149</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">1732  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote306_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1733  create table public.pbo_hier_flat{options replace=true} as</div><div class="sasSource">1734  select</div><div class="sasSource">1735  t1.pbo_location_id,</div><div class="sasSource">1736  t2.PBO_LOCATION_ID as LVL3_ID,</div><div class="sasSource">1737  t2.PARENT_PBO_LOCATION_ID as LVL2_ID,</div><div class="sasSource">1738  1 as LVL1_ID</div><div class="sasSource">1739  from</div><div class="sasSource">1740  (select * from public.ia_pbo_loc_hierarchy where pbo_location_lvl=4) as t1</div><div class="sasSource">1741  left join</div><div class="sasSource">1742  (select * from public.ia_pbo_loc_hierarchy where pbo_location_lvl=3) as t2</div><div class="sasSource">1743  on t1.PARENT_PBO_LOCATION_ID=t2.PBO_LOCATION_ID</div><div class="sasSource">1744  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote307_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_HIER_FLAT was created in caslib Public with 820 rows returned.</div><div class="sasNote" id="sasLogNote308_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1745  create table public.lvl4{options replace=true} as</div><div class="sasSource">1746  select</div><div class="sasSource">1747  pbo_location_id as pbo_location_id,</div><div class="sasSource">1748  pbo_location_id as pbo_leaf_id</div><div class="sasSource">1749  from</div><div class="sasSource">1750  public.pbo_hier_flat</div><div class="sasSource">1751  ;</div><div class="sasSource">NOTE: Table LVL4 was created in caslib Public with 820 rows returned.</div><div class="sasNote" id="sasLogNote309_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1752  create table public.lvl3{options replace=true} as</div><div class="sasSource">1753  select</div><div class="sasSource">1754  LVL3_ID as pbo_location_id,</div><div class="sasSource">1755  pbo_location_id as pbo_leaf_id</div><div class="sasSource">1756  from</div><div class="sasSource">1757  public.pbo_hier_flat</div><div class="sasSource">1758  ;</div><div class="sasSource">NOTE: Table LVL3 was created in caslib Public with 820 rows returned.</div><div class="sasNote" id="sasLogNote310_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1759  create table public.lvl2{options replace=true} as</div><div class="sasSource">1760  select</div><div class="sasSource">1761  LVL2_ID as pbo_location_id,</div><div class="sasSource">1762  pbo_location_id as pbo_leaf_id</div><div class="sasSource">1763  from</div><div class="sasSource">1764  public.pbo_hier_flat</div><div class="sasSource">1765  ;</div><div class="sasSource">NOTE: Table LVL2 was created in caslib Public with 820 rows returned.</div><div class="sasNote" id="sasLogNote311_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1766  create table public.lvl1{options replace=true} as</div><div class="sasSource">1767  select</div><div class="sasSource">1768  1 as pbo_location_id,</div><div class="sasSource">1769  pbo_location_id as pbo_leaf_id</div><div class="sasSource">1770  from</div><div class="sasSource">1771  public.pbo_hier_flat</div><div class="sasSource">1772  ;</div><div class="sasSource">NOTE: Table LVL1 was created in caslib Public with 820 rows returned.</div><div class="sasNote" id="sasLogNote312_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1773  quit;</div><div class="sasNote" id="sasLogNote313_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.51 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.12k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:51:13 PM</div><div class="sasNote">      Step Count                        83  Switch Count  5</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        65</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">1774  </div><div class="sasSource">1775  /* Соединяем в единый справочник ПБО */</div><div class="sasSource">1776  data public.pbo_lvl_all;</div><div class="sasSource">1777  set public.lvl4 public.lvl3 public.lvl2 public.lvl1;</div><div class="sasSource">1778  run;</div><div class="sasNote" id="sasLogNote314_1594283467627">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote315_1594283467627">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote316_1594283467627">NOTE: There were 820 observations read from the table LVL4 in caslib Public.</div><div class="sasNote" id="sasLogNote317_1594283467627">NOTE: There were 820 observations read from the table LVL3 in caslib Public.</div><div class="sasNote" id="sasLogNote318_1594283467627">NOTE: There were 820 observations read from the table LVL2 in caslib Public.</div><div class="sasNote" id="sasLogNote319_1594283467627">NOTE: There were 820 observations read from the table LVL1 in caslib Public.</div><div class="sasNote" id="sasLogNote320_1594283467627">NOTE: The table pbo_lvl_all in caslib Public has 3280 observations and 2 variables.</div><div class="sasNote" id="sasLogNote321_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.31 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1475.25k</div><div class="sasNote">      OS Memory           34840.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:51:13 PM</div><div class="sasNote">      Step Count                        84  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     168</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        148</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1779  </div><div class="sasSource">1780  /* Создаем таблицу связывающую товары на листовом уровне и на любом</div><div class="sasSource">1780! другом */</div><div class="sasSource">1781  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote322_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1782     create table public.product_hier_flat{options replace=true} as</div><div class="sasSource">1783  select t1.product_id,</div><div class="sasSource">1784     t2.product_id  as LVL4_ID,</div><div class="sasSource">1785     t3.product_id  as LVL3_ID,</div><div class="sasSource">1786     t3.PARENT_product_id as LVL2_ID,</div><div class="sasSource">1787     1 as LVL1_ID</div><div class="sasSource">1788  from</div><div class="sasSource">1789  (select * from public.ia_product_hierarchy where product_lvl=5) as t1</div><div class="sasSource">1790  left join</div><div class="sasSource">1791  (select * from public.ia_product_hierarchy where product_lvl=4) as t2</div><div class="sasSource">1792  on t1.PARENT_PRODUCT_ID=t2.PRODUCT_ID</div><div class="sasSource">1793  left join</div><div class="sasSource">1794  (select * from public.ia_product_hierarchy where product_lvl=3) as t3</div><div class="sasSource">1795  on t2.PARENT_PRODUCT_ID=t3.PRODUCT_ID</div><div class="sasSource">1796   ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote323_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PRODUCT_HIER_FLAT was created in caslib Public with 2512 rows returned.</div><div class="sasNote" id="sasLogNote324_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1797  create table public.lvl5{options replace=true} as</div><div class="sasSource">1798  select</div><div class="sasSource">1799  product_id as product_id,</div><div class="sasSource">1800  product_id as product_leaf_id</div><div class="sasSource">1801  from</div><div class="sasSource">1802  public.product_hier_flat</div><div class="sasSource">1803  ;</div><div class="sasSource">NOTE: Table LVL5 was created in caslib Public with 2512 rows returned.</div><div class="sasNote" id="sasLogNote325_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1804  create table public.lvl4{options replace=true} as</div><div class="sasSource">1805  select</div><div class="sasSource">1806  LVL4_ID as product_id,</div><div class="sasSource">1807  product_id as product_leaf_id</div><div class="sasSource">1808  from</div><div class="sasSource">1809  public.product_hier_flat</div><div class="sasSource">1810  ;</div><div class="sasSource">NOTE: Table LVL4 was created in caslib Public with 2512 rows returned.</div><div class="sasNote" id="sasLogNote326_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1811  create table public.lvl3{options replace=true} as</div><div class="sasSource">1812  select</div><div class="sasSource">1813  LVL3_ID as product_id,</div><div class="sasSource">1814  product_id as product_leaf_id</div><div class="sasSource">1815  from</div><div class="sasSource">1816  public.product_hier_flat</div><div class="sasSource">1817  ;</div><div class="sasSource">NOTE: Table LVL3 was created in caslib Public with 2512 rows returned.</div><div class="sasNote" id="sasLogNote327_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1818  create table public.lvl2{options replace=true} as</div><div class="sasSource">1819  select</div><div class="sasSource">1820  LVL2_ID as product_id,</div><div class="sasSource">1821  product_id as product_leaf_id</div><div class="sasSource">1822  from</div><div class="sasSource">1823  public.product_hier_flat</div><div class="sasSource">1824  ;</div><div class="sasSource">NOTE: Table LVL2 was created in caslib Public with 2512 rows returned.</div><div class="sasNote" id="sasLogNote328_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1825  create table public.lvl1{options replace=true} as</div><div class="sasSource">1826  select</div><div class="sasSource">1827  1 as product_id,</div><div class="sasSource">1828  product_id as product_leaf_id</div><div class="sasSource">1829  from</div><div class="sasSource">1830  public.product_hier_flat</div><div class="sasSource">1831  ;</div><div class="sasSource">NOTE: Table LVL1 was created in caslib Public with 2512 rows returned.</div><div class="sasNote" id="sasLogNote329_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1832  quit;</div><div class="sasNote" id="sasLogNote330_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.78 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              86.12k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:51:14 PM</div><div class="sasNote">      Step Count                        85  Switch Count  6</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        78</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">1833  </div><div class="sasSource">1834  /* Соединяем в единый справочник ПБО */</div><div class="sasSource">1835  data public.product_lvl_all;</div><div class="sasSource">1836  set public.lvl5 public.lvl4 public.lvl3 public.lvl2 public.lvl1;</div><div class="sasSource">1837  run;</div><div class="sasNote" id="sasLogNote331_1594283467627">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote332_1594283467627">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote333_1594283467627">NOTE: There were 2512 observations read from the table LVL5 in caslib Public.</div><div class="sasNote" id="sasLogNote334_1594283467627">NOTE: There were 2512 observations read from the table LVL4 in caslib Public.</div><div class="sasNote" id="sasLogNote335_1594283467627">NOTE: There were 2512 observations read from the table LVL3 in caslib Public.</div><div class="sasNote" id="sasLogNote336_1594283467627">NOTE: There were 2512 observations read from the table LVL2 in caslib Public.</div><div class="sasNote" id="sasLogNote337_1594283467627">NOTE: There were 2512 observations read from the table LVL1 in caslib Public.</div><div class="sasNote" id="sasLogNote338_1594283467627">NOTE: The table product_lvl_all in caslib Public has 12560 observations and 2 variables.</div><div class="sasNote" id="sasLogNote339_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.35 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1492.68k</div><div class="sasNote">      OS Memory           34840.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:51:14 PM</div><div class="sasNote">      Step Count                        86  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     23</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        168</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">1838  </div><div class="sasSource">1839  /* Добавляем к таблице промо ПБО и товары */</div><div class="sasSource">1840  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote340_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1841  create table public.ia_promo_x_pbo_leaf{options replace = true} as</div><div class="sasSource">1842  select distinct</div><div class="sasSource">1843  t1.promo_id,</div><div class="sasSource">1844  t2.PBO_LEAF_ID</div><div class="sasSource">1845  from</div><div class="sasSource">1846  public.ia_promo_x_pbo as t1,</div><div class="sasSource">1847  public.pbo_lvl_all as t2</div><div class="sasSource">1848  where t1.pbo_location_id = t2.PBO_LOCATION_ID</div><div class="sasSource">1849  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote341_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table IA_PROMO_X_PBO_LEAF was created in caslib Public with 74446 rows returned.</div><div class="sasNote" id="sasLogNote342_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1850  create table public.ia_promo_x_product_leaf{options replace = true} as</div><div class="sasSource">1851  select distinct</div><div class="sasSource">1852  t1.promo_id,</div><div class="sasSource">1853  t2.product_LEAF_ID</div><div class="sasSource">1854  from</div><div class="sasSource">1855  public.ia_promo_x_product as t1,</div><div class="sasSource">1856  public.product_lvl_all as t2</div><div class="sasSource">1857  where t1.product_id = t2.product_id</div><div class="sasSource">1858  ;</div><div class="sasSource">NOTE: Table IA_PROMO_X_PRODUCT_LEAF was created in caslib Public with 3096 rows returned.</div><div class="sasNote" id="sasLogNote343_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1859  create table public.promo_ml{options replace = true} as</div><div class="sasSource">1860  select</div><div class="sasSource">1861  t1.PROMO_ID,</div><div class="sasSource">1862  t3.product_LEAF_ID,</div><div class="sasSource">1863  t2.PBO_LEAF_ID,</div><div class="sasSource">1864  t1.PROMO_NM,</div><div class="sasSource">1865  t1.PROMO_PRICE_AMT,</div><div class="sasSource">1866  datepart(t1.START_DT) as start_dt,</div><div class="sasSource">1867  datepart(t1.END_DT) as end_dt,</div><div class="sasSource">1868  t1.CHANNEL_CD,</div><div class="sasSource">1869  t1.NP_GIFT_PRICE_AMT,</div><div class="sasSource">1870  t1.PROMO_MECHANICS,</div><div class="sasSource">1871  (case</div><div class="sasSource">1872  when t1.PROMO_MECHANICS = 'BOGO / 1+1' then 'bogo'</div><div class="sasSource">1873  when t1.PROMO_MECHANICS = 'Discount' then 'discount'</div><div class="sasSource">1874  when t1.PROMO_MECHANICS = 'EVM/Set' then 'evm_set'</div><div class="sasSource">1875  when t1.PROMO_MECHANICS = 'Non-Product Gift' then 'non_product_gift'</div><div class="sasSource">1876  when t1.PROMO_MECHANICS = 'Pairs' then 'pairs'</div><div class="sasSource">1877  when t1.PROMO_MECHANICS = 'Product Gift' then 'product_gift'</div><div class="sasSource">1878  when t1.PROMO_MECHANICS = 'Other: Discount for volume' then 'other_promo'</div><div class="sasSource">1879  when t1.PROMO_MECHANICS = 'NP Promo Support' then 'support'</div><div class="sasSource">1880  end) as promo_mechanics_name,</div><div class="sasSource">1881  1 as promo_flag</div><div class="sasSource">1882  from</div><div class="sasSource">1883  public.ia_promo as t1</div><div class="sasSource">1884  left join</div><div class="sasSource">1885  public.ia_promo_x_pbo_leaf as t2</div><div class="sasSource">1886  on</div><div class="sasSource">1887  t1.PROMO_ID = t2.PROMO_ID</div><div class="sasSource">1888  left join</div><div class="sasSource">1889  public.ia_promo_x_product_leaf as t3</div><div class="sasSource">1890  on</div><div class="sasSource">1891  t1.PROMO_ID = t3.PROMO_ID</div><div class="sasSource">1892  ;</div><div class="sasSource">NOTE: CASDAL driver. Creation of a TIMESTAMP column has been requested, but is not supported by the CASDAL driver. A DOUBLE </div><div class="sasSource">PRECISION column will be created instead. A DATETIME format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a TIMESTAMP column has been requested, but is not supported by the CASDAL driver. A DOUBLE </div><div class="sasSource">PRECISION column will be created instead. A DATETIME format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table PROMO_ML was created in caslib Public with 2213107 rows returned.</div><div class="sasNote" id="sasLogNote344_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1893  quit;</div><div class="sasNote" id="sasLogNote345_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           5.67 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              215.87k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:51:20 PM</div><div class="sasNote">      Step Count                        87  Switch Count  4</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     9</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        85</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">1894  </div><div class="sasSource">1895  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote346_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1896  create table public.promo_ml_main_code{options replace = true} as</div><div class="sasSource">1897  select distinct</div><div class="sasSource">1898  (MOD(t2.LVL4_ID, 10000)) AS product_MAIN_CODE,</div><div class="sasSource">1899  t1.PBO_LEAF_ID,</div><div class="sasSource">1900  datepart(t1.START_DT) as start_dt,</div><div class="sasSource">1901  datepart(t1.END_DT) as end_dt,</div><div class="sasSource">1902  t1.CHANNEL_CD,</div><div class="sasSource">1903  case</div><div class="sasSource">1904  when product_LEAF_ID = MOD(t2.LVL4_ID, 10000) then 0</div><div class="sasSource">1905  else 1</div><div class="sasSource">1906  end as side_promo_flag</div><div class="sasSource">1907  </div><div class="sasSource">1908  from</div><div class="sasSource">1909  public.promo_ml as t1</div><div class="sasSource">1910  left join</div><div class="sasSource">1911  public.public.product_hier_flat as t2</div><div class="sasSource">1912  on</div><div class="sasSource">1913  t1.product_LEAF_ID = t2.product_id</div><div class="sasSource">1914  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote347_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table PROMO_ML_MAIN_CODE was created in caslib Public with 1787796 rows returned.</div><div class="sasNote" id="sasLogNote348_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1915  quit;</div><div class="sasNote" id="sasLogNote349_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           1.98 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              111.37k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:51:22 PM</div><div class="sasNote">      Step Count                        88  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     13</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        44</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1916  </div><div class="sasSource">1917  /* транспонируем таблицу с промо по типам промо механк */</div><div class="sasSource">1918  proc cas;</div><div class="sasSource">1919  transpose.transpose /</div><div class="sasSource">1920  table = {</div><div class="sasSource">1921  name="promo_ml",</div><div class="sasSource">1922  caslib="public",</div><div class="sasSource">1923  groupby={"promo_id", "product_LEAF_ID", "PBO_LEAF_ID", "CHANNEL_CD", "START_DT", "END_DT"}}</div><div class="sasSource">1924  transpose={"promo_flag"}</div><div class="sasSource">1925  id={"promo_mechanics_name"}</div><div class="sasSource">1926  casout={name="promo_transposed", caslib="public", replace=true};</div><div class="sasSource">1927  quit;</div><div class="sasNote" id="sasLogNote350_1594283467627">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote351_1594283467627">NOTE: There were 2213107 rows read from the table PROMO_ML.</div><div class="sasNote" id="sasLogNote352_1594283467627">NOTE: The table promo_transposed has 2213107 rows and 15 columns.</div><div class="sasNote" id="sasLogNote353_1594283467627">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           13.24 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              10262.46k</div><div class="sasNote">      OS Memory           43916.00k</div><div class="sasNote">      Timestamp           07/08/2020 10:51:35 PM</div><div class="sasNote">      Step Count                        89  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1242</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        76</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">1928  </div><div class="sasSource">1929  /* Соединяем с витриной */</div><div class="sasSource">1930  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote354_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">1931  /* Подготоваливаем таблицу для джойна с витриной */</div><div class="sasSource">1932  create table public.abt_promo{options replace = true} as</div><div class="sasSource">1933  select</div><div class="sasSource">1934  t1.PBO_LOCATION_ID,</div><div class="sasSource">1935  t1.PRODUCT_ID,</div><div class="sasSource">1936  t1.CHANNEL_CD,</div><div class="sasSource">1937  t1.SALES_DT,</div><div class="sasSource">1938  max(coalesce(t2.other_promo, 0)) as other_promo,</div><div class="sasSource">1939  max(coalesce(t2.support, 0)) as support,</div><div class="sasSource">1940  max(coalesce(t2.bogo, 0)) as bogo,</div><div class="sasSource">1941  max(coalesce(t2.discount, 0)) as discount,</div><div class="sasSource">1942  max(coalesce(t2.evm_set, 0)) as evm_set,</div><div class="sasSource">1943  max(coalesce(t2.non_product_gift, 0)) as non_product_gift,</div><div class="sasSource">1944  max(coalesce(t2.pairs, 0)) as pairs,</div><div class="sasSource">1945  max(coalesce(t2.product_gift, 0)) as product_gift,</div><div class="sasSource">1946  max(coalesce(t3.side_promo_flag, 0)) as side_promo_flag</div><div class="sasSource">1947  from</div><div class="sasSource">1948  public.abt5_ml as t1</div><div class="sasSource">1949  left join</div><div class="sasSource">1950  public.promo_transposed as t2</div><div class="sasSource">1951  on</div><div class="sasSource">1952  t1.product_id = t2.product_LEAF_ID and</div><div class="sasSource">1953  t1.pbo_location_id = t2.PBO_LEAF_ID and</div><div class="sasSource">1954  t1.SALES_DT &lt;= t2.END_DT and</div><div class="sasSource">1955  t1.SALES_DT &gt;= t2.START_DT</div><div class="sasSource">1956  left join</div><div class="sasSource">1957  public.promo_ml_main_code as t3</div><div class="sasSource">1958  on</div><div class="sasSource">1959  t1.product_id = t3.product_MAIN_CODE and</div><div class="sasSource">1960  t1.pbo_location_id = t3.PBO_LEAF_ID and</div><div class="sasSource">1961  t1.SALES_DT &lt;= t3.END_DT and</div><div class="sasSource">1962  t1.SALES_DT &gt;= t3.START_DT</div><div class="sasSource">1963  group by</div><div class="sasSource">1964  t1.PBO_LOCATION_ID,</div><div class="sasSource">1965  t1.PRODUCT_ID,</div><div class="sasSource">1966  t1.CHANNEL_CD,</div><div class="sasSource">1967  t1.SALES_DT</div><div class="sasSource">1968  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote355_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT_PROMO was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote356_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">1969  /* Добавляем промо к витрине */</div><div class="sasSource">1970  create table public.abt6_ml{options replace = true} as</div><div class="sasSource">1971  select</div><div class="sasSource">1972  t1.PBO_LOCATION_ID,</div><div class="sasSource">1973  t1.PRODUCT_ID,</div><div class="sasSource">1974  t1.CHANNEL_CD,</div><div class="sasSource">1975  t1.SALES_DT,</div><div class="sasSource">1976  t1.sum_qty,</div><div class="sasSource">1977  t1.GROSS_PRICE_AMT,</div><div class="sasSource">1978  t1.lag_halfyear_avg,</div><div class="sasSource">1979  t1.lag_halfyear_med,</div><div class="sasSource">1980  t1.lag_month_avg,</div><div class="sasSource">1981  t1.lag_month_med,</div><div class="sasSource">1982  t1.lag_qtr_avg,</div><div class="sasSource">1983  t1.lag_qtr_med,</div><div class="sasSource">1984  t1.lag_week_avg,</div><div class="sasSource">1985  t1.lag_week_med,</div><div class="sasSource">1986  t1.lag_year_avg,</div><div class="sasSource">1987  t1.lag_year_med,</div><div class="sasSource">1988  t1.lag_halfyear_std,</div><div class="sasSource">1989  t1.lag_month_std,</div><div class="sasSource">1990  t1.lag_qtr_std,</div><div class="sasSource">1991  t1.lag_week_std,</div><div class="sasSource">1992  t1.lag_year_std,</div><div class="sasSource">1993  t1.lag_halfyear_pct10,</div><div class="sasSource">1994  t1.lag_halfyear_pct90,</div><div class="sasSource">1995  t1.lag_month_pct10,</div><div class="sasSource">1996  t1.lag_month_pct90,</div><div class="sasSource">1997  t1.lag_qtr_pct10,</div><div class="sasSource">1998  t1.lag_qtr_pct90,</div><div class="sasSource">1999  t1.lag_week_pct10,</div><div class="sasSource">2000  t1.lag_week_pct90,</div><div class="sasSource">2001  t1.lag_year_pct10,</div><div class="sasSource">2002  t1.lag_year_pct90,</div><div class="sasSource">2003  t2.other_promo,</div><div class="sasSource">2004  t2.support,</div><div class="sasSource">2005  t2.bogo,</div><div class="sasSource">2006  t2.discount,</div><div class="sasSource">2007  t2.evm_set,</div><div class="sasSource">2008  t2.non_product_gift,</div><div class="sasSource">2009  t2.pairs,</div><div class="sasSource">2010  t2.product_gift,</div><div class="sasSource">2011   t2.side_promo_flag</div><div class="sasSource">2012  from</div><div class="sasSource">2013  public.abt5_ml as t1</div><div class="sasSource">2014  left join</div><div class="sasSource">2015  public.abt_promo as t2</div><div class="sasSource">2016  on</div><div class="sasSource">2017  t1.product_id = t2.product_id and</div><div class="sasSource">2018  t1.pbo_location_id = t2.pbo_location_id and</div><div class="sasSource">2019  t1.SALES_DT = t2.SALES_DT and</div><div class="sasSource">2020  t1.CHANNEL_CD = t2.CHANNEL_CD</div><div class="sasSource">2021  ;</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT6_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote357_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2022  quit;</div><div class="sasNote" id="sasLogNote358_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           10:10.80</div><div class="sasNote">      user cpu time       0.27 seconds</div><div class="sasNote">      system cpu time     0.12 seconds</div><div class="sasNote">      memory              273.90k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:01:46 PM</div><div class="sasNote">      Step Count                        90  Switch Count  7</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     298</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        3252</div><div class="sasNote">      Involuntary Context Switches      3</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           216</div><div class="sasNote">      </div><div class="sasSource">2023  </div><div class="sasSource">2024  proc casutil;</div><div class="sasNote" id="sasLogNote359_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2025  /* promote casdata="abt6_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2026  </div><div class="sasSource">2026!  promote casdata="pbo_lvl_all" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote360_1594283467627">NOTE: Cloud Analytic Services promoted table PBO_LVL_ALL in caslib Public to table pbo_lvl_all in caslib public.</div><div class="sasNote" id="sasLogNote361_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.01961 seconds.</div><div class="sasSource">2027  </div><div class="sasSource">2027!  promote casdata="product_lvl_all" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote362_1594283467627">NOTE: Cloud Analytic Services promoted table PRODUCT_LVL_ALL in caslib Public to table product_lvl_all in caslib public.</div><div class="sasNote" id="sasLogNote363_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.0216 seconds.</div><div class="sasSource">2028  </div><div class="sasSource">2029  </div><div class="sasSource">2029!  droptable casdata="pbo_hier_flat" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote364_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008518 seconds.</div><div class="sasSource">2030  </div><div class="sasSource">2030!  droptable casdata="product_hier_flat" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote365_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010842 seconds.</div><div class="sasSource">2031  </div><div class="sasSource">2031!  droptable casdata="lvl5" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote366_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008202 seconds.</div><div class="sasSource">2032  </div><div class="sasSource">2032!  droptable casdata="lvl4" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote367_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010522 seconds.</div><div class="sasSource">2033  </div><div class="sasSource">2033!  droptable casdata="lvl3" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote368_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008007 seconds.</div><div class="sasSource">2034  </div><div class="sasSource">2034!  droptable casdata="lvl2" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote369_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008324 seconds.</div><div class="sasSource">2035  </div><div class="sasSource">2035!  droptable casdata="lvl1" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote370_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008115 seconds.</div><div class="sasSource">2036    </div><div class="sasSource">2036!    droptable casdata="ia_pbo_loc_hierarchy" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote371_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010483 seconds.</div><div class="sasSource">2037    </div><div class="sasSource">2037!    droptable casdata="ia_product_hierarchy" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote372_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.007711 seconds.</div><div class="sasSource">2038    </div><div class="sasSource">2038!    droptable casdata="ia_promo_x_pbo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote373_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008483 seconds.</div><div class="sasSource">2039    </div><div class="sasSource">2039!    droptable casdata="ia_promo_x_product" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote374_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.015382 seconds.</div><div class="sasSource">2040    </div><div class="sasSource">2040!    droptable casdata="promo_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote375_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.414853 seconds.</div><div class="sasSource">2041    </div><div class="sasSource">2041!    droptable casdata="promo_transposed" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote376_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.061049 seconds.</div><div class="sasSource">2042    </div><div class="sasSource">2042!    droptable casdata="ia_promo_x_product_leaf" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote377_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008546 seconds.</div><div class="sasSource">2043    </div><div class="sasSource">2043!    droptable casdata="ia_promo_x_pbo_leaf" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote378_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.0084 seconds.</div><div class="sasSource">2044    </div><div class="sasSource">2044!    droptable casdata="promo_ml_main_code" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote379_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.032471 seconds.</div><div class="sasSource">2045    </div><div class="sasSource">2045!    droptable casdata="abt_promo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote380_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 1.86943 seconds.</div><div class="sasSource">2046  run;</div><div class="sasSource">2047  </div><div class="sasSource">2048  </div><div class="sasSource">2049  /****** 7. Добавляем мароэкономику ******/</div><div class="sasNote" id="sasLogNote381_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           2.69 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              238.37k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:01:49 PM</div><div class="sasNote">      Step Count                        91  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     17</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        132</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">2050  proc casutil;</div><div class="sasNote" id="sasLogNote382_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2051    droptable casdata="macro_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote383_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.014481 seconds.</div><div class="sasSource">2052    droptable casdata="macro2_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote384_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010808 seconds.</div><div class="sasSource">2053    droptable casdata="macro_transposed_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote385_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012132 seconds.</div><div class="sasSource">2054    droptable casdata="abt7_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote386_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.011579 seconds.</div><div class="sasSource">2055    load data=&amp;inlib..IA_macro_factor casout='ia_macro' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote387_1594283467627">NOTE: ETL_STG.IA_MACRO_FACTOR was successfully added to the "Public" caslib as "IA_MACRO".</div><div class="sasSource">2056  run;</div><div class="sasSource">2057  </div><div class="sasNote" id="sasLogNote388_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              972.84k</div><div class="sasNote">      OS Memory           34328.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:01:49 PM</div><div class="sasNote">      Step Count                        92  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     15</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        31</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2058  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote389_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2059  create table public.macro_ml{options replace=true} as</div><div class="sasSource">2060  select</div><div class="sasSource">2061  factor_cd,</div><div class="sasSource">2062  datepart(cast(REPORT_DT as timestamp)) as period_dt,</div><div class="sasSource">2063  FACTOR_CHNG_PCT</div><div class="sasSource">2064  from public.ia_macro;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote390_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table MACRO_ML was created in caslib Public with 48 rows returned.</div><div class="sasNote" id="sasLogNote391_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2065  quit;</div><div class="sasNote" id="sasLogNote392_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              83.40k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:01:49 PM</div><div class="sasNote">      Step Count                        93  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     10</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2066  </div><div class="sasSource">2067  data public.macro2_ml;</div><div class="sasSource">2068    format period_dt date9.;</div><div class="sasSource">2069    drop pdt;</div><div class="sasSource">2070    set public.macro_ml(rename=(period_dt=pdt));</div><div class="sasSource">2071    by factor_cd pdt;</div><div class="sasSource">2072    factor_cd=substr(factor_cd,1,3);</div><div class="sasSource">2073    period_dt=pdt;</div><div class="sasSource">2074    do until (period_dt&gt;=intnx('day',intnx('month',pdt,3,'b'),0,'b'));</div><div class="sasSource">2075      output;</div><div class="sasSource">2076      period_dt=intnx('day',period_dt,1,'b');</div><div class="sasSource">2077    end;</div><div class="sasSource">2078  run;</div><div class="sasNote" id="sasLogNote393_1594283467627">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote394_1594283467627">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote395_1594283467627">NOTE: There were 48 observations read from the table MACRO_ML in caslib Public.</div><div class="sasNote" id="sasLogNote396_1594283467627">NOTE: The table macro2_ml in caslib Public has 4383 observations and 3 variables.</div><div class="sasNote" id="sasLogNote397_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.21 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1381.81k</div><div class="sasNote">      OS Memory           34840.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:01:49 PM</div><div class="sasNote">      Step Count                        94  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     60</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        76</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2079  </div><div class="sasSource">2080  proc cas;</div><div class="sasSource">2081  transpose.transpose /</div><div class="sasSource">2082     table={name="macro2_ml", caslib="public", groupby={"period_dt"}}</div><div class="sasSource">2083     attributes={{name="period_dt"}}</div><div class="sasSource">2084     transpose={"FACTOR_CHNG_PCT"}</div><div class="sasSource">2085     prefix="A_"</div><div class="sasSource">2086     id={"factor_cd"}</div><div class="sasSource">2087     casout={name="macro_transposed_ml", caslib="public", replace=true};</div><div class="sasSource">2088  quit;</div><div class="sasNote" id="sasLogNote398_1594283467627">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote399_1594283467627">NOTE: There were 4383 rows read from the table MACRO2_ML.</div><div class="sasNote" id="sasLogNote400_1594283467627">NOTE: The table macro_transposed_ml has 1461 rows and 6 columns.</div><div class="sasNote" id="sasLogNote401_1594283467627">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10269.09k</div><div class="sasNote">      OS Memory           43916.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:01:49 PM</div><div class="sasNote">      Step Count                        95  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1021</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        12</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2089  </div><div class="sasSource">2090  /* Соединяем с ABT */</div><div class="sasSource">2091  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote402_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2092  create table public.abt7_ml{options replace = true} as</div><div class="sasSource">2093  select</div><div class="sasSource">2094  t1.PBO_LOCATION_ID,</div><div class="sasSource">2095  t1.PRODUCT_ID,</div><div class="sasSource">2096  t1.CHANNEL_CD,</div><div class="sasSource">2097  t1.SALES_DT,</div><div class="sasSource">2098  t1.sum_qty,</div><div class="sasSource">2099  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2100  t1.lag_halfyear_avg,</div><div class="sasSource">2101  t1.lag_halfyear_med,</div><div class="sasSource">2102  t1.lag_month_avg,</div><div class="sasSource">2103  t1.lag_month_med,</div><div class="sasSource">2104  t1.lag_qtr_avg,</div><div class="sasSource">2105  t1.lag_qtr_med,</div><div class="sasSource">2106  t1.lag_week_avg,</div><div class="sasSource">2107  t1.lag_week_med,</div><div class="sasSource">2108  t1.lag_year_avg,</div><div class="sasSource">2109  t1.lag_year_med,</div><div class="sasSource">2110  t1.lag_halfyear_std,</div><div class="sasSource">2111  t1.lag_month_std,</div><div class="sasSource">2112  t1.lag_qtr_std,</div><div class="sasSource">2113  t1.lag_week_std,</div><div class="sasSource">2114  t1.lag_year_std,</div><div class="sasSource">2115  t1.lag_halfyear_pct10,</div><div class="sasSource">2116  t1.lag_halfyear_pct90,</div><div class="sasSource">2117  t1.lag_month_pct10,</div><div class="sasSource">2118  t1.lag_month_pct90,</div><div class="sasSource">2119  t1.lag_qtr_pct10,</div><div class="sasSource">2120  t1.lag_qtr_pct90,</div><div class="sasSource">2121  t1.lag_week_pct10,</div><div class="sasSource">2122  t1.lag_week_pct90,</div><div class="sasSource">2123  t1.lag_year_pct10,</div><div class="sasSource">2124  t1.lag_year_pct90,</div><div class="sasSource">2125  t1.other_promo,</div><div class="sasSource">2126  t1.support,</div><div class="sasSource">2127  t1.bogo,</div><div class="sasSource">2128  t1.discount,</div><div class="sasSource">2129  t1.evm_set,</div><div class="sasSource">2130  t1.non_product_gift,</div><div class="sasSource">2131  t1.pairs,</div><div class="sasSource">2132  t1.product_gift,</div><div class="sasSource">2133   t1.side_promo_flag,</div><div class="sasSource">2134  t2.A_CPI,</div><div class="sasSource">2135  t2.A_GPD,</div><div class="sasSource">2136  t2.A_RDI</div><div class="sasSource">2137  from</div><div class="sasSource">2138  public.abt6_ml as t1 left join</div><div class="sasSource">2139  public.macro_transposed_ml as t2</div><div class="sasSource">2140  on</div><div class="sasSource">2141  t1.sales_dt = t2.period_dt</div><div class="sasSource">2142  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote403_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT7_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote404_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2143  quit;</div><div class="sasNote" id="sasLogNote405_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           1:11.96</div><div class="sasNote">      user cpu time       0.04 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              275.90k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:03:01 PM</div><div class="sasNote">      Step Count                        96  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     35</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        400</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           40</div><div class="sasNote">      </div><div class="sasSource">2144  </div><div class="sasSource">2145  proc casutil;</div><div class="sasNote" id="sasLogNote406_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2146    droptable casdata="macro_transposed_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote407_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.017016 seconds.</div><div class="sasSource">2147    droptable casdata="macro2_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote408_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.015814 seconds.</div><div class="sasSource">2148    droptable casdata="ia_macro" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote409_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008938 seconds.</div><div class="sasSource">2149    droptable casdata="macro_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote410_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010145 seconds.</div><div class="sasSource">2150  /*   promote casdata="abt7_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2151  run;</div><div class="sasSource">2152  </div><div class="sasSource">2153  </div><div class="sasSource">2154  /***** 8. Добавляем погоду. *****/</div><div class="sasNote" id="sasLogNote411_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              118.84k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:03:01 PM</div><div class="sasNote">      Step Count                        97  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        17</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2155  proc casutil;</div><div class="sasNote" id="sasLogNote412_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2156    load data=&amp;inlib..ia_weather casout = 'ia_weather' outcaslib = 'public' replace;</div><div class="sasNote" id="sasLogNote413_1594283467627">NOTE: ETL_STG.IA_WEATHER was successfully added to the "Public" caslib as "IA_WEATHER".</div><div class="sasSource">2157    droptable casdata = "abt8_ml" incaslib = "public" quiet;</div><div class="sasNote" id="sasLogNote414_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.01097 seconds.</div><div class="sasSource">2158  run;</div><div class="sasSource">2159  </div><div class="sasNote" id="sasLogNote415_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.90 seconds</div><div class="sasNote">      user cpu time       0.36 seconds</div><div class="sasNote">      system cpu time     0.11 seconds</div><div class="sasNote">      memory              1520.53k</div><div class="sasNote">      OS Memory           34844.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:03:02 PM</div><div class="sasNote">      Step Count                        98  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14285</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        457</div><div class="sasNote">      Involuntary Context Switches      4</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2160  proc fedsql sessref =casauto;</div><div class="sasNote" id="sasLogNote416_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2161  create table public.abt8_ml{options replace = true} as</div><div class="sasSource">2162  select</div><div class="sasSource">2163  t1.PBO_LOCATION_ID,</div><div class="sasSource">2164  t1.PRODUCT_ID,</div><div class="sasSource">2165  t1.CHANNEL_CD,</div><div class="sasSource">2166  t1.SALES_DT,</div><div class="sasSource">2167  t1.sum_qty,</div><div class="sasSource">2168  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2169  t1.lag_halfyear_avg,</div><div class="sasSource">2170  t1.lag_halfyear_med,</div><div class="sasSource">2171  t1.lag_month_avg,</div><div class="sasSource">2172  t1.lag_month_med,</div><div class="sasSource">2173  t1.lag_qtr_avg,</div><div class="sasSource">2174  t1.lag_qtr_med,</div><div class="sasSource">2175  t1.lag_week_avg,</div><div class="sasSource">2176  t1.lag_week_med,</div><div class="sasSource">2177  t1.lag_year_avg,</div><div class="sasSource">2178  t1.lag_year_med,</div><div class="sasSource">2179  t1.lag_halfyear_std,</div><div class="sasSource">2180  t1.lag_month_std,</div><div class="sasSource">2181  t1.lag_qtr_std,</div><div class="sasSource">2182  t1.lag_week_std,</div><div class="sasSource">2183  t1.lag_year_std,</div><div class="sasSource">2184  t1.lag_halfyear_pct10,</div><div class="sasSource">2185  t1.lag_halfyear_pct90,</div><div class="sasSource">2186  t1.lag_month_pct10,</div><div class="sasSource">2187  t1.lag_month_pct90,</div><div class="sasSource">2188  t1.lag_qtr_pct10,</div><div class="sasSource">2189  t1.lag_qtr_pct90,</div><div class="sasSource">2190  t1.lag_week_pct10,</div><div class="sasSource">2191  t1.lag_week_pct90,</div><div class="sasSource">2192  t1.lag_year_pct10,</div><div class="sasSource">2193  t1.lag_year_pct90,</div><div class="sasSource">2194  t1.other_promo,</div><div class="sasSource">2195  t1.support,</div><div class="sasSource">2196  t1.bogo,</div><div class="sasSource">2197  t1.discount,</div><div class="sasSource">2198  t1.evm_set,</div><div class="sasSource">2199  t1.non_product_gift,</div><div class="sasSource">2200  t1.pairs,</div><div class="sasSource">2201  t1.product_gift,</div><div class="sasSource">2202   t1.side_promo_flag,</div><div class="sasSource">2203  t1.A_CPI,</div><div class="sasSource">2204  t1.A_GPD,</div><div class="sasSource">2205  t1.A_RDI,</div><div class="sasSource">2206  t2.TEMPERATURE,</div><div class="sasSource">2207  t2.PRECIPITATION</div><div class="sasSource">2208  from</div><div class="sasSource">2209  public.abt7_ml as t1</div><div class="sasSource">2210  left join</div><div class="sasSource">2211  public.ia_weather as t2</div><div class="sasSource">2212  on</div><div class="sasSource">2213  t1.pbo_location_id = t2.pbo_location_id and</div><div class="sasSource">2214  t1.sales_dt = datepart(t2.REPORT_DT)</div><div class="sasSource">2215  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote417_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT8_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote418_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2216  quit;</div><div class="sasNote" id="sasLogNote419_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           1:32.81</div><div class="sasNote">      user cpu time       0.05 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              277.40k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:04:35 PM</div><div class="sasNote">      Step Count                        99  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     46</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        515</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           40</div><div class="sasNote">      </div><div class="sasSource">2217  </div><div class="sasSource">2218  proc casutil;</div><div class="sasNote" id="sasLogNote420_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2219    droptable casdata="ia_weather" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote421_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.025368 seconds.</div><div class="sasSource">2220  /*   promote casdata="abt8_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2221  run;</div><div class="sasSource">2222  </div><div class="sasSource">2223  </div><div class="sasSource">2224  /***** 9. Добавляем trp конкурентов *****/</div><div class="sasNote" id="sasLogNote422_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              116.87k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:04:35 PM</div><div class="sasNote">      Step Count                        100  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2225  proc casutil;</div><div class="sasNote" id="sasLogNote423_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2226  </div><div class="sasSource">2226!  droptable casdata="comp_media_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote424_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.015208 seconds.</div><div class="sasSource">2227  </div><div class="sasSource">2227!  droptable casdata="abt9_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote425_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.016394 seconds.</div><div class="sasSource">2228  </div><div class="sasSource">2228!  load data=&amp;inlib..IA_comp_media casout='ia_comp_media' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote426_1594283467627">NOTE: ETL_STG.IA_COMP_MEDIA was successfully added to the "Public" caslib as "IA_COMP_MEDIA".</div><div class="sasSource">2229  run;</div><div class="sasSource">2230  </div><div class="sasNote" id="sasLogNote427_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              974.75k</div><div class="sasNote">      OS Memory           34328.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:04:35 PM</div><div class="sasNote">      Step Count                        101  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     13</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        23</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2231  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote428_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2232  create table public.comp_media_ml{options replace=true} as</div><div class="sasSource">2233  select</div><div class="sasSource">2234  COMPETITOR_CD,</div><div class="sasSource">2235  TRP,</div><div class="sasSource">2236  datepart(cast(report_dt as timestamp)) as report_dt</div><div class="sasSource">2237  from</div><div class="sasSource">2238  public.IA_COMP_MEDIA</div><div class="sasSource">2239  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote429_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table COMP_MEDIA_ML was created in caslib Public with 220 rows returned.</div><div class="sasNote" id="sasLogNote430_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2240  quit;</div><div class="sasNote" id="sasLogNote431_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              84.00k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:04:35 PM</div><div class="sasNote">      Step Count                        102  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2241  </div><div class="sasSource">2242  /* Транспонируем таблицу */</div><div class="sasSource">2243  proc cas;</div><div class="sasSource">2244  transpose.transpose /</div><div class="sasSource">2245     table={name="comp_media_ml", caslib="public", groupby={"REPORT_DT"}}</div><div class="sasSource">2246     transpose={"TRP"}</div><div class="sasSource">2247     prefix="comp_trp_"</div><div class="sasSource">2248     id={"COMPETITOR_CD"}</div><div class="sasSource">2249     casout={name="comp_transposed_ml", caslib="public", replace=true};</div><div class="sasSource">2250  quit;</div><div class="sasNote" id="sasLogNote432_1594283467627">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote433_1594283467627">NOTE: There were 220 rows read from the table COMP_MEDIA_ML.</div><div class="sasNote" id="sasLogNote434_1594283467627">NOTE: The table comp_transposed_ml has 110 rows and 5 columns.</div><div class="sasNote" id="sasLogNote435_1594283467627">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10248.31k</div><div class="sasNote">      OS Memory           43916.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:04:35 PM</div><div class="sasNote">      Step Count                        103  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     990</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        12</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2251  </div><div class="sasSource">2252  /* Протягиваем trp на всю неделю вперед */</div><div class="sasSource">2253  data public.comp_transposed_ml_expand;</div><div class="sasSource">2254  set public.comp_transposed_ml;</div><div class="sasSource">2255  by REPORT_DT;</div><div class="sasSource">2256  do i = 1 to 7;</div><div class="sasSource">2257     output;</div><div class="sasSource">2258     REPORT_DT + 1;</div><div class="sasSource">2259  end;</div><div class="sasSource">2260  run;</div><div class="sasNote" id="sasLogNote436_1594283467627">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote437_1594283467627">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote438_1594283467627">NOTE: There were 110 observations read from the table COMP_TRANSPOSED_ML in caslib Public.</div><div class="sasNote" id="sasLogNote439_1594283467627">NOTE: The table comp_transposed_ml_expand in caslib Public has 770 observations and 6 variables.</div><div class="sasNote" id="sasLogNote440_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.16 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1380.00k</div><div class="sasNote">      OS Memory           34840.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:04:35 PM</div><div class="sasNote">      Step Count                        104  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     15</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        76</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2261  </div><div class="sasSource">2262  /*</div><div class="sasSource">2263  Пока в данных есть ошибка, все интевалы report_dt указаны</div><div class="sasSource">2264  с интервалом в неделю, но есть одно наблюдение</div><div class="sasSource">2265  в котором этот порядок рушится 16dec2019 и 22dec2019 (6 Дней)</div><div class="sasSource">2266  Поэтому, пока в таблице есть дубль, который мы убираем путем</div><div class="sasSource">2266! усреднения</div><div class="sasSource">2267  */</div><div class="sasSource">2268  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote441_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2269  create table public.comp_transposed_ml_expand{options replace=true} as</div><div class="sasSource">2270  select</div><div class="sasSource">2271  REPORT_DT,</div><div class="sasSource">2272  mean(comp_trp_BK) as comp_trp_BK,</div><div class="sasSource">2273  mean(comp_trp_KFC) as comp_trp_KFC</div><div class="sasSource">2274  from</div><div class="sasSource">2275  public.comp_transposed_ml_expand</div><div class="sasSource">2276  group by report_dt</div><div class="sasSource">2277  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote442_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table COMP_TRANSPOSED_ML_EXPAND was created in caslib Public with 770 rows returned.</div><div class="sasNote" id="sasLogNote443_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2278  quit;</div><div class="sasNote" id="sasLogNote444_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              83.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:04:35 PM</div><div class="sasNote">      Step Count                        105  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        23</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2279  </div><div class="sasSource">2280  /* Соединяем с ABT */</div><div class="sasSource">2281  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote445_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2282  create table public.abt9_ml{options replace=true} as</div><div class="sasSource">2283  select</div><div class="sasSource">2284  t1.PBO_LOCATION_ID,</div><div class="sasSource">2285  t1.PRODUCT_ID,</div><div class="sasSource">2286  t1.CHANNEL_CD,</div><div class="sasSource">2287  t1.SALES_DT,</div><div class="sasSource">2288  t1.sum_qty,</div><div class="sasSource">2289  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2290  t1.lag_halfyear_avg,</div><div class="sasSource">2291  t1.lag_halfyear_med,</div><div class="sasSource">2292  t1.lag_month_avg,</div><div class="sasSource">2293  t1.lag_month_med,</div><div class="sasSource">2294  t1.lag_qtr_avg,</div><div class="sasSource">2295  t1.lag_qtr_med,</div><div class="sasSource">2296  t1.lag_week_avg,</div><div class="sasSource">2297  t1.lag_week_med,</div><div class="sasSource">2298  t1.lag_year_avg,</div><div class="sasSource">2299  t1.lag_year_med,</div><div class="sasSource">2300  t1.lag_halfyear_std,</div><div class="sasSource">2301  t1.lag_month_std,</div><div class="sasSource">2302  t1.lag_qtr_std,</div><div class="sasSource">2303  t1.lag_week_std,</div><div class="sasSource">2304  t1.lag_year_std,</div><div class="sasSource">2305  t1.lag_halfyear_pct10,</div><div class="sasSource">2306  t1.lag_halfyear_pct90,</div><div class="sasSource">2307  t1.lag_month_pct10,</div><div class="sasSource">2308  t1.lag_month_pct90,</div><div class="sasSource">2309  t1.lag_qtr_pct10,</div><div class="sasSource">2310  t1.lag_qtr_pct90,</div><div class="sasSource">2311  t1.lag_week_pct10,</div><div class="sasSource">2312  t1.lag_week_pct90,</div><div class="sasSource">2313  t1.lag_year_pct10,</div><div class="sasSource">2314  t1.lag_year_pct90,</div><div class="sasSource">2315  t1.other_promo,</div><div class="sasSource">2316  t1.support,</div><div class="sasSource">2317  t1.bogo,</div><div class="sasSource">2318  t1.discount,</div><div class="sasSource">2319  t1.evm_set,</div><div class="sasSource">2320  t1.non_product_gift,</div><div class="sasSource">2321  t1.pairs,</div><div class="sasSource">2322  t1.product_gift,</div><div class="sasSource">2323   t1.side_promo_flag,</div><div class="sasSource">2324  t1.A_CPI,</div><div class="sasSource">2325  t1.A_GPD,</div><div class="sasSource">2326  t1.A_RDI,</div><div class="sasSource">2327  t1.TEMPERATURE,</div><div class="sasSource">2328  t1.PRECIPITATION,</div><div class="sasSource">2329  t2.comp_trp_BK,</div><div class="sasSource">2330  t2.comp_trp_KFC</div><div class="sasSource">2331  from</div><div class="sasSource">2332  public.abt8_ml as t1</div><div class="sasSource">2333  left join</div><div class="sasSource">2334  public.comp_transposed_ml_expand as t2</div><div class="sasSource">2335  on</div><div class="sasSource">2336  t1.sales_dt = t2.REPORT_DT</div><div class="sasSource">2337  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote446_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT9_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote447_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2338  quit;</div><div class="sasNote" id="sasLogNote448_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           1:22.76</div><div class="sasNote">      user cpu time       0.05 seconds</div><div class="sasNote">      system cpu time     0.02 seconds</div><div class="sasNote">      memory              275.90k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:05:58 PM</div><div class="sasNote">      Step Count                        106  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     55</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        464</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           40</div><div class="sasNote">      </div><div class="sasSource">2339  </div><div class="sasSource">2340  proc casutil;</div><div class="sasNote" id="sasLogNote449_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2341  </div><div class="sasSource">2341!  droptable casdata='ia_comp_media' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote450_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008701 seconds.</div><div class="sasSource">2342  </div><div class="sasSource">2342!  droptable casdata='comp_media_ml' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote451_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010237 seconds.</div><div class="sasSource">2343  </div><div class="sasSource">2343!  droptable casdata='comp_transposed_ml' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote452_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008718 seconds.</div><div class="sasSource">2344  </div><div class="sasSource">2344!  droptable casdata='comp_transposed_ml_expand' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote453_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.011609 seconds.</div><div class="sasSource">2345  /* promote casdata="abt9_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2346  run;</div><div class="sasSource">2347  </div><div class="sasSource">2348  </div><div class="sasSource">2349  /***** 10. Добавляем медиаподдержку *****/</div><div class="sasNote" id="sasLogNote454_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              115.21k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:05:58 PM</div><div class="sasNote">      Step Count                        107  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        16</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2350  proc casutil;</div><div class="sasNote" id="sasLogNote455_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2351    droptable casdata="media_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote456_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010289 seconds.</div><div class="sasSource">2352    droptable casdata="abt10_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote457_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.011119 seconds.</div><div class="sasSource">2353    load data=&amp;inlib..IA_media casout='ia_media' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote458_1594283467627">NOTE: ETL_STG.IA_MEDIA was successfully added to the "Public" caslib as "IA_MEDIA".</div><div class="sasSource">2354    load data=&amp;inlib..IA_promo casout='ia_promo' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote459_1594283467627">NOTE: ETL_STG.IA_PROMO was successfully added to the "Public" caslib as "IA_PROMO".</div><div class="sasSource">2355    load data=&amp;inlib..ia_promo_x_product casout='ia_promo_x_product' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote460_1594283467627">NOTE: ETL_STG.IA_PROMO_X_PRODUCT was successfully added to the "Public" caslib as "IA_PROMO_X_PRODUCT".</div><div class="sasSource">2356    load data=&amp;inlib..ia_promo_x_pbo casout='ia_promo_x_pbo' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote461_1594283467627">NOTE: ETL_STG.IA_PROMO_X_PBO was successfully added to the "Public" caslib as "IA_PROMO_X_PBO".</div><div class="sasSource">2357  run;</div><div class="sasSource">2358  </div><div class="sasNote" id="sasLogNote462_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.14 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1374.40k</div><div class="sasNote">      OS Memory           34844.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:05:58 PM</div><div class="sasNote">      Step Count                        108  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     447</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        78</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2359  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote463_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2360  create table public.ia_promo_x_pbo_leaf{options replace = true} as</div><div class="sasSource">2361  select</div><div class="sasSource">2362  t1.promo_id,</div><div class="sasSource">2363  t2.PBO_LEAF_ID</div><div class="sasSource">2364  from</div><div class="sasSource">2365  public.ia_promo_x_pbo as t1,</div><div class="sasSource">2366  public.pbo_lvl_all as t2</div><div class="sasSource">2367  where t1.pbo_location_id = t2.PBO_LOCATION_ID</div><div class="sasSource">2368  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote464_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table IA_PROMO_X_PBO_LEAF was created in caslib Public with 74446 rows returned.</div><div class="sasNote" id="sasLogNote465_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2369  create table public.ia_promo_x_product_leaf{options replace = true} as</div><div class="sasSource">2370  select</div><div class="sasSource">2371  t1.promo_id,</div><div class="sasSource">2372  t2.product_LEAF_ID</div><div class="sasSource">2373  from</div><div class="sasSource">2374  public.ia_promo_x_product as t1,</div><div class="sasSource">2375  public.product_lvl_all as t2</div><div class="sasSource">2376  where t1.product_id = t2.product_id</div><div class="sasSource">2377  ;</div><div class="sasSource">NOTE: Table IA_PROMO_X_PRODUCT_LEAF was created in caslib Public with 3150 rows returned.</div><div class="sasNote" id="sasLogNote466_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2378  create table public.promo_ml_trp{options replace = true} as</div><div class="sasSource">2379  select</div><div class="sasSource">2380  t1.PROMO_ID,</div><div class="sasSource">2381  t3.product_LEAF_ID,</div><div class="sasSource">2382  t2.PBO_LEAF_ID,</div><div class="sasSource">2383  t1.PROMO_NM,</div><div class="sasSource">2384  t1.START_DT,</div><div class="sasSource">2385  t1.END_DT,</div><div class="sasSource">2386  datepart(t4.REPORT_DT) as report_dt,</div><div class="sasSource">2387  t4.TRP</div><div class="sasSource">2388  from</div><div class="sasSource">2389  public.ia_promo as t1</div><div class="sasSource">2390  left join</div><div class="sasSource">2391  public.ia_promo_x_pbo_leaf as t2</div><div class="sasSource">2392  on</div><div class="sasSource">2393  t1.PROMO_ID = t2.PROMO_ID</div><div class="sasSource">2394  left join</div><div class="sasSource">2395  public.ia_promo_x_product_leaf as t3</div><div class="sasSource">2396  on</div><div class="sasSource">2397  t1.PROMO_ID = t3.PROMO_ID</div><div class="sasSource">2398  left join</div><div class="sasSource">2399  public.ia_media as t4</div><div class="sasSource">2400  on</div><div class="sasSource">2401  t1.PROMO_GROUP_ID = t4.PROMO_GROUP_ID</div><div class="sasSource">2402  ;</div><div class="sasSource">NOTE: CASDAL driver. Creation of a TIMESTAMP column has been requested, but is not supported by the CASDAL driver. A DOUBLE </div><div class="sasSource">PRECISION column will be created instead. A DATETIME format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a TIMESTAMP column has been requested, but is not supported by the CASDAL driver. A DOUBLE </div><div class="sasSource">PRECISION column will be created instead. A DATETIME format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a TIMESTAMP column has been requested, but is not supported by the CASDAL driver. A DOUBLE </div><div class="sasSource">PRECISION column will be created instead. A DATETIME format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a TIMESTAMP column has been requested, but is not supported by the CASDAL driver. A DOUBLE </div><div class="sasSource">PRECISION column will be created instead. A DATETIME format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a TIMESTAMP column has been requested, but is not supported by the CASDAL driver. A DOUBLE </div><div class="sasSource">PRECISION column will be created instead. A DATETIME format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a TIMESTAMP column has been requested, but is not supported by the CASDAL driver. A DOUBLE </div><div class="sasSource">PRECISION column will be created instead. A DATETIME format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table PROMO_ML_TRP was created in caslib Public with 7674112 rows returned.</div><div class="sasNote" id="sasLogNote467_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2403  quit;</div><div class="sasNote" id="sasLogNote468_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           8.10 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.71k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:06:06 PM</div><div class="sasNote">      Step Count                        109  Switch Count  5</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        110</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">2404  </div><div class="sasSource">2405  data public.promo_ml_trp_expand;</div><div class="sasSource">2406  set public.promo_ml_trp;</div><div class="sasSource">2407  do i = 1 to 7;</div><div class="sasSource">2408  output;</div><div class="sasSource">2409  REPORT_DT + 1;</div><div class="sasSource">2410  end;</div><div class="sasSource">2411  run;</div><div class="sasNote" id="sasLogNote469_1594283467627">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote470_1594283467627">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote471_1594283467627">NOTE: There were 7674112 observations read from the table PROMO_ML_TRP in caslib Public.</div><div class="sasNote" id="sasLogNote472_1594283467627">NOTE: The table promo_ml_trp_expand in caslib Public has 53718784 observations and 9 variables.</div><div class="sasNote" id="sasLogNote473_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           25.16 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1433.18k</div><div class="sasNote">      OS Memory           34840.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:06:32 PM</div><div class="sasNote">      Step Count                        110  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     24</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        202</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">2412  </div><div class="sasSource">2413  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote474_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2414  create table public.sum_trp{options replace=true} as</div><div class="sasSource">2415  select</div><div class="sasSource">2416  t1.PRODUCT_LEAF_ID,</div><div class="sasSource">2417  t1.PBO_LEAF_ID,</div><div class="sasSource">2418  t1.REPORT_DT,</div><div class="sasSource">2419  sum(t1.trp) as sum_trp</div><div class="sasSource">2420  from</div><div class="sasSource">2421  public.promo_ml_trp_expand as t1</div><div class="sasSource">2422  group by</div><div class="sasSource">2423  t1.PRODUCT_LEAF_ID,</div><div class="sasSource">2424  t1.PBO_LEAF_ID,</div><div class="sasSource">2425  t1.report_dt</div><div class="sasSource">2426  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote475_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table SUM_TRP was created in caslib Public with 46757984 rows returned.</div><div class="sasNote" id="sasLogNote476_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2427  create table public.abt10_ml{options replace=true} as</div><div class="sasSource">2428  select</div><div class="sasSource">2429  t1.PBO_LOCATION_ID,</div><div class="sasSource">2430  t1.PRODUCT_ID,</div><div class="sasSource">2431  t1.CHANNEL_CD,</div><div class="sasSource">2432  t1.SALES_DT,</div><div class="sasSource">2433  t1.sum_qty,</div><div class="sasSource">2434  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2435  t1.lag_halfyear_avg,</div><div class="sasSource">2436  t1.lag_halfyear_med,</div><div class="sasSource">2437  t1.lag_month_avg,</div><div class="sasSource">2438  t1.lag_month_med,</div><div class="sasSource">2439  t1.lag_qtr_avg,</div><div class="sasSource">2440  t1.lag_qtr_med,</div><div class="sasSource">2441  t1.lag_week_avg,</div><div class="sasSource">2442  t1.lag_week_med,</div><div class="sasSource">2443  t1.lag_year_avg,</div><div class="sasSource">2444  t1.lag_year_med,</div><div class="sasSource">2445  t1.lag_halfyear_std,</div><div class="sasSource">2446  t1.lag_month_std,</div><div class="sasSource">2447  t1.lag_qtr_std,</div><div class="sasSource">2448  t1.lag_week_std,</div><div class="sasSource">2449  t1.lag_year_std,</div><div class="sasSource">2450  t1.lag_halfyear_pct10,</div><div class="sasSource">2451  t1.lag_halfyear_pct90,</div><div class="sasSource">2452  t1.lag_month_pct10,</div><div class="sasSource">2453  t1.lag_month_pct90,</div><div class="sasSource">2454  t1.lag_qtr_pct10,</div><div class="sasSource">2455  t1.lag_qtr_pct90,</div><div class="sasSource">2456  t1.lag_week_pct10,</div><div class="sasSource">2457  t1.lag_week_pct90,</div><div class="sasSource">2458  t1.lag_year_pct10,</div><div class="sasSource">2459  t1.lag_year_pct90,</div><div class="sasSource">2460  t1.other_promo,</div><div class="sasSource">2461  t1.support,</div><div class="sasSource">2462  t1.bogo,</div><div class="sasSource">2463  t1.discount,</div><div class="sasSource">2464  t1.evm_set,</div><div class="sasSource">2465  t1.non_product_gift,</div><div class="sasSource">2466  t1.pairs,</div><div class="sasSource">2467  t1.product_gift,</div><div class="sasSource">2468   t1.side_promo_flag,</div><div class="sasSource">2469  t1.A_CPI,</div><div class="sasSource">2470  t1.A_GPD,</div><div class="sasSource">2471  t1.A_RDI,</div><div class="sasSource">2472  t1.TEMPERATURE,</div><div class="sasSource">2473  t1.PRECIPITATION,</div><div class="sasSource">2474  t1.comp_trp_BK,</div><div class="sasSource">2475  t1.comp_trp_KFC,</div><div class="sasSource">2476  t2.sum_trp</div><div class="sasSource">2477  from</div><div class="sasSource">2478  public.abt9_ml as t1</div><div class="sasSource">2479  left join</div><div class="sasSource">2480  public.sum_trp as t2</div><div class="sasSource">2481  on</div><div class="sasSource">2482  t1.product_id = t2.PRODUCT_LEAF_ID and</div><div class="sasSource">2483  t1.pbo_location_id = t2.PBO_LEAF_ID and</div><div class="sasSource">2484  t1.sales_dt = t2.report_dt</div><div class="sasSource">2485  ;</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT10_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote477_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2486  quit;</div><div class="sasNote" id="sasLogNote478_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           4:52.01</div><div class="sasNote">      user cpu time       0.12 seconds</div><div class="sasNote">      system cpu time     0.05 seconds</div><div class="sasNote">      memory              273.62k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:11:24 PM</div><div class="sasNote">      Step Count                        111  Switch Count  5</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     117</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        1566</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           120</div><div class="sasNote">      </div><div class="sasSource">2487  </div><div class="sasSource">2488  proc casutil;</div><div class="sasNote" id="sasLogNote479_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2489    droptable casdata="IA_media" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote480_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010083 seconds.</div><div class="sasSource">2490    droptable casdata="IA_promo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote481_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008769 seconds.</div><div class="sasSource">2491    droptable casdata="ia_promo_x_product" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote482_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.033082 seconds.</div><div class="sasSource">2492    droptable casdata="ia_promo_x_pbo" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote483_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010181 seconds.</div><div class="sasSource">2493    droptable casdata="ia_promo_x_pbo_leaf" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote484_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.01175 seconds.</div><div class="sasSource">2494    droptable casdata="ia_promo_x_product_leaf" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote485_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008863 seconds.</div><div class="sasSource">2495    droptable casdata="promo_ml_trp" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote486_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.937658 seconds.</div><div class="sasSource">2496    droptable casdata="promo_ml_trp_expand" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote487_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 6.146589 seconds.</div><div class="sasSource">2497    droptable casdata="sum_trp" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote488_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.203586 seconds.</div><div class="sasSource">2498  /*   promote casdata="abt10_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2499  run;</div><div class="sasSource">2500  </div><div class="sasSource">2501  </div><div class="sasSource">2502  /****** 11. Добавляем атрибуты товаров ******/</div><div class="sasNote" id="sasLogNote489_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           7.42 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              121.34k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:11:31 PM</div><div class="sasNote">      Step Count                        112  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        71</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">2503  proc casutil;</div><div class="sasNote" id="sasLogNote490_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2504    droptable casdata="abt11_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote491_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.011587 seconds.</div><div class="sasSource">2505  run;</div><div class="sasSource">2506  </div><div class="sasNote" id="sasLogNote492_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.01 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              116.87k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:11:31 PM</div><div class="sasNote">      Step Count                        113  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2507  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote493_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2508  create table public.abt11_ml{options replace=true} as</div><div class="sasSource">2509  select</div><div class="sasSource">2510  t1.PBO_LOCATION_ID,</div><div class="sasSource">2511  t1.PRODUCT_ID,</div><div class="sasSource">2512  t1.CHANNEL_CD,</div><div class="sasSource">2513  t1.SALES_DT,</div><div class="sasSource">2514  t1.sum_qty,</div><div class="sasSource">2515  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2516  t1.lag_halfyear_avg,</div><div class="sasSource">2517  t1.lag_halfyear_med,</div><div class="sasSource">2518  t1.lag_month_avg,</div><div class="sasSource">2519  t1.lag_month_med,</div><div class="sasSource">2520  t1.lag_qtr_avg,</div><div class="sasSource">2521  t1.lag_qtr_med,</div><div class="sasSource">2522  t1.lag_week_avg,</div><div class="sasSource">2523  t1.lag_week_med,</div><div class="sasSource">2524  t1.lag_year_avg,</div><div class="sasSource">2525  t1.lag_year_med,</div><div class="sasSource">2526  t1.lag_halfyear_std,</div><div class="sasSource">2527  t1.lag_month_std,</div><div class="sasSource">2528  t1.lag_qtr_std,</div><div class="sasSource">2529  t1.lag_week_std,</div><div class="sasSource">2530  t1.lag_year_std,</div><div class="sasSource">2531  t1.lag_halfyear_pct10,</div><div class="sasSource">2532  t1.lag_halfyear_pct90,</div><div class="sasSource">2533  t1.lag_month_pct10,</div><div class="sasSource">2534  t1.lag_month_pct90,</div><div class="sasSource">2535  t1.lag_qtr_pct10,</div><div class="sasSource">2536  t1.lag_qtr_pct90,</div><div class="sasSource">2537  t1.lag_week_pct10,</div><div class="sasSource">2538  t1.lag_week_pct90,</div><div class="sasSource">2539  t1.lag_year_pct10,</div><div class="sasSource">2540  t1.lag_year_pct90,</div><div class="sasSource">2541  t1.other_promo,</div><div class="sasSource">2542  t1.support,</div><div class="sasSource">2543  t1.bogo,</div><div class="sasSource">2544  t1.discount,</div><div class="sasSource">2545  t1.evm_set,</div><div class="sasSource">2546  t1.non_product_gift,</div><div class="sasSource">2547  t1.pairs,</div><div class="sasSource">2548  t1.product_gift,</div><div class="sasSource">2549   t1.side_promo_flag,</div><div class="sasSource">2550  t1.A_CPI,</div><div class="sasSource">2551  t1.A_GPD,</div><div class="sasSource">2552  t1.A_RDI,</div><div class="sasSource">2553  t1.TEMPERATURE,</div><div class="sasSource">2554  t1.PRECIPITATION,</div><div class="sasSource">2555  t1.comp_trp_BK,</div><div class="sasSource">2556  t1.comp_trp_KFC,</div><div class="sasSource">2557  t1.sum_trp,</div><div class="sasSource">2558  t2.prod_lvl4_id,</div><div class="sasSource">2559  t2.prod_lvl3_id,</div><div class="sasSource">2560  t2.prod_lvl2_id,</div><div class="sasSource">2561  t2.a_hero_id as hero,</div><div class="sasSource">2562  t2.a_item_size_id as item_size,</div><div class="sasSource">2563  t2.a_offer_type_id as offer_type,</div><div class="sasSource">2564  t2.a_price_tier_id as price_tier</div><div class="sasSource">2565  from</div><div class="sasSource">2566  public.abt10_ml as t1</div><div class="sasSource">2567  left join</div><div class="sasSource">2568  public.product_dictionary_ml as t2</div><div class="sasSource">2569  on</div><div class="sasSource">2570  t1.product_id = t2.product_id</div><div class="sasSource">2571  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote494_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT11_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote495_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2572  quit;</div><div class="sasNote" id="sasLogNote496_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           1:44.86</div><div class="sasNote">      user cpu time       0.06 seconds</div><div class="sasNote">      system cpu time     0.02 seconds</div><div class="sasNote">      memory              277.40k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:16 PM</div><div class="sasNote">      Step Count                        114  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     67</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        581</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           64</div><div class="sasNote">      </div><div class="sasSource">2573  </div><div class="sasSource">2574  proc casutil;</div><div class="sasNote" id="sasLogNote497_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2575  /*   promote casdata="abt11_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2576  run;</div><div class="sasSource">2577  </div><div class="sasSource">2578  </div><div class="sasSource">2579  /******12. Добавим атрибуты ПБО ******/</div><div class="sasNote" id="sasLogNote498_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              116.87k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:16 PM</div><div class="sasNote">      Step Count                        115  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2580  proc casutil;</div><div class="sasNote" id="sasLogNote499_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2581    droptable casdata="abt12_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote500_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012143 seconds.</div><div class="sasSource">2582    load data=&amp;inlib..IA_pbo_location casout='ia_pbo_location' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote501_1594283467627">NOTE: ETL_STG.IA_PBO_LOCATION was successfully added to the "Public" caslib as "IA_PBO_LOCATION".</div><div class="sasSource">2583    load data=&amp;inlib..IA_PBO_LOC_HIERARCHY casout='IA_PBO_LOC_HIERARCHY' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote502_1594283467627">NOTE: ETL_STG.IA_PBO_LOC_HIERARCHY was successfully added to the "Public" caslib as "IA_PBO_LOC_HIERARCHY".</div><div class="sasSource">2584    load data=&amp;inlib..IA_PBO_LOC_ATTRIBUTES casout='IA_PBO_LOC_ATTRIBUTES' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote503_1594283467627">NOTE: ETL_STG.IA_PBO_LOC_ATTRIBUTES was successfully added to the "Public" caslib as "IA_PBO_LOC_ATTRIBUTES".</div><div class="sasSource">2585  run;</div><div class="sasSource">2586  </div><div class="sasNote" id="sasLogNote504_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.14 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              1521.43k</div><div class="sasNote">      OS Memory           34844.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:16 PM</div><div class="sasNote">      Step Count                        116  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1384</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        77</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2587  proc cas;</div><div class="sasSource">2588  transpose.transpose /</div><div class="sasSource">2589     table={name="ia_pbo_loc_attributes", caslib="public", groupby={"pbo_location_id"}}</div><div class="sasSource">2590     attributes={{name="pbo_location_id"}}</div><div class="sasSource">2591     transpose={"PBO_LOC_ATTR_VALUE"}</div><div class="sasSource">2592     prefix="A_"</div><div class="sasSource">2593     id={"PBO_LOC_ATTR_NM"}</div><div class="sasSource">2594     casout={name="attr_transposed", caslib="public", replace=true};</div><div class="sasSource">2595  quit;</div><div class="sasNote" id="sasLogNote505_1594283467627">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote506_1594283467627">NOTE: There were 14760 rows read from the table IA_PBO_LOC_ATTRIBUTES.</div><div class="sasNote" id="sasLogNote507_1594283467627">NOTE: The table attr_transposed has 820 rows and 21 columns.</div><div class="sasNote" id="sasLogNote508_1594283467627">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.10 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10249.25k</div><div class="sasNote">      OS Memory           43916.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:16 PM</div><div class="sasNote">      Step Count                        117  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     989</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        12</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2596  </div><div class="sasSource">2597  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote509_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2598     create table public.pbo_hier_flat{options replace=true} as</div><div class="sasSource">2599  select t1.pbo_location_id,</div><div class="sasSource">2600     t2.PBO_LOCATION_ID as LVL3_ID,</div><div class="sasSource">2601     t2.PARENT_PBO_LOCATION_ID as LVL2_ID,</div><div class="sasSource">2602     1 as LVL1_ID</div><div class="sasSource">2603  from</div><div class="sasSource">2604  (select * from public.ia_pbo_loc_hierarchy where pbo_location_lvl=4) as t1</div><div class="sasSource">2605  left join</div><div class="sasSource">2606  (select * from public.ia_pbo_loc_hierarchy where pbo_location_lvl=3) as t2</div><div class="sasSource">2607  on t1.PARENT_PBO_LOCATION_ID=t2.PBO_LOCATION_ID</div><div class="sasSource">2608   ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote510_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_HIER_FLAT was created in caslib Public with 820 rows returned.</div><div class="sasNote" id="sasLogNote511_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2609  quit;</div><div class="sasNote" id="sasLogNote512_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.22 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.18k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:16 PM</div><div class="sasNote">      Step Count                        118  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2610  </div><div class="sasSource">2611  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote513_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2612  create table public.pbo_dictionary_ml{options replace=true} as</div><div class="sasSource">2613  select</div><div class="sasSource">2614  t2.pbo_location_id,</div><div class="sasSource">2615  coalesce(t2.lvl3_id,-999) as lvl3_id,</div><div class="sasSource">2616  coalesce(t2.lvl2_id,-99) as lvl2_id,</div><div class="sasSource">2617  coalesce(t14.pbo_location_nm,'NA') as pbo_location_nm,</div><div class="sasSource">2618  coalesce(t13.pbo_location_nm,'NA') as lvl3_nm,</div><div class="sasSource">2619  coalesce(t12.pbo_location_nm,'NA') as lvl2_nm,</div><div class="sasSource">2620  t3.A_AGREEMENT_TYPE,</div><div class="sasSource">2621  t3.A_BREAKFAST,</div><div class="sasSource">2622  t3.A_BUILDING_TYPE,</div><div class="sasSource">2623  t3.A_COMPANY,</div><div class="sasSource">2624  t3.A_DELIVERY,</div><div class="sasSource">2625  t3.A_DRIVE_THRU,</div><div class="sasSource">2626  t3.A_MCCAFE_TYPE,</div><div class="sasSource">2627  t3.A_PRICE_LEVEL,</div><div class="sasSource">2628  t3.A_WINDOW_TYPE</div><div class="sasSource">2629  from</div><div class="sasSource">2630  public.pbo_hier_flat t2</div><div class="sasSource">2631  left join</div><div class="sasSource">2632  public.attr_transposed t3</div><div class="sasSource">2633  on</div><div class="sasSource">2634  t2.pbo_location_id=t3.pbo_location_id</div><div class="sasSource">2635  left join</div><div class="sasSource">2636  PUBLIC.IA_PBO_LOCATION t14</div><div class="sasSource">2637  on</div><div class="sasSource">2638  t2.pbo_location_id=t14.pbo_location_id</div><div class="sasSource">2639  left join</div><div class="sasSource">2640  PUBLIC.IA_PBO_LOCATION t13</div><div class="sasSource">2641  on</div><div class="sasSource">2642  t2.lvl3_id=t13.pbo_location_id</div><div class="sasSource">2643  left join</div><div class="sasSource">2644  PUBLIC.IA_PBO_LOCATION t12</div><div class="sasSource">2645  on</div><div class="sasSource">2646  t2.lvl2_id=t12.pbo_location_id;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote514_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib Public with 820 rows returned.</div><div class="sasNote" id="sasLogNote515_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2647  quit;</div><div class="sasNote" id="sasLogNote516_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.46 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              216.09k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:17 PM</div><div class="sasNote">      Step Count                        119  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           16</div><div class="sasNote">      </div><div class="sasSource">2648  </div><div class="sasSource">2649  %text_encoding(public.pbo_dictionary_ml, A_AGREEMENT_TYPE)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote517_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_AGREEMENT_TYPE" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote518_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012297 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote519_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.01 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              116.87k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:17 PM</div><div class="sasNote">      Step Count                        120  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote520_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_AGREEMENT_TYPE from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote521_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 3 rows returned.</div><div class="sasNote" id="sasLogNote522_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote523_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.18k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:17 PM</div><div class="sasNote">      Step Count                        121  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote524_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote525_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote526_1594283467627">NOTE: There were 3 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote527_1594283467627">NOTE: The data set WORK.UNIQUE has 3 observations and 1 variables.</div><div class="sasNote" id="sasLogNote528_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote529_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.05 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              496.34k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:17 PM</div><div class="sasNote">      Step Count                        122  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     44</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        34</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_AGREEMENT_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_AGREEMENT_TYPE_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote530_1594283467627">NOTE: There were 3 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote531_1594283467627">NOTE: The data set WORK.ENCODING_A_AGREEMENT_TYPE has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote532_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_AGREEMENT_TYPE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote533_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              565.46k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:17 PM</div><div class="sasNote">      Step Count                        123  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     68</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_AGREEMENT_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_AGREEMENT_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote534_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote535_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote536_1594283467627">NOTE: There were 3 observations read from the data set WORK.ENCODING_A_AGREEMENT_TYPE.</div><div class="sasNote" id="sasLogNote537_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_AGREEMENT_TYPE has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote538_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              904.50k</div><div class="sasNote">      OS Memory           34328.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:17 PM</div><div class="sasNote">      Step Count                        124  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     146</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote539_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_AGREEMENT_TYPE_id </div><div class="sasSource">from public.pbo_dictionary_ml as t1 left join public.encoding_A_AGREEMENT_TYPE as t2 on t1.A_AGREEMENT_TYPE = t2.A_AGREEMENT_TYPE ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote540_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 820 rows returned.</div><div class="sasNote" id="sasLogNote541_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote542_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.14 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.28k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:17 PM</div><div class="sasNote">      Step Count                        125  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2650  %text_encoding(public.pbo_dictionary_ml, A_BREAKFAST)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote543_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_BREAKFAST" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote544_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.016941 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote545_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              112.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:17 PM</div><div class="sasNote">      Step Count                        126  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     8</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote546_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_BREAKFAST from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote547_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 2 rows returned.</div><div class="sasNote" id="sasLogNote548_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote549_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.12 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              81.15k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:17 PM</div><div class="sasNote">      Step Count                        127  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote550_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote551_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote552_1594283467627">NOTE: There were 2 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote553_1594283467627">NOTE: The data set WORK.UNIQUE has 2 observations and 1 variables.</div><div class="sasNote" id="sasLogNote554_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote555_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              496.78k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:17 PM</div><div class="sasNote">      Step Count                        128  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     17</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_BREAKFAST;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_BREAKFAST_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote556_1594283467627">NOTE: There were 2 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote557_1594283467627">NOTE: The data set WORK.ENCODING_A_BREAKFAST has 2 observations and 2 variables.</div><div class="sasNote" id="sasLogNote558_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_BREAKFAST increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote559_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              565.43k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:17 PM</div><div class="sasNote">      Step Count                        129  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_BREAKFAST;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_BREAKFAST;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote560_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote561_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote562_1594283467627">NOTE: There were 2 observations read from the data set WORK.ENCODING_A_BREAKFAST.</div><div class="sasNote" id="sasLogNote563_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_BREAKFAST has 2 observations and 2 variables.</div><div class="sasNote" id="sasLogNote564_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              904.50k</div><div class="sasNote">      OS Memory           34328.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        130  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     145</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote565_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_BREAKFAST_id from </div><div class="sasSource">public.pbo_dictionary_ml as t1 left join public.encoding_A_BREAKFAST as t2 on t1.A_BREAKFAST = t2.A_BREAKFAST ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote566_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 820 rows returned.</div><div class="sasNote" id="sasLogNote567_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote568_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.15 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        131  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2651  %text_encoding(public.pbo_dictionary_ml, A_BUILDING_TYPE)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote569_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_BUILDING_TYPE" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote570_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.014832 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote571_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              112.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        132  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote572_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_BUILDING_TYPE from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote573_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 4 rows returned.</div><div class="sasNote" id="sasLogNote574_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote575_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              81.25k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        133  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote576_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote577_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote578_1594283467627">NOTE: There were 4 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote579_1594283467627">NOTE: The data set WORK.UNIQUE has 4 observations and 1 variables.</div><div class="sasNote" id="sasLogNote580_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote581_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              522.25k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        134  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     19</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_BUILDING_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_BUILDING_TYPE_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote582_1594283467627">NOTE: There were 4 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote583_1594283467627">NOTE: The data set WORK.ENCODING_A_BUILDING_TYPE has 4 observations and 2 variables.</div><div class="sasNote" id="sasLogNote584_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_BUILDING_TYPE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote585_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              565.37k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        135  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     15</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_BUILDING_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_BUILDING_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote586_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote587_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote588_1594283467627">NOTE: There were 4 observations read from the data set WORK.ENCODING_A_BUILDING_TYPE.</div><div class="sasNote" id="sasLogNote589_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_BUILDING_TYPE has 4 observations and 2 variables.</div><div class="sasNote" id="sasLogNote590_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              904.50k</div><div class="sasNote">      OS Memory           34328.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        136  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     145</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote591_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_BUILDING_TYPE_id </div><div class="sasSource">from public.pbo_dictionary_ml as t1 left join public.encoding_A_BUILDING_TYPE as t2 on t1.A_BUILDING_TYPE = t2.A_BUILDING_TYPE ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote592_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 820 rows returned.</div><div class="sasNote" id="sasLogNote593_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote594_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.14 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.28k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        137  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2652  %text_encoding(public.pbo_dictionary_ml, A_COMPANY)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote595_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_COMPANY" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote596_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.018933 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote597_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              112.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        138  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote598_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_COMPANY from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote599_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 7 rows returned.</div><div class="sasNote" id="sasLogNote600_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote601_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              81.09k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        139  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote602_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote603_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote604_1594283467627">NOTE: There were 7 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote605_1594283467627">NOTE: The data set WORK.UNIQUE has 7 observations and 1 variables.</div><div class="sasNote" id="sasLogNote606_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote607_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              524.00k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        140  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     18</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_COMPANY;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_COMPANY_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote608_1594283467627">NOTE: There were 7 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote609_1594283467627">NOTE: The data set WORK.ENCODING_A_COMPANY has 7 observations and 2 variables.</div><div class="sasNote" id="sasLogNote610_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_COMPANY increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote611_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              565.56k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        141  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_COMPANY;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_COMPANY;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote612_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote613_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote614_1594283467627">NOTE: There were 7 observations read from the data set WORK.ENCODING_A_COMPANY.</div><div class="sasNote" id="sasLogNote615_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_COMPANY has 7 observations and 2 variables.</div><div class="sasNote" id="sasLogNote616_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              904.46k</div><div class="sasNote">      OS Memory           34328.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:18 PM</div><div class="sasNote">      Step Count                        142  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     148</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        21</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote617_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_COMPANY_id from </div><div class="sasSource">public.pbo_dictionary_ml as t1 left join public.encoding_A_COMPANY as t2 on t1.A_COMPANY = t2.A_COMPANY ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote618_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 820 rows returned.</div><div class="sasNote" id="sasLogNote619_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote620_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.16 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        143  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2653  %text_encoding(public.pbo_dictionary_ml, A_DELIVERY)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote621_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_DELIVERY" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote622_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012459 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote623_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.01 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              112.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        144  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote624_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_DELIVERY from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote625_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 5 rows returned.</div><div class="sasNote" id="sasLogNote626_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote627_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.17 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              81.09k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        145  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote628_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote629_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote630_1594283467627">NOTE: There were 5 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote631_1594283467627">NOTE: The data set WORK.UNIQUE has 5 observations and 1 variables.</div><div class="sasNote" id="sasLogNote632_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote633_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              534.43k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        146  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     21</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_DELIVERY;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_DELIVERY_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote634_1594283467627">NOTE: There were 5 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote635_1594283467627">NOTE: The data set WORK.ENCODING_A_DELIVERY has 5 observations and 2 variables.</div><div class="sasNote" id="sasLogNote636_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_DELIVERY increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote637_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              565.68k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        147  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     12</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_DELIVERY;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_DELIVERY;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote638_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote639_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote640_1594283467627">NOTE: There were 5 observations read from the data set WORK.ENCODING_A_DELIVERY.</div><div class="sasNote" id="sasLogNote641_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_DELIVERY has 5 observations and 2 variables.</div><div class="sasNote" id="sasLogNote642_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              904.62k</div><div class="sasNote">      OS Memory           34328.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        148  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     145</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote643_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_DELIVERY_id from </div><div class="sasSource">public.pbo_dictionary_ml as t1 left join public.encoding_A_DELIVERY as t2 on t1.A_DELIVERY = t2.A_DELIVERY ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote644_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 820 rows returned.</div><div class="sasNote" id="sasLogNote645_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote646_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.17 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        149  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2654  %text_encoding(public.pbo_dictionary_ml, A_MCCAFE_TYPE)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote647_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_MCCAFE_TYPE" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote648_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012251 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote649_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              112.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        150  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote650_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_MCCAFE_TYPE from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote651_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 3 rows returned.</div><div class="sasNote" id="sasLogNote652_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote653_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.28k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        151  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote654_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote655_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote656_1594283467627">NOTE: There were 3 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote657_1594283467627">NOTE: The data set WORK.UNIQUE has 3 observations and 1 variables.</div><div class="sasNote" id="sasLogNote658_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote659_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              509.43k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        152  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     18</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_MCCAFE_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_MCCAFE_TYPE_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote660_1594283467627">NOTE: There were 3 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote661_1594283467627">NOTE: The data set WORK.ENCODING_A_MCCAFE_TYPE has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote662_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_MCCAFE_TYPE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote663_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              565.50k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        153  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     17</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_MCCAFE_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_MCCAFE_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote664_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote665_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote666_1594283467627">NOTE: There were 3 observations read from the data set WORK.ENCODING_A_MCCAFE_TYPE.</div><div class="sasNote" id="sasLogNote667_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_MCCAFE_TYPE has 3 observations and 2 variables.</div><div class="sasNote" id="sasLogNote668_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              904.81k</div><div class="sasNote">      OS Memory           34328.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        154  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     145</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote669_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_MCCAFE_TYPE_id </div><div class="sasSource">from public.pbo_dictionary_ml as t1 left join public.encoding_A_MCCAFE_TYPE as t2 on t1.A_MCCAFE_TYPE = t2.A_MCCAFE_TYPE ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote670_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 820 rows returned.</div><div class="sasNote" id="sasLogNote671_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote672_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.16 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.28k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:19 PM</div><div class="sasNote">      Step Count                        155  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2655  %text_encoding(public.pbo_dictionary_ml, A_PRICE_LEVEL)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote673_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_PRICE_LEVEL" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote674_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013273 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote675_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              112.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:20 PM</div><div class="sasNote">      Step Count                        156  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote676_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_PRICE_LEVEL from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote677_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 34 rows returned.</div><div class="sasNote" id="sasLogNote678_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote679_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.17 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.28k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:20 PM</div><div class="sasNote">      Step Count                        157  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote680_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote681_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote682_1594283467627">NOTE: There were 34 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote683_1594283467627">NOTE: The data set WORK.UNIQUE has 34 observations and 1 variables.</div><div class="sasNote" id="sasLogNote684_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote685_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.09 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              576.96k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:20 PM</div><div class="sasNote">      Step Count                        158  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     21</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           272</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_PRICE_LEVEL;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_PRICE_LEVEL_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote686_1594283467627">NOTE: There were 34 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote687_1594283467627">NOTE: The data set WORK.ENCODING_A_PRICE_LEVEL has 34 observations and 2 variables.</div><div class="sasNote" id="sasLogNote688_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_PRICE_LEVEL increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote689_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              565.37k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:20 PM</div><div class="sasNote">      Step Count                        159  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_PRICE_LEVEL;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_PRICE_LEVEL;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote690_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote691_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote692_1594283467627">NOTE: There were 34 observations read from the data set WORK.ENCODING_A_PRICE_LEVEL.</div><div class="sasNote" id="sasLogNote693_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_PRICE_LEVEL has 34 observations and 2 variables.</div><div class="sasNote" id="sasLogNote694_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.12 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              904.87k</div><div class="sasNote">      OS Memory           34328.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:20 PM</div><div class="sasNote">      Step Count                        160  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     145</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        21</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote695_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_PRICE_LEVEL_id </div><div class="sasSource">from public.pbo_dictionary_ml as t1 left join public.encoding_A_PRICE_LEVEL as t2 on t1.A_PRICE_LEVEL = t2.A_PRICE_LEVEL ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote696_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 820 rows returned.</div><div class="sasNote" id="sasLogNote697_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote698_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.16 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.28k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:20 PM</div><div class="sasNote">      Step Count                        161  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        18</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2656  %text_encoding(public.pbo_dictionary_ml, A_DRIVE_THRU)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote699_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_DRIVE_THRU" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote700_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.026664 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote701_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              112.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:20 PM</div><div class="sasNote">      Step Count                        162  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote702_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_DRIVE_THRU from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote703_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 2 rows returned.</div><div class="sasNote" id="sasLogNote704_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote705_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.16 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              81.25k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:20 PM</div><div class="sasNote">      Step Count                        163  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote706_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote707_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote708_1594283467627">NOTE: There were 2 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote709_1594283467627">NOTE: The data set WORK.UNIQUE has 2 observations and 1 variables.</div><div class="sasNote" id="sasLogNote710_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote711_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              509.09k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:20 PM</div><div class="sasNote">      Step Count                        164  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     18</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        33</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_DRIVE_THRU;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_DRIVE_THRU_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote712_1594283467627">NOTE: There were 2 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote713_1594283467627">NOTE: The data set WORK.ENCODING_A_DRIVE_THRU has 2 observations and 2 variables.</div><div class="sasNote" id="sasLogNote714_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_DRIVE_THRU increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote715_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              564.50k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:20 PM</div><div class="sasNote">      Step Count                        165  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_DRIVE_THRU;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_DRIVE_THRU;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote716_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote717_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote718_1594283467627">NOTE: There were 2 observations read from the data set WORK.ENCODING_A_DRIVE_THRU.</div><div class="sasNote" id="sasLogNote719_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_DRIVE_THRU has 2 observations and 2 variables.</div><div class="sasNote" id="sasLogNote720_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              904.75k</div><div class="sasNote">      OS Memory           34328.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:20 PM</div><div class="sasNote">      Step Count                        166  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     145</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        21</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote721_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_DRIVE_THRU_id from </div><div class="sasSource">public.pbo_dictionary_ml as t1 left join public.encoding_A_DRIVE_THRU as t2 on t1.A_DRIVE_THRU = t2.A_DRIVE_THRU ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote722_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 820 rows returned.</div><div class="sasNote" id="sasLogNote723_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote724_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.20 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              84.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:21 PM</div><div class="sasNote">      Step Count                        167  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">2657  %text_encoding(public.pbo_dictionary_ml, A_WINDOW_TYPE)</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote725_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_A_WINDOW_TYPE" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote726_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013559 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote727_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              112.53k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:21 PM</div><div class="sasNote">      Step Count                        168  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote728_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct A_WINDOW_TYPE from </div><div class="sasSource">public.pbo_dictionary_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote729_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 7 rows returned.</div><div class="sasNote" id="sasLogNote730_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote731_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.28k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:21 PM</div><div class="sasNote">      Step Count                        169  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     5</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote732_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote733_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote734_1594283467627">NOTE: There were 7 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote735_1594283467627">NOTE: The data set WORK.UNIQUE has 7 observations and 1 variables.</div><div class="sasNote" id="sasLogNote736_1594283467627">NOTE: Compressing data set WORK.UNIQUE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote737_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.07 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              536.71k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:21 PM</div><div class="sasNote">      Step Count                        170  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     16</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        31</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_A_WINDOW_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   A_WINDOW_TYPE_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote738_1594283467627">NOTE: There were 7 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote739_1594283467627">NOTE: The data set WORK.ENCODING_A_WINDOW_TYPE has 7 observations and 2 variables.</div><div class="sasNote" id="sasLogNote740_1594283467627">NOTE: Compressing data set WORK.ENCODING_A_WINDOW_TYPE increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote741_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              564.46k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:21 PM</div><div class="sasNote">      Step Count                        171  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     14</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_A_WINDOW_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_A_WINDOW_TYPE;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote742_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote743_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote744_1594283467627">NOTE: There were 7 observations read from the data set WORK.ENCODING_A_WINDOW_TYPE.</div><div class="sasNote" id="sasLogNote745_1594283467627">NOTE: The data set PUBLIC.ENCODING_A_WINDOW_TYPE has 7 observations and 2 variables.</div><div class="sasNote" id="sasLogNote746_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              904.90k</div><div class="sasNote">      OS Memory           34328.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:21 PM</div><div class="sasNote">      Step Count                        172  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     145</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        21</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote747_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.pbo_dictionary_ml{options replace=true} as select t1.*, t2.A_WINDOW_TYPE_id </div><div class="sasSource">from public.pbo_dictionary_ml as t1 left join public.encoding_A_WINDOW_TYPE as t2 on t1.A_WINDOW_TYPE = t2.A_WINDOW_TYPE ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote748_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table PBO_DICTIONARY_ML was created in caslib PUBLIC with 820 rows returned.</div><div class="sasNote" id="sasLogNote749_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote750_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.16 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              85.28k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:13:21 PM</div><div class="sasNote">      Step Count                        173  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        19</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2658  </div><div class="sasSource">2659  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote751_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2660  create table public.abt12_ml{options replace=true} as</div><div class="sasSource">2661  select</div><div class="sasSource">2662  t1.PBO_LOCATION_ID,</div><div class="sasSource">2663  t1.PRODUCT_ID,</div><div class="sasSource">2664  t1.CHANNEL_CD,</div><div class="sasSource">2665  t1.SALES_DT,</div><div class="sasSource">2666  t1.sum_qty,</div><div class="sasSource">2667  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2668  t1.lag_halfyear_avg,</div><div class="sasSource">2669  t1.lag_halfyear_med,</div><div class="sasSource">2670  t1.lag_month_avg,</div><div class="sasSource">2671  t1.lag_month_med,</div><div class="sasSource">2672  t1.lag_qtr_avg,</div><div class="sasSource">2673  t1.lag_qtr_med,</div><div class="sasSource">2674  t1.lag_week_avg,</div><div class="sasSource">2675  t1.lag_week_med,</div><div class="sasSource">2676  t1.lag_year_avg,</div><div class="sasSource">2677  t1.lag_year_med,</div><div class="sasSource">2678  t1.lag_halfyear_std,</div><div class="sasSource">2679  t1.lag_month_std,</div><div class="sasSource">2680  t1.lag_qtr_std,</div><div class="sasSource">2681  t1.lag_week_std,</div><div class="sasSource">2682  t1.lag_year_std,</div><div class="sasSource">2683  t1.lag_halfyear_pct10,</div><div class="sasSource">2684  t1.lag_halfyear_pct90,</div><div class="sasSource">2685  t1.lag_month_pct10,</div><div class="sasSource">2686  t1.lag_month_pct90,</div><div class="sasSource">2687  t1.lag_qtr_pct10,</div><div class="sasSource">2688  t1.lag_qtr_pct90,</div><div class="sasSource">2689  t1.lag_week_pct10,</div><div class="sasSource">2690  t1.lag_week_pct90,</div><div class="sasSource">2691  t1.lag_year_pct10,</div><div class="sasSource">2692  t1.lag_year_pct90,</div><div class="sasSource">2693  t1.other_promo,</div><div class="sasSource">2694  t1.support,</div><div class="sasSource">2695  t1.bogo,</div><div class="sasSource">2696  t1.discount,</div><div class="sasSource">2697  t1.evm_set,</div><div class="sasSource">2698  t1.non_product_gift,</div><div class="sasSource">2699  t1.pairs,</div><div class="sasSource">2700  t1.product_gift,</div><div class="sasSource">2701   t1.side_promo_flag,</div><div class="sasSource">2702  t1.A_CPI,</div><div class="sasSource">2703  t1.A_GPD,</div><div class="sasSource">2704  t1.A_RDI,</div><div class="sasSource">2705  t1.TEMPERATURE,</div><div class="sasSource">2706  t1.PRECIPITATION,</div><div class="sasSource">2707  t1.comp_trp_BK,</div><div class="sasSource">2708  t1.comp_trp_KFC,</div><div class="sasSource">2709  t1.sum_trp,</div><div class="sasSource">2710  t1.prod_lvl4_id,</div><div class="sasSource">2711  t1.prod_lvl3_id,</div><div class="sasSource">2712  t1.prod_lvl2_id,</div><div class="sasSource">2713  t1.hero,</div><div class="sasSource">2714  t1.item_size,</div><div class="sasSource">2715  t1.offer_type,</div><div class="sasSource">2716  t1.price_tier,</div><div class="sasSource">2717  t2.lvl3_id,</div><div class="sasSource">2718  t2.lvl2_id,</div><div class="sasSource">2719  t2.A_AGREEMENT_TYPE_id as agreement_type,</div><div class="sasSource">2720  t2.A_BREAKFAST_id as breakfast,</div><div class="sasSource">2721  t2.A_BUILDING_TYPE_id as building_type,</div><div class="sasSource">2722  t2.A_COMPANY_id as company,</div><div class="sasSource">2723  t2.A_DELIVERY_id as delivery,</div><div class="sasSource">2724  t2.A_DRIVE_THRU_id as drive_thru,</div><div class="sasSource">2725  t2.A_MCCAFE_TYPE_id as mccafe_type,</div><div class="sasSource">2726  t2.A_PRICE_LEVEL_id as price_level,</div><div class="sasSource">2727  t2.A_WINDOW_TYPE_id as window_type</div><div class="sasSource">2728  from</div><div class="sasSource">2729  public.abt11_ml as t1</div><div class="sasSource">2730  left join</div><div class="sasSource">2731  public.pbo_dictionary_ml as t2</div><div class="sasSource">2732  on</div><div class="sasSource">2733  t1.pbo_location_id = t2.pbo_location_id</div><div class="sasSource">2734  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote752_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT12_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote753_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2735  quit;</div><div class="sasNote" id="sasLogNote754_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           2:05.47</div><div class="sasNote">      user cpu time       0.05 seconds</div><div class="sasNote">      system cpu time     0.03 seconds</div><div class="sasNote">      memory              284.37k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:15:27 PM</div><div class="sasNote">      Step Count                        174  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     58</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        681</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           56</div><div class="sasNote">      </div><div class="sasSource">2736  </div><div class="sasSource">2737  proc casutil;</div><div class="sasNote" id="sasLogNote755_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2738    droptable casdata='ia_pbo_location' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote756_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.008835 seconds.</div><div class="sasSource">2739    droptable casdata='IA_PBO_LOC_HIERARCHY' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote757_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010413 seconds.</div><div class="sasSource">2740    droptable casdata='IA_PBO_LOC_ATTRIBUTES' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote758_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.011431 seconds.</div><div class="sasSource">2741    droptable casdata='pbo_hier_flat' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote759_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.023616 seconds.</div><div class="sasSource">2742    droptable casdata='attr_transposed' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote760_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.010686 seconds.</div><div class="sasSource">2743    droptable casdata='pbo_dictionary_ml' incaslib='public' quiet;</div><div class="sasNote" id="sasLogNote761_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.012857 seconds.</div><div class="sasSource">2744  /*   promote casdata="abt12_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">2745  run;</div><div class="sasSource">2746  </div><div class="sasSource">2747  </div><div class="sasSource">2748  /****** 13. Добавляем календарные признаки *******/</div><div class="sasNote" id="sasLogNote762_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.11 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              116.40k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:15:27 PM</div><div class="sasNote">      Step Count                        175  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        24</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2749  proc casutil;</div><div class="sasNote" id="sasLogNote763_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2750    droptable casdata="abt13_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote764_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.014561 seconds.</div><div class="sasSource">2751  run;</div><div class="sasSource">2752  </div><div class="sasSource">2753  %let first_date = '01jan2017'd;</div><div class="sasSource">2754  %let last_date = '31dec2021'd;</div><div class="sasSource">2755  </div><div class="sasNote" id="sasLogNote765_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.50k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:15:27 PM</div><div class="sasNote">      Step Count                        176  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2756  data work.cldr_prep;</div><div class="sasSource">2757  retain date &amp;first_date;</div><div class="sasSource">2758  do while(date &lt;= &amp;last_date);</div><div class="sasSource">2759  output;</div><div class="sasSource">2760  date + 1;</div><div class="sasSource">2761  end;</div><div class="sasSource">2762  format date ddmmyy10.;</div><div class="sasSource">2763  run;</div><div class="sasNote" id="sasLogNote766_1594283467627">NOTE: Compression was disabled for data set WORK.CLDR_PREP because compression overhead would increase the size of the data set.</div><div class="sasNote" id="sasLogNote767_1594283467627">NOTE: The data set WORK.CLDR_PREP has 1826 observations and 1 variables.</div><div class="sasNote" id="sasLogNote768_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              402.56k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:15:27 PM</div><div class="sasNote">      Step Count                        177  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     18</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           136</div><div class="sasNote">      </div><div class="sasSource">2764  </div><div class="sasSource">2765  proc sql;</div><div class="sasSource">2766  create table work.cldr_prep_features as</div><div class="sasSource">2767  select</div><div class="sasSource">2768  date,</div><div class="sasSource">2769  week(date) as week,</div><div class="sasSource">2770  weekday(date) as weekday,</div><div class="sasSource">2771  month(date) as month,</div><div class="sasSource">2772  (case</div><div class="sasSource">2773  when weekday(date) in (1, 7) then 1</div><div class="sasSource">2774  else 0</div><div class="sasSource">2775  end) as weekend_flag</div><div class="sasSource">2776  from</div><div class="sasSource">2777  work.cldr_prep</div><div class="sasSource">2778  ;</div><div class="sasNote" id="sasLogNote769_1594283467627">NOTE: Compressing data set WORK.CLDR_PREP_FEATURES increased size by 50.00 percent. </div><div class="sasNote">      Compressed is 3 pages; un-compressed would require 2 pages.</div><div class="sasNote" id="sasLogNote770_1594283467627">NOTE: Table WORK.CLDR_PREP_FEATURES created, with 1826 rows and 5 columns.</div><div class="sasSource">2779  quit;</div><div class="sasNote" id="sasLogNote771_1594283467627">NOTE: PROCEDURE SQL used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              5392.59k</div><div class="sasNote">      OS Memory           38936.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:15:27 PM</div><div class="sasNote">      Step Count                        178  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     193</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           400</div><div class="sasNote">      </div><div class="sasSource">2780  </div><div class="sasSource">2781  /* Список выходных дней в РФ с 2017 по 2021 */</div><div class="sasSource">2782  data work.russia_weekend;</div><div class="sasSource">2783  input date :yymmdd10.;</div><div class="sasSource">2784  format date yymmddd10.;</div><div class="sasSource">2785  datalines;</div><div class="sasNote" id="sasLogNote772_1594283467627">NOTE: Compression was disabled for data set WORK.RUSSIA_WEEKEND because compression overhead would increase the size of the data </div><div class="sasNote">      set.</div><div class="sasNote" id="sasLogNote773_1594283467627">NOTE: The data set WORK.RUSSIA_WEEKEND has 70 observations and 1 variables.</div><div class="sasNote" id="sasLogNote774_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              406.62k</div><div class="sasNote">      OS Memory           33812.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:15:27 PM</div><div class="sasNote">      Step Count                        179  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     30</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           144</div><div class="sasNote">      </div><div class="sasSource">2856  ;</div><div class="sasSource">2857  run;</div><div class="sasSource">2858  </div><div class="sasSource">2859  /* Объединяем государственные выходные с субботой и воскресеньем */</div><div class="sasSource">2860  proc sql;</div><div class="sasSource">2861  create table work.cldr_prep_features2 as</div><div class="sasSource">2862  select</div><div class="sasSource">2863  t1.date,</div><div class="sasSource">2864  t1.week,</div><div class="sasSource">2865  t1.weekday,</div><div class="sasSource">2866  t1.month,</div><div class="sasSource">2867  case</div><div class="sasSource">2868  when t2.date is not missing then 1</div><div class="sasSource">2869  else t1.weekend_flag</div><div class="sasSource">2870  end as weekend_flag</div><div class="sasSource">2871  from</div><div class="sasSource">2872  work.cldr_prep_features as t1</div><div class="sasSource">2873  left join</div><div class="sasSource">2874  work.russia_weekend as t2</div><div class="sasSource">2875  on</div><div class="sasSource">2876  t1.date = t2.date</div><div class="sasSource">2877  ;</div><div class="sasNote" id="sasLogNote775_1594283467627">NOTE: Compressing data set WORK.CLDR_PREP_FEATURES2 increased size by 50.00 percent. </div><div class="sasNote">      Compressed is 3 pages; un-compressed would require 2 pages.</div><div class="sasNote" id="sasLogNote776_1594283467627">NOTE: Table WORK.CLDR_PREP_FEATURES2 created, with 1826 rows and 5 columns.</div><div class="sasSource">2878  quit;</div><div class="sasNote" id="sasLogNote777_1594283467627">NOTE: PROCEDURE SQL used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              5592.40k</div><div class="sasNote">      OS Memory           38936.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:15:27 PM</div><div class="sasNote">      Step Count                        180  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     343</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           808</div><div class="sasNote">      </div><div class="sasSource">2879  </div><div class="sasSource">2880  proc casutil;</div><div class="sasNote" id="sasLogNote778_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2881    load data=work.cldr_prep_features2 casout='cldr_prep_features' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote779_1594283467627">NOTE: WORK.CLDR_PREP_FEATURES2 was successfully added to the "Public" caslib as "CLDR_PREP_FEATURES".</div><div class="sasSource">2882  run;</div><div class="sasSource">2883  </div><div class="sasSource">2884  /* Добавляем к витрине */</div><div class="sasNote" id="sasLogNote780_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              1053.00k</div><div class="sasNote">      OS Memory           35096.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:15:27 PM</div><div class="sasNote">      Step Count                        181  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     46</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        18</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2885  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote781_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">2886  create table public.abt13_ml{options replace = true} as</div><div class="sasSource">2887  select</div><div class="sasSource">2888  t1.PBO_LOCATION_ID,</div><div class="sasSource">2889  t1.PRODUCT_ID,</div><div class="sasSource">2890  t1.CHANNEL_CD,</div><div class="sasSource">2891  t1.SALES_DT,</div><div class="sasSource">2892  t1.sum_qty,</div><div class="sasSource">2893  t1.GROSS_PRICE_AMT,</div><div class="sasSource">2894  t1.lag_halfyear_avg,</div><div class="sasSource">2895  t1.lag_halfyear_med,</div><div class="sasSource">2896  t1.lag_month_avg,</div><div class="sasSource">2897  t1.lag_month_med,</div><div class="sasSource">2898  t1.lag_qtr_avg,</div><div class="sasSource">2899  t1.lag_qtr_med,</div><div class="sasSource">2900  t1.lag_week_avg,</div><div class="sasSource">2901  t1.lag_week_med,</div><div class="sasSource">2902  t1.lag_year_avg,</div><div class="sasSource">2903  t1.lag_year_med,</div><div class="sasSource">2904  t1.lag_halfyear_std,</div><div class="sasSource">2905  t1.lag_month_std,</div><div class="sasSource">2906  t1.lag_qtr_std,</div><div class="sasSource">2907  t1.lag_week_std,</div><div class="sasSource">2908  t1.lag_year_std,</div><div class="sasSource">2909  t1.lag_halfyear_pct10,</div><div class="sasSource">2910  t1.lag_halfyear_pct90,</div><div class="sasSource">2911  t1.lag_month_pct10,</div><div class="sasSource">2912  t1.lag_month_pct90,</div><div class="sasSource">2913  t1.lag_qtr_pct10,</div><div class="sasSource">2914  t1.lag_qtr_pct90,</div><div class="sasSource">2915  t1.lag_week_pct10,</div><div class="sasSource">2916  t1.lag_week_pct90,</div><div class="sasSource">2917  t1.lag_year_pct10,</div><div class="sasSource">2918  t1.lag_year_pct90,</div><div class="sasSource">2919  t1.other_promo,</div><div class="sasSource">2920  t1.support,</div><div class="sasSource">2921  t1.bogo,</div><div class="sasSource">2922  t1.discount,</div><div class="sasSource">2923  t1.evm_set,</div><div class="sasSource">2924  t1.non_product_gift,</div><div class="sasSource">2925  t1.pairs,</div><div class="sasSource">2926  t1.product_gift,</div><div class="sasSource">2927   t1.side_promo_flag,</div><div class="sasSource">2928  t1.A_CPI,</div><div class="sasSource">2929  t1.A_GPD,</div><div class="sasSource">2930  t1.A_RDI,</div><div class="sasSource">2931  t1.TEMPERATURE,</div><div class="sasSource">2932  t1.PRECIPITATION,</div><div class="sasSource">2933  t1.comp_trp_BK,</div><div class="sasSource">2934  t1.comp_trp_KFC,</div><div class="sasSource">2935  t1.sum_trp,</div><div class="sasSource">2936  t1.prod_lvl4_id,</div><div class="sasSource">2937  t1.prod_lvl3_id,</div><div class="sasSource">2938  t1.prod_lvl2_id,</div><div class="sasSource">2939  t1.hero,</div><div class="sasSource">2940  t1.item_size,</div><div class="sasSource">2941  t1.offer_type,</div><div class="sasSource">2942  t1.price_tier,</div><div class="sasSource">2943  t1.lvl3_id,</div><div class="sasSource">2944  t1.lvl2_id,</div><div class="sasSource">2945  t1.agreement_type,</div><div class="sasSource">2946  t1.breakfast,</div><div class="sasSource">2947  t1.building_type,</div><div class="sasSource">2948  t1.company,</div><div class="sasSource">2949  t1.delivery,</div><div class="sasSource">2950  t1.drive_thru,</div><div class="sasSource">2951  t1.mccafe_type,</div><div class="sasSource">2952  t1.price_level,</div><div class="sasSource">2953  t1.window_type,</div><div class="sasSource">2954  t2.week,</div><div class="sasSource">2955  t2.weekday,</div><div class="sasSource">2956  t2.month,</div><div class="sasSource">2957  t2.weekend_flag</div><div class="sasSource">2958  from</div><div class="sasSource">2959  public.abt12_ml as t1</div><div class="sasSource">2960  left join</div><div class="sasSource">2961  public.cldr_prep_features as t2</div><div class="sasSource">2962  on</div><div class="sasSource">2963  t1.sales_dt = t2.date</div><div class="sasSource">2964  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote782_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT13_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote783_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">2965  quit;</div><div class="sasNote" id="sasLogNote784_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           2:21.60</div><div class="sasNote">      user cpu time       0.06 seconds</div><div class="sasNote">      system cpu time     0.02 seconds</div><div class="sasNote">      memory              251.18k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:17:48 PM</div><div class="sasNote">      Step Count                        182  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     935</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        759</div><div class="sasNote">      Involuntary Context Switches      4</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           64</div><div class="sasNote">      </div><div class="sasSource">2966  </div><div class="sasSource">2967  </div><div class="sasSource">2968  /******  14. Добавим события ******/</div><div class="sasSource">2969  proc casutil;</div><div class="sasNote" id="sasLogNote785_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">2970  </div><div class="sasSource">2970!  droptable casdata="russia_event" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote786_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013638 seconds.</div><div class="sasSource">2971  </div><div class="sasSource">2971!  droptable casdata="russia_event2" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote787_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013281 seconds.</div><div class="sasSource">2972  </div><div class="sasSource">2972!  droptable casdata="russia_event_t" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote788_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013067 seconds.</div><div class="sasSource">2973  </div><div class="sasSource">2973!  droptable casdata="abt14_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote789_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013458 seconds.</div><div class="sasSource">2974  run;</div><div class="sasSource">2975  </div><div class="sasNote" id="sasLogNote790_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.08 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              115.40k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:17:48 PM</div><div class="sasNote">      Step Count                        183  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     108</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        16</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">2976  data work.russia_event;</div><div class="sasSource">2977  input date :yymmdd10. event_nm $32.;</div><div class="sasSource">2978  format date yymmddd10.;</div><div class="sasSource">2979  datalines;</div><div class="sasNote" id="sasLogNote791_1594283467627">NOTE: The data set WORK.RUSSIA_EVENT has 132 observations and 2 variables.</div><div class="sasNote" id="sasLogNote792_1594283467627">NOTE: Compressing data set WORK.RUSSIA_EVENT increased size by 100.00 percent. </div><div class="sasNote">      Compressed is 2 pages; un-compressed would require 1 pages.</div><div class="sasNote" id="sasLogNote793_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              408.93k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:17:48 PM</div><div class="sasNote">      Step Count                        184  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     363</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           264</div><div class="sasNote">      </div><div class="sasSource">3112  ;</div><div class="sasSource">3113  run;</div><div class="sasSource">3114  </div><div class="sasSource">3115  /* загружаем таблицу в cas */</div><div class="sasSource">3116  proc casutil;</div><div class="sasNote" id="sasLogNote794_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">3117    load data=work.russia_event casout='russia_event' outcaslib='public' replace;</div><div class="sasNote" id="sasLogNote795_1594283467627">NOTE: WORK.RUSSIA_EVENT was successfully added to the "Public" caslib as "RUSSIA_EVENT".</div><div class="sasSource">3118  run;</div><div class="sasSource">3119  </div><div class="sasSource">3120  /* добваляем константный флаг */</div><div class="sasNote" id="sasLogNote796_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.03 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              968.46k</div><div class="sasNote">      OS Memory           35096.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:17:48 PM</div><div class="sasNote">      Step Count                        185  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     53</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        16</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">3121  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote797_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3122  create table public.russia_event2{options replace=true} as</div><div class="sasSource">3123  select *, 1 as event_flag from public.russia_event;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote798_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table RUSSIA_EVENT2 was created in caslib Public with 132 rows returned.</div><div class="sasNote" id="sasLogNote799_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">3124  quit;</div><div class="sasNote" id="sasLogNote800_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              82.50k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:17:49 PM</div><div class="sasNote">      Step Count                        186  Switch Count  1</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     16</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">3125  </div><div class="sasSource">3126  /* транспонируем таблицу */</div><div class="sasSource">3127  proc cas;</div><div class="sasSource">3128  transpose.transpose /</div><div class="sasSource">3129     table={name="russia_event2", caslib="public", groupby={"date"}}</div><div class="sasSource">3130     attributes={{name="date"}}</div><div class="sasSource">3131     transpose={"event_flag"}</div><div class="sasSource">3132     id={"event_nm"}</div><div class="sasSource">3133     casout={name="russia_event_t", caslib="public", replace=true};</div><div class="sasSource">3134  quit;</div><div class="sasNote" id="sasLogNote801_1594283467627">NOTE: Active Session now CASAUTO.</div><div class="sasNote" id="sasLogNote802_1594283467627">NOTE: There were 132 rows read from the table RUSSIA_EVENT2.</div><div class="sasNote" id="sasLogNote803_1594283467627">NOTE: The table russia_event_t has 132 rows and 11 columns.</div><div class="sasNote" id="sasLogNote804_1594283467627">NOTE: PROCEDURE CAS used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              10244.15k</div><div class="sasNote">      OS Memory           44684.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:17:49 PM</div><div class="sasNote">      Step Count                        187  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     1290</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        11</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">3135  </div><div class="sasSource">3136  /* добавляем к ваитрине */</div><div class="sasSource">3137  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote805_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3138  create table public.abt14_ml{options replace=true} as</div><div class="sasSource">3139  select</div><div class="sasSource">3140  t1.PBO_LOCATION_ID,</div><div class="sasSource">3141  t1.PRODUCT_ID,</div><div class="sasSource">3142  t1.CHANNEL_CD,</div><div class="sasSource">3143  t1.SALES_DT,</div><div class="sasSource">3144  t1.sum_qty,</div><div class="sasSource">3145  t1.GROSS_PRICE_AMT,</div><div class="sasSource">3146  t1.lag_halfyear_avg,</div><div class="sasSource">3147  t1.lag_halfyear_med,</div><div class="sasSource">3148  t1.lag_month_avg,</div><div class="sasSource">3149  t1.lag_month_med,</div><div class="sasSource">3150  t1.lag_qtr_avg,</div><div class="sasSource">3151  t1.lag_qtr_med,</div><div class="sasSource">3152  t1.lag_week_avg,</div><div class="sasSource">3153  t1.lag_week_med,</div><div class="sasSource">3154  t1.lag_year_avg,</div><div class="sasSource">3155  t1.lag_year_med,</div><div class="sasSource">3156  t1.lag_halfyear_std,</div><div class="sasSource">3157  t1.lag_month_std,</div><div class="sasSource">3158  t1.lag_qtr_std,</div><div class="sasSource">3159  t1.lag_week_std,</div><div class="sasSource">3160  t1.lag_year_std,</div><div class="sasSource">3161  t1.lag_halfyear_pct10,</div><div class="sasSource">3162  t1.lag_halfyear_pct90,</div><div class="sasSource">3163  t1.lag_month_pct10,</div><div class="sasSource">3164  t1.lag_month_pct90,</div><div class="sasSource">3165  t1.lag_qtr_pct10,</div><div class="sasSource">3166  t1.lag_qtr_pct90,</div><div class="sasSource">3167  t1.lag_week_pct10,</div><div class="sasSource">3168  t1.lag_week_pct90,</div><div class="sasSource">3169  t1.lag_year_pct10,</div><div class="sasSource">3170  t1.lag_year_pct90,</div><div class="sasSource">3171  t1.other_promo,</div><div class="sasSource">3172  t1.support,</div><div class="sasSource">3173  t1.bogo,</div><div class="sasSource">3174  t1.discount,</div><div class="sasSource">3175  t1.evm_set,</div><div class="sasSource">3176  t1.non_product_gift,</div><div class="sasSource">3177  t1.pairs,</div><div class="sasSource">3178  t1.product_gift,</div><div class="sasSource">3179   t1.side_promo_flag,</div><div class="sasSource">3180  t1.A_CPI,</div><div class="sasSource">3181  t1.A_GPD,</div><div class="sasSource">3182  t1.A_RDI,</div><div class="sasSource">3183  t1.TEMPERATURE,</div><div class="sasSource">3184  t1.PRECIPITATION,</div><div class="sasSource">3185  t1.comp_trp_BK,</div><div class="sasSource">3186  t1.comp_trp_KFC,</div><div class="sasSource">3187  t1.sum_trp,</div><div class="sasSource">3188  t1.prod_lvl4_id,</div><div class="sasSource">3189  t1.prod_lvl3_id,</div><div class="sasSource">3190  t1.prod_lvl2_id,</div><div class="sasSource">3191  t1.hero,</div><div class="sasSource">3192  t1.item_size,</div><div class="sasSource">3193  t1.offer_type,</div><div class="sasSource">3194  t1.price_tier,</div><div class="sasSource">3195  t1.lvl3_id,</div><div class="sasSource">3196  t1.lvl2_id,</div><div class="sasSource">3197  t1.agreement_type,</div><div class="sasSource">3198  t1.breakfast,</div><div class="sasSource">3199  t1.building_type,</div><div class="sasSource">3200  t1.company,</div><div class="sasSource">3201  t1.delivery,</div><div class="sasSource">3202  t1.drive_thru,</div><div class="sasSource">3203  t1.mccafe_type,</div><div class="sasSource">3204  t1.price_level,</div><div class="sasSource">3205  t1.window_type,</div><div class="sasSource">3206  t1.week,</div><div class="sasSource">3207  t1.weekday,</div><div class="sasSource">3208  t1.month,</div><div class="sasSource">3209  t1.weekend_flag,</div><div class="sasSource">3210  coalesce(t2.defender_day, 0) as defender_day,</div><div class="sasSource">3211  coalesce(t2.female_day, 0) as female_day,</div><div class="sasSource">3212  coalesce(t2.may_holiday, 0) as may_holiday,</div><div class="sasSource">3213  coalesce(t2.new_year , 0) as new_year,</div><div class="sasSource">3214  coalesce(t2.russia_day, 0) as russia_day,</div><div class="sasSource">3215  coalesce(t2.school_start, 0) as school_start,</div><div class="sasSource">3216  coalesce(t2.student_day, 0) as student_day,</div><div class="sasSource">3217  coalesce(t2.summer_start, 0) as summer_start,</div><div class="sasSource">3218  coalesce(t2.valentine_day, 0) as valentine_day</div><div class="sasSource">3219  from</div><div class="sasSource">3220  public.abt13_ml as t1</div><div class="sasSource">3221  left join</div><div class="sasSource">3222  public.russia_event_t as t2</div><div class="sasSource">3223  on</div><div class="sasSource">3224  t1.sales_dt = t2.date</div><div class="sasSource">3225  ;</div><div class="sasSource">3225!   </div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote806_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT14_ML was created in caslib Public with 115102277 rows returned.</div><div class="sasNote" id="sasLogNote807_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">3226  quit;</div><div class="sasNote" id="sasLogNote808_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           5:11.41</div><div class="sasNote">      user cpu time       0.15 seconds</div><div class="sasNote">      system cpu time     0.06 seconds</div><div class="sasNote">      memory              288.34k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:23:00 PM</div><div class="sasNote">      Step Count                        188  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     173</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        1654</div><div class="sasNote">      Involuntary Context Switches      3</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           120</div><div class="sasNote">      </div><div class="sasSource">3227  </div><div class="sasSource">3228  proc casutil;</div><div class="sasNote" id="sasLogNote809_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">3229  </div><div class="sasSource">3229!  droptable casdata="russia_event" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote810_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013971 seconds.</div><div class="sasSource">3230  </div><div class="sasSource">3230!  droptable casdata="russia_event2" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote811_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013943 seconds.</div><div class="sasSource">3231  </div><div class="sasSource">3231!  droptable casdata="russia_event_t" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote812_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.014695 seconds.</div><div class="sasSource">3232  /* promote casdata="abt14_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">3233  run;</div><div class="sasSource">3234  </div><div class="sasSource">3235  /******15. Добавим ценовые ранги ******/</div><div class="sasNote" id="sasLogNote813_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.08 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              116.09k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:23:00 PM</div><div class="sasNote">      Step Count                        189  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        12</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">3236  proc casutil;</div><div class="sasNote" id="sasLogNote814_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">3237  </div><div class="sasSource">3237!  droptable casdata="abt15_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote815_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.017096 seconds.</div><div class="sasSource">3238  </div><div class="sasSource">3238!  droptable casdata="unique_day_price" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote816_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.01991 seconds.</div><div class="sasSource">3239  </div><div class="sasSource">3239!  droptable casdata="sum_count_price" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote817_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.019539 seconds.</div><div class="sasSource">3240  </div><div class="sasSource">3240!  droptable casdata="price_rank" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote818_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.018722 seconds.</div><div class="sasSource">3241  </div><div class="sasSource">3241!  droptable casdata="price_rank2" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote819_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.017062 seconds.</div><div class="sasSource">3242  run;</div><div class="sasSource">3243  </div><div class="sasSource">3244  /* уникальные ПБО/день/категория товаров/товар/цена */</div><div class="sasNote" id="sasLogNote820_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.13 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              116.53k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:23:00 PM</div><div class="sasNote">      Step Count                        190  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">3245  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote821_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3246  create table public.unique_day_price as</div><div class="sasSource">3247  select distinct</div><div class="sasSource">3248  t1.pbo_location_id,</div><div class="sasSource">3249  t1.PROD_LVL3_ID,</div><div class="sasSource">3250  t1.sales_dt,</div><div class="sasSource">3251  t1.product_id,</div><div class="sasSource">3252  t1.GROSS_PRICE_AMT</div><div class="sasSource">3253  from</div><div class="sasSource">3254  public.abt11_ml as t1</div><div class="sasSource">3255  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote822_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table UNIQUE_DAY_PRICE was created in caslib Public with 83425301 rows returned.</div><div class="sasNote" id="sasLogNote823_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">3256  quit;</div><div class="sasNote" id="sasLogNote824_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           3:07.04</div><div class="sasNote">      user cpu time       0.08 seconds</div><div class="sasNote">      system cpu time     0.03 seconds</div><div class="sasNote">      memory              248.18k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:26:07 PM</div><div class="sasNote">      Step Count                        191  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     65</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        999</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           72</div><div class="sasNote">      </div><div class="sasSource">3257  </div><div class="sasSource">3258  /* Считаем суммарную цену в групе и количество товаров */</div><div class="sasSource">3259  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote825_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3260  create table public.sum_count_price{options replace = true} as</div><div class="sasSource">3261  select</div><div class="sasSource">3262  t1.pbo_location_id,</div><div class="sasSource">3263  t1.PROD_LVL3_ID,</div><div class="sasSource">3264  t1.sales_dt,</div><div class="sasSource">3265  count(t1.product_id) as count_product,</div><div class="sasSource">3266  sum(t1.GROSS_PRICE_AMT) as sum_gross_price_amt</div><div class="sasSource">3267  from public.unique_day_price as t1</div><div class="sasSource">3268  group by</div><div class="sasSource">3269  t1.pbo_location_id,</div><div class="sasSource">3270  t1.PROD_LVL3_ID,</div><div class="sasSource">3271  t1.sales_dt</div><div class="sasSource">3272  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote826_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table SUM_COUNT_PRICE was created in caslib Public with 10749990 rows returned.</div><div class="sasNote" id="sasLogNote827_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">3273  quit;</div><div class="sasNote" id="sasLogNote828_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           51.20 seconds</div><div class="sasNote">      user cpu time       0.03 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              223.90k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:26:59 PM</div><div class="sasNote">      Step Count                        192  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     27</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        294</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           32</div><div class="sasNote">      </div><div class="sasSource">3274  </div><div class="sasSource">3275  /* считаем позицию товара в отсортированном списке цен */</div><div class="sasSource">3276  data public.price_rank;</div><div class="sasSource">3277  set public.unique_day_price;</div><div class="sasSource">3278  by pbo_location_id sales_dt PROD_LVL3_ID GROSS_PRICE_AMT ;</div><div class="sasSource">3279  if first.PROD_LVL3_ID then i = 0;</div><div class="sasSource">3280  if GROSS_PRICE_AMT ^= lag(GROSS_PRICE_AMT) then i+1;</div><div class="sasSource">3281  run;</div><div class="sasNote" id="sasLogNote829_1594283467627">NOTE: Running DATA step in Cloud Analytic Services.</div><div class="sasNote" id="sasLogNote830_1594283467627">NOTE: The DATA step will run in multiple threads.</div><div class="sasNote" id="sasLogNote831_1594283467627">NOTE: There were 83425301 observations read from the table UNIQUE_DAY_PRICE in caslib Public.</div><div class="sasNote" id="sasLogNote832_1594283467627">NOTE: The table price_rank in caslib Public has 83425301 observations and 6 variables.</div><div class="sasNote" id="sasLogNote833_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           1:00.73</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.02 seconds</div><div class="sasNote">      memory              1417.34k</div><div class="sasNote">      OS Memory           35608.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:27:59 PM</div><div class="sasNote">      Step Count                        193  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     114</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        389</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">3282  </div><div class="sasSource">3283  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote834_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3284  create table public.price_rank2 as</div><div class="sasSource">3285  select</div><div class="sasSource">3286  t1.pbo_location_id,</div><div class="sasSource">3287  t1.sales_dt,</div><div class="sasSource">3288  t1.PROD_LVL3_ID,</div><div class="sasSource">3289  max(t1.i) as max_i</div><div class="sasSource">3290  from</div><div class="sasSource">3291  public.price_rank as t1</div><div class="sasSource">3292  group by</div><div class="sasSource">3293  t1.pbo_location_id,</div><div class="sasSource">3294  t1.sales_dt,</div><div class="sasSource">3295  t1.PROD_LVL3_ID</div><div class="sasSource">3296  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote835_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table PRICE_RANK2 was created in caslib Public with 10749990 rows returned.</div><div class="sasNote" id="sasLogNote836_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">3297  quit;</div><div class="sasNote" id="sasLogNote837_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           39.05 seconds</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              226.15k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:28:38 PM</div><div class="sasNote">      Step Count                        194  Switch Count  3</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     18</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        229</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">3298  </div><div class="sasSource">3299  /* Добавляем в витрину */</div><div class="sasSource">3300  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote838_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3301  create table public.abt15_ml {options replace=true} as</div><div class="sasSource">3302  select</div><div class="sasSource">3303  t1.PBO_LOCATION_ID,</div><div class="sasSource">3304  t1.PRODUCT_ID,</div><div class="sasSource">3305  t1.CHANNEL_CD,</div><div class="sasSource">3306  t1.SALES_DT,</div><div class="sasSource">3307  t1.sum_qty,</div><div class="sasSource">3308  t1.GROSS_PRICE_AMT,</div><div class="sasSource">3309  t1.lag_halfyear_avg,</div><div class="sasSource">3310  t1.lag_halfyear_med,</div><div class="sasSource">3311  t1.lag_month_avg,</div><div class="sasSource">3312  t1.lag_month_med,</div><div class="sasSource">3313  t1.lag_qtr_avg,</div><div class="sasSource">3314  t1.lag_qtr_med,</div><div class="sasSource">3315  t1.lag_week_avg,</div><div class="sasSource">3316  t1.lag_week_med,</div><div class="sasSource">3317  t1.lag_year_avg,</div><div class="sasSource">3318  t1.lag_year_med,</div><div class="sasSource">3319  t1.lag_halfyear_std,</div><div class="sasSource">3320  t1.lag_month_std,</div><div class="sasSource">3321  t1.lag_qtr_std,</div><div class="sasSource">3322  t1.lag_week_std,</div><div class="sasSource">3323  t1.lag_year_std,</div><div class="sasSource">3324  t1.lag_halfyear_pct10,</div><div class="sasSource">3325  t1.lag_halfyear_pct90,</div><div class="sasSource">3326  t1.lag_month_pct10,</div><div class="sasSource">3327  t1.lag_month_pct90,</div><div class="sasSource">3328  t1.lag_qtr_pct10,</div><div class="sasSource">3329  t1.lag_qtr_pct90,</div><div class="sasSource">3330  t1.lag_week_pct10,</div><div class="sasSource">3331  t1.lag_week_pct90,</div><div class="sasSource">3332  t1.lag_year_pct10,</div><div class="sasSource">3333  t1.lag_year_pct90,</div><div class="sasSource">3334  t1.other_promo,</div><div class="sasSource">3335  t1.support,</div><div class="sasSource">3336  t1.bogo,</div><div class="sasSource">3337  t1.discount,</div><div class="sasSource">3338  t1.evm_set,</div><div class="sasSource">3339  t1.non_product_gift,</div><div class="sasSource">3340  t1.pairs,</div><div class="sasSource">3341  t1.product_gift,</div><div class="sasSource">3342   t1.side_promo_flag,</div><div class="sasSource">3343  t1.A_CPI,</div><div class="sasSource">3344  t1.A_GPD,</div><div class="sasSource">3345  t1.A_RDI,</div><div class="sasSource">3346  t1.TEMPERATURE,</div><div class="sasSource">3347  t1.PRECIPITATION,</div><div class="sasSource">3348  t1.comp_trp_BK,</div><div class="sasSource">3349  t1.comp_trp_KFC,</div><div class="sasSource">3350  t1.sum_trp,</div><div class="sasSource">3351  t1.prod_lvl4_id,</div><div class="sasSource">3352  t1.prod_lvl3_id,</div><div class="sasSource">3353  t1.prod_lvl2_id,</div><div class="sasSource">3354  t1.hero,</div><div class="sasSource">3355  t1.item_size,</div><div class="sasSource">3356  t1.offer_type,</div><div class="sasSource">3357  t1.price_tier,</div><div class="sasSource">3358  t1.lvl3_id,</div><div class="sasSource">3359  t1.lvl2_id,</div><div class="sasSource">3360  t1.agreement_type,</div><div class="sasSource">3361  t1.breakfast,</div><div class="sasSource">3362  t1.building_type,</div><div class="sasSource">3363  t1.company,</div><div class="sasSource">3364  t1.delivery,</div><div class="sasSource">3365  t1.drive_thru,</div><div class="sasSource">3366  t1.mccafe_type,</div><div class="sasSource">3367  t1.price_level,</div><div class="sasSource">3368  t1.window_type,</div><div class="sasSource">3369  t1.week,</div><div class="sasSource">3370  t1.weekday,</div><div class="sasSource">3371  t1.month,</div><div class="sasSource">3372  t1.weekend_flag,</div><div class="sasSource">3373  t1.defender_day,</div><div class="sasSource">3374  t1.female_day,</div><div class="sasSource">3375  t1.may_holiday,</div><div class="sasSource">3376  t1.new_year,</div><div class="sasSource">3377  t1.russia_day,</div><div class="sasSource">3378  t1.school_start,</div><div class="sasSource">3379  t1.student_day,</div><div class="sasSource">3380  t1.summer_start,</div><div class="sasSource">3381  t1.valentine_day,</div><div class="sasSource">3382  divide(t3.i,t4.max_i) as price_rank,</div><div class="sasSource">3383  (case</div><div class="sasSource">3384  when t2.sum_gross_price_amt = t1.GROSS_PRICE_AMT then 1</div><div class="sasSource">3385  else divide(t1.GROSS_PRICE_AMT,divide((t2.sum_gross_price_amt - t1.GROSS_PRICE_AMT),(t2.count_product - 1)))</div><div class="sasSource">3386  end) as price_index</div><div class="sasSource">3387  from</div><div class="sasSource">3388  public.abt14_ml as t1</div><div class="sasSource">3389  left join</div><div class="sasSource">3390  public.sum_count_price as t2</div><div class="sasSource">3391  on</div><div class="sasSource">3392  t1.pbo_location_id = t2.pbo_location_id and</div><div class="sasSource">3393  t1.PROD_LVL3_ID = t2.PROD_LVL3_ID and</div><div class="sasSource">3394  t1.sales_dt = t2.sales_dt</div><div class="sasSource">3395  left join</div><div class="sasSource">3396  public.price_rank as t3</div><div class="sasSource">3397  on</div><div class="sasSource">3398  t1.pbo_location_id = t3.pbo_location_id and</div><div class="sasSource">3399  t1.product_id = t3.product_id and</div><div class="sasSource">3400  t1.sales_dt = t3.sales_dt</div><div class="sasSource">3401  left join</div><div class="sasSource">3402  public.price_rank2 as t4</div><div class="sasSource">3403  on</div><div class="sasSource">3404  t1.pbo_location_id = t4.pbo_location_id and</div><div class="sasSource">3405  t1.PROD_LVL3_ID = t4.PROD_LVL3_ID and</div><div class="sasSource">3406  t1.sales_dt = t4.sales_dt</div><div class="sasSource">3407  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote839_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT15_ML was created in caslib Public with 115438585 rows returned.</div><div class="sasNote" id="sasLogNote840_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">3408  quit;</div><div class="sasNote" id="sasLogNote841_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           21:44.17</div><div class="sasNote">      user cpu time       0.57 seconds</div><div class="sasNote">      system cpu time     0.24 seconds</div><div class="sasNote">      memory              290.56k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:50:23 PM</div><div class="sasNote">      Step Count                        195  Switch Count  5</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     569</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        6867</div><div class="sasNote">      Involuntary Context Switches      6</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           456</div><div class="sasNote">      </div><div class="sasSource">3409  </div><div class="sasSource">3410  proc casutil;</div><div class="sasNote" id="sasLogNote842_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">3411  </div><div class="sasSource">3411!  droptable casdata="unique_day_price" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote843_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.669813 seconds.</div><div class="sasSource">3412  </div><div class="sasSource">3412!  droptable casdata="sum_count_price" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote844_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.083286 seconds.</div><div class="sasSource">3413  </div><div class="sasSource">3413!  droptable casdata="price_rank" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote845_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.74148 seconds.</div><div class="sasSource">3414  </div><div class="sasSource">3414!  droptable casdata="price_rank2" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote846_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.107167 seconds.</div><div class="sasSource">3415  /* promote casdata="abt15_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">3416  run;</div><div class="sasSource">3417  </div><div class="sasSource">3418  /******16. Перекодируем channel_cd  ******/</div><div class="sasNote" id="sasLogNote847_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           1.63 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              116.15k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:50:24 PM</div><div class="sasNote">      Step Count                        196  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        22</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">3419  proc casutil;</div><div class="sasNote" id="sasLogNote848_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">3420  </div><div class="sasSource">3420!  droptable casdata="abt16_ml" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote849_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.015235 seconds.</div><div class="sasSource">3421  run;</div><div class="sasSource">3422  </div><div class="sasSource">3423  %text_encoding(public.abt15_ml, channel_cd)</div><div class="sasNote" id="sasLogNote850_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              120.56k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:50:24 PM</div><div class="sasNote">      Step Count                        197  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     45</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        4</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           8</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote851_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   droptable casdata="encoding_channel_cd" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote852_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.015453 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote853_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.02 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              113.75k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:50:24 PM</div><div class="sasNote">      Step Count                        198  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     7</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        5</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote854_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref=casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.unique{options replace=true} as select distinct channel_cd from public.abt15_ml ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote855_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: Table UNIQUE was created in caslib Public with 4 rows returned.</div><div class="sasNote" id="sasLogNote856_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote857_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           1:15.82</div><div class="sasNote">      user cpu time       0.02 seconds</div><div class="sasNote">      system cpu time     0.01 seconds</div><div class="sasNote">      memory              222.25k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:51:40 PM</div><div class="sasNote">      Step Count                        199  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     25</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        411</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           24</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set public.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote858_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote859_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote860_1594283467627">NOTE: Compression was disabled for data set WORK.UNIQUE because compression overhead would increase the size of the data set.</div><div class="sasNote" id="sasLogNote861_1594283467627">NOTE: There were 4 observations read from the data set PUBLIC.UNIQUE.</div><div class="sasNote" id="sasLogNote862_1594283467627">NOTE: The data set WORK.UNIQUE has 4 observations and 1 variables.</div><div class="sasNote" id="sasLogNote863_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.06 seconds</div><div class="sasNote">      user cpu time       0.01 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              492.84k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:51:40 PM</div><div class="sasNote">      Step Count                        200  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     30</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        32</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           136</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data work.encoding_channel_cd;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.unique;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   channel_cd_id = _N_;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote864_1594283467627">NOTE: Compression was disabled for data set WORK.ENCODING_CHANNEL_CD because compression overhead would increase the size of the </div><div class="sasNote">      data set.</div><div class="sasNote" id="sasLogNote865_1594283467627">NOTE: There were 4 observations read from the data set WORK.UNIQUE.</div><div class="sasNote" id="sasLogNote866_1594283467627">NOTE: The data set WORK.ENCODING_CHANNEL_CD has 4 observations and 2 variables.</div><div class="sasNote" id="sasLogNote867_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              562.37k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:51:40 PM</div><div class="sasNote">      Step Count                        201  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     49</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           144</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   data public.encoding_channel_cd;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   set work.encoding_channel_cd;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasNote" id="sasLogNote868_1594283467627">NOTE: To run DATA step in Cloud Analytic Services a CAS engine libref must be used with all data sets and all librefs in the </div><div class="sasNote">      program must refer to the same session.</div><div class="sasNote" id="sasLogNote869_1594283467627">NOTE: Could not execute DATA step code in Cloud Analytic Services. Running DATA step in the SAS client.</div><div class="sasNote" id="sasLogNote870_1594283467627">NOTE: There were 4 observations read from the data set WORK.ENCODING_CHANNEL_CD.</div><div class="sasNote" id="sasLogNote871_1594283467627">NOTE: The data set PUBLIC.ENCODING_CHANNEL_CD has 4 observations and 2 variables.</div><div class="sasNote" id="sasLogNote872_1594283467627">NOTE: DATA statement used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              904.25k</div><div class="sasNote">      OS Memory           35096.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:51:40 PM</div><div class="sasNote">      Step Count                        202  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     149</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        20</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           40</div><div class="sasNote">      </div><div class="sasNote" id="sasLogNote873_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc fedsql sessref = casauto;</div><div class="sasSource">MPRINT(TEXT_ENCODING):   create table public.public.abt15_ml{options replace=true} as select t1.*, t2.channel_cd_id from </div><div class="sasSource">public.abt15_ml as t1 left join public.encoding_channel_cd as t2 on t1.channel_cd = t2.channel_cd ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote874_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT15_ML was created in caslib PUBLIC with 115438585 rows returned.</div><div class="sasNote" id="sasLogNote875_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">MPRINT(TEXT_ENCODING):   quit;</div><div class="sasNote" id="sasLogNote876_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           2:55.74</div><div class="sasNote">      user cpu time       0.08 seconds</div><div class="sasNote">      system cpu time     0.04 seconds</div><div class="sasNote">      memory              256.53k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:54:36 PM</div><div class="sasNote">      Step Count                        203  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     86</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        950</div><div class="sasNote">      Involuntary Context Switches      2</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           56</div><div class="sasNote">      </div><div class="sasSource">MPRINT(TEXT_ENCODING):   proc casutil;</div><div class="sasNote" id="sasLogNote877_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   promote casdata="encoding_channel_cd" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote878_1594283467627">NOTE: Cloud Analytic Services promoted table ENCODING_CHANNEL_CD in caslib Public to table encoding_channel_cd in caslib public.</div><div class="sasNote" id="sasLogNote879_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.025776 seconds.</div><div class="sasSource">MPRINT(TEXT_ENCODING):   run;</div><div class="sasSource">3424  </div><div class="sasSource">3425  /* Заменяем текстовое поле на числовое */</div><div class="sasNote" id="sasLogNote880_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              231.31k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:54:36 PM</div><div class="sasNote">      Step Count                        204  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     8</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        26</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">3426  proc fedsql sessref = casauto;</div><div class="sasNote" id="sasLogNote881_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3427  create table public.abt16_ml{options replace=true} as</div><div class="sasSource">3428  select</div><div class="sasSource">3429  t1.PBO_LOCATION_ID,</div><div class="sasSource">3430  t1.PRODUCT_ID,</div><div class="sasSource">3431  t1.CHANNEL_CD_id as channel_cd,</div><div class="sasSource">3432  t1.SALES_DT,</div><div class="sasSource">3433  t1.sum_qty,</div><div class="sasSource">3434  t1.GROSS_PRICE_AMT,</div><div class="sasSource">3435  t1.lag_halfyear_avg,</div><div class="sasSource">3436  t1.lag_halfyear_med,</div><div class="sasSource">3437  t1.lag_month_avg,</div><div class="sasSource">3438  t1.lag_month_med,</div><div class="sasSource">3439  t1.lag_qtr_avg,</div><div class="sasSource">3440  t1.lag_qtr_med,</div><div class="sasSource">3441  t1.lag_week_avg,</div><div class="sasSource">3442  t1.lag_week_med,</div><div class="sasSource">3443  t1.lag_year_avg,</div><div class="sasSource">3444  t1.lag_year_med,</div><div class="sasSource">3445  t1.lag_halfyear_std,</div><div class="sasSource">3446  t1.lag_month_std,</div><div class="sasSource">3447  t1.lag_qtr_std,</div><div class="sasSource">3448  t1.lag_week_std,</div><div class="sasSource">3449  t1.lag_year_std,</div><div class="sasSource">3450  t1.lag_halfyear_pct10,</div><div class="sasSource">3451  t1.lag_halfyear_pct90,</div><div class="sasSource">3452  t1.lag_month_pct10,</div><div class="sasSource">3453  t1.lag_month_pct90,</div><div class="sasSource">3454  t1.lag_qtr_pct10,</div><div class="sasSource">3455  t1.lag_qtr_pct90,</div><div class="sasSource">3456  t1.lag_week_pct10,</div><div class="sasSource">3457  t1.lag_week_pct90,</div><div class="sasSource">3458  t1.lag_year_pct10,</div><div class="sasSource">3459  t1.lag_year_pct90,</div><div class="sasSource">3460  t1.other_promo,</div><div class="sasSource">3461  t1.support,</div><div class="sasSource">3462  t1.bogo,</div><div class="sasSource">3463  t1.discount,</div><div class="sasSource">3464  t1.evm_set,</div><div class="sasSource">3465  t1.non_product_gift,</div><div class="sasSource">3466  t1.pairs,</div><div class="sasSource">3467  t1.product_gift,</div><div class="sasSource">3468   t1.side_promo_flag,</div><div class="sasSource">3469  t1.A_CPI,</div><div class="sasSource">3470  t1.A_GPD,</div><div class="sasSource">3471  t1.A_RDI,</div><div class="sasSource">3472  t1.TEMPERATURE,</div><div class="sasSource">3473  t1.PRECIPITATION,</div><div class="sasSource">3474  t1.comp_trp_BK,</div><div class="sasSource">3475  t1.comp_trp_KFC,</div><div class="sasSource">3476  t1.sum_trp,</div><div class="sasSource">3477  t1.prod_lvl4_id,</div><div class="sasSource">3478  t1.prod_lvl3_id,</div><div class="sasSource">3479  t1.prod_lvl2_id,</div><div class="sasSource">3480  t1.hero,</div><div class="sasSource">3481  t1.item_size,</div><div class="sasSource">3482  t1.offer_type,</div><div class="sasSource">3483  t1.price_tier,</div><div class="sasSource">3484  t1.lvl3_id,</div><div class="sasSource">3485  t1.lvl2_id,</div><div class="sasSource">3486  t1.agreement_type,</div><div class="sasSource">3487  t1.breakfast,</div><div class="sasSource">3488  t1.building_type,</div><div class="sasSource">3489  t1.company,</div><div class="sasSource">3490  t1.delivery,</div><div class="sasSource">3491  t1.drive_thru,</div><div class="sasSource">3492  t1.mccafe_type,</div><div class="sasSource">3493  t1.price_level,</div><div class="sasSource">3494  t1.window_type,</div><div class="sasSource">3495  t1.week,</div><div class="sasSource">3496  t1.weekday,</div><div class="sasSource">3497  t1.month,</div><div class="sasSource">3498  t1.weekend_flag,</div><div class="sasSource">3499  t1.defender_day,</div><div class="sasSource">3500  t1.female_day,</div><div class="sasSource">3501  t1.may_holiday,</div><div class="sasSource">3502  t1.new_year,</div><div class="sasSource">3503  t1.russia_day,</div><div class="sasSource">3504  t1.school_start,</div><div class="sasSource">3505  t1.student_day,</div><div class="sasSource">3506  t1.summer_start,</div><div class="sasSource">3507  t1.valentine_day,</div><div class="sasSource">3508  t1.price_rank,</div><div class="sasSource">3509  t1.price_index</div><div class="sasSource">3510  from</div><div class="sasSource">3511  public.abt15_ml as t1</div><div class="sasSource">3512  ;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote882_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ABT16_ML was created in caslib Public with 115438585 rows returned.</div><div class="sasNote" id="sasLogNote883_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">3513  quit;</div><div class="sasNote" id="sasLogNote884_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           2:37.17</div><div class="sasNote">      user cpu time       0.07 seconds</div><div class="sasNote">      system cpu time     0.03 seconds</div><div class="sasNote">      memory              281.56k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:57:13 PM</div><div class="sasNote">      Step Count                        205  Switch Count  2</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     76</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        850</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           80</div><div class="sasNote">      </div><div class="sasSource">3514  </div><div class="sasSource">3515  proc casutil;</div><div class="sasNote" id="sasLogNote885_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">3516  /* promote casdata="abt16_ml" incaslib="public" outcaslib="public"; */</div><div class="sasSource">3517  run;</div><div class="sasSource">3518  </div><div class="sasSource">3519  </div><div class="sasSource">3520  /******17. Разделяем витрину на обучение и скоринг  ******/</div><div class="sasNote" id="sasLogNote886_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.00 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              113.75k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:57:13 PM</div><div class="sasNote">      Step Count                        206  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     9</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        0</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           56</div><div class="sasNote">      </div><div class="sasSource">3521  proc casutil;</div><div class="sasNote" id="sasLogNote887_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">3522    droptable casdata="ml_train_full" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote888_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.013411 seconds.</div><div class="sasSource">3523     droptable casdata="ml_score_full" incaslib="public" quiet;</div><div class="sasNote" id="sasLogNote889_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.015631 seconds.</div><div class="sasSource">3524  run;</div><div class="sasSource">3525  </div><div class="sasNote" id="sasLogNote890_1594283467627">NOTE: PROCEDURE CASUTIL used (Total process time):</div><div class="sasNote">      real time           0.04 seconds</div><div class="sasNote">      user cpu time       0.00 seconds</div><div class="sasNote">      system cpu time     0.00 seconds</div><div class="sasNote">      memory              114.87k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/08/2020 11:57:13 PM</div><div class="sasNote">      Step Count                        207  Switch Count  0</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     6</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        9</div><div class="sasNote">      Involuntary Context Switches      0</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           0</div><div class="sasNote">      </div><div class="sasSource">3526  proc fedsql sessref=casauto;</div><div class="sasNote" id="sasLogNote891_1594283467627">NOTE: FEDSQL: Running on CAS due to "sessref".</div><div class="sasSource">3527  create table public.ml_train_full{options replace = true} as</div><div class="sasSource">3528  select * from public.abt16_ml where sales_dt &lt;= &amp;hist_end_dt.;</div><div class="sasSource">NOTE: Added action set 'fedsql'.</div><div class="sasSource">action returned string actionset = fedsql</div><div class="sasNote" id="sasLogNote892_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: load of action set returned rc=00000000</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ML_TRAIN_FULL was created in caslib Public with 96343079 rows returned.</div><div class="sasNote" id="sasLogNote893_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">3529  create table public.ml_score_full{options replace = true} as</div><div class="sasSource">3530  select * from public.abt16_ml where sales_dt &gt; &amp;hist_end_dt.;</div><div class="sasSource">NOTE: CASDAL driver. Creation of a DATE column has been requested, but is not supported by the CASDAL driver. A DOUBLE PRECISION </div><div class="sasSource">column will be created instead. A DATE format will be associated with the column.</div><div class="sasSource">NOTE: Table ML_SCORE_FULL was created in caslib Public with 19095506 rows returned.</div><div class="sasNote" id="sasLogNote894_1594283467627">NOTE: CAS action completed [OKAY]</div><div class="sasSource">FEDSQL: The fedsql.execDirect action returned rc=0x00000000</div><div class="sasSource">3531  quit;</div><div class="sasNote" id="sasLogNote895_1594283467627">NOTE: PROCEDURE FEDSQL used (Total process time):</div><div class="sasNote">      real time           3:24.04</div><div class="sasNote">      user cpu time       0.08 seconds</div><div class="sasNote">      system cpu time     0.04 seconds</div><div class="sasNote">      memory              253.62k</div><div class="sasNote">      OS Memory           34580.00k</div><div class="sasNote">      Timestamp           07/09/2020 12:00:37 AM</div><div class="sasNote">      Step Count                        208  Switch Count  4</div><div class="sasNote">      Page Faults                       0</div><div class="sasNote">      Page Reclaims                     97</div><div class="sasNote">      Page Swaps                        0</div><div class="sasNote">      Voluntary Context Switches        1107</div><div class="sasNote">      Involuntary Context Switches      1</div><div class="sasNote">      Block Input Operations            0</div><div class="sasNote">      Block Output Operations           88</div><div class="sasNote">      </div><div class="sasSource">3532  </div><div class="sasSource">3533  proc casutil;</div><div class="sasNote" id="sasLogNote896_1594283467627">NOTE: The UUID '107acdf8-aeac-d246-a638-db57ea7a7986' is connected using session CASAUTO.</div><div class="sasSource">3534  </div><div class="sasSource">3534!  promote casdata="ml_train_full" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote897_1594283467627">NOTE: Cloud Analytic Services promoted table ML_TRAIN_FULL in caslib Public to table ml_train_full in caslib public.</div><div class="sasNote" id="sasLogNote898_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 1.285362 seconds.</div><div class="sasSource">3535   </div><div class="sasSource">3535!   promote casdata="ml_score_full" incaslib="public" outcaslib="public";</div><div class="sasNote" id="sasLogNote899_1594283467627">NOTE: Cloud Analytic Services promoted table ML_SCORE_FULL in caslib Public to table ml_score_full in caslib public.</div><div class="sasNote" id="sasLogNote900_1594283467627">NOTE: The Cloud Analytic Services server processed the request in 0.34326 seconds.</div><div class="sasSource">3536  run;</div><div class="sasSource">3537  </div><div class="sasSource">3538  </div><div class="sasSource">3539  %studio_hide_wrapper;</div><div class="sasSource">MPRINT(STUDIO_HIDE_WRAPPER):   options nonotes;</div><div class="sasSource">MPRINT(STUDIO_HIDE_WRAPPER):   options nosource;</div><div class="sasSource">MPRINT(STUDIO_HIDE_WRAPPER):   options nostimer;</div><div class="sasSource">MPRINT(STUDIO_RESTORE_WRAPPER):   options NOTES;</div><div class="sasSource">MPRINT(STUDIO_RESTORE_WRAPPER):   options SOURCE;</div><div class="sasSource">MPRINT(STUDIO_RESTORE_WRAPPER):   options STIMER;</div></pre></body></html>